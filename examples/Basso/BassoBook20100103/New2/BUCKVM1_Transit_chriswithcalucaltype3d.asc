Version 4
SHEET 1 1272 912
WIRE 368 -2864 368 -2896
WIRE 256 -2736 144 -2736
WIRE 368 -2736 368 -2784
WIRE 368 -2736 256 -2736
WIRE -144 -2720 -256 -2720
WIRE 256 -2720 256 -2736
WIRE 144 -2704 144 -2736
WIRE 368 -2704 368 -2736
WIRE -256 -2656 -256 -2720
WIRE -144 -2640 -144 -2720
WIRE 256 -2624 256 -2640
WIRE 144 -2544 144 -2624
WIRE 256 -2544 256 -2560
WIRE 256 -2544 144 -2544
WIRE -144 -2512 -144 -2560
WIRE -16 -2512 -144 -2512
WIRE 144 -2512 144 -2544
WIRE 144 -2512 96 -2512
WIRE -16 -2496 -16 -2512
WIRE 96 -2496 96 -2512
WIRE -144 -2448 -144 -2512
WIRE -16 -2416 -64 -2416
WIRE 144 -2416 96 -2416
WIRE 144 -2352 144 -2416
WIRE 224 -2352 144 -2352
WIRE 368 -2352 368 -2624
WIRE 368 -2352 288 -2352
WIRE 144 -2304 144 -2352
WIRE -144 -2288 -144 -2384
WIRE -112 -2288 -144 -2288
WIRE -64 -2288 -64 -2416
WIRE -64 -2288 -112 -2288
WIRE 368 -2272 368 -2352
WIRE 368 -2272 176 -2272
WIRE 368 -2256 368 -2272
WIRE 144 -2064 144 -2240
WIRE 256 -2064 144 -2064
WIRE 368 -2064 368 -2176
WIRE 368 -2064 256 -2064
WIRE -272 -2000 -272 -2048
WIRE -160 -2000 -160 -2048
WIRE -64 -2000 -64 -2048
WIRE 64 -2000 64 -2048
WIRE 176 -2000 176 -2048
WIRE -272 -1872 -272 -1920
WIRE -272 -1872 -352 -1872
WIRE -160 -1872 -160 -1920
WIRE -160 -1872 -272 -1872
WIRE -64 -1872 -64 -1920
WIRE -64 -1872 -160 -1872
WIRE 64 -1872 64 -1920
WIRE 64 -1872 -64 -1872
WIRE 176 -1872 176 -1920
WIRE 176 -1872 64 -1872
WIRE -272 -1840 -272 -1872
WIRE -272 -1728 -272 -1760
WIRE -128 -1728 -128 -1760
WIRE 0 -1728 0 -1760
WIRE 176 -1728 176 -1776
WIRE -352 -1632 -352 -1872
WIRE -272 -1632 -272 -1648
WIRE -272 -1632 -352 -1632
WIRE -128 -1632 -128 -1648
WIRE -128 -1632 -272 -1632
WIRE 0 -1632 0 -1648
WIRE 0 -1632 -128 -1632
WIRE -912 -1376 -1360 -1376
WIRE -624 -1376 -768 -1376
WIRE -368 -1376 -528 -1376
WIRE -272 -1376 -304 -1376
WIRE -160 -1376 -192 -1376
WIRE -16 -1376 -80 -1376
WIRE 48 -1376 48 -1440
WIRE 48 -1376 -16 -1376
WIRE 224 -1376 48 -1376
WIRE 320 -1376 224 -1376
WIRE 368 -1376 320 -1376
WIRE 48 -1344 48 -1376
WIRE -1360 -1328 -1360 -1376
WIRE 224 -1312 224 -1376
WIRE -624 -1296 -704 -1296
WIRE -464 -1296 -528 -1296
WIRE 320 -1280 320 -1376
WIRE 464 -1280 320 -1280
WIRE -16 -1248 -16 -1312
WIRE 48 -1232 48 -1264
WIRE 48 -1232 16 -1232
WIRE 48 -1200 48 -1232
WIRE 464 -1152 464 -1280
WIRE -1360 -1088 -1360 -1248
WIRE -832 -1088 -832 -1328
WIRE -832 -1088 -1360 -1088
WIRE -704 -1088 -704 -1296
WIRE -704 -1088 -832 -1088
WIRE -464 -1088 -464 -1296
WIRE -464 -1088 -704 -1088
WIRE -16 -1088 -16 -1168
WIRE -16 -1088 -464 -1088
WIRE 48 -1088 48 -1120
WIRE 48 -1088 -16 -1088
WIRE 224 -1088 224 -1232
WIRE 224 -1088 48 -1088
WIRE -1360 -1056 -1360 -1088
WIRE 16 -1056 16 -1232
WIRE 288 -1056 16 -1056
WIRE 144 -1008 96 -1008
WIRE 288 -1008 288 -1056
WIRE 288 -1008 208 -1008
WIRE 464 -1008 288 -1008
WIRE -896 -960 -896 -1328
WIRE 96 -928 96 -1008
WIRE 192 -928 176 -928
WIRE 288 -928 288 -1008
WIRE 288 -928 256 -928
WIRE 288 -848 288 -928
WIRE 288 -848 208 -848
WIRE 96 -832 96 -928
WIRE 96 -832 -16 -832
WIRE 144 -832 96 -832
WIRE 288 -816 208 -816
WIRE 96 -784 96 -832
WIRE 288 -768 288 -816
WIRE -896 -720 -896 -832
WIRE -352 -720 -896 -720
WIRE -192 -720 -272 -720
WIRE -16 -720 -16 -832
WIRE -16 -720 -112 -720
WIRE 288 -672 288 -688
WIRE -896 -656 -896 -720
WIRE -896 -544 -896 -592
FLAG -1360 -1056 0
FLAG 368 -1376 Vout2
IOPIN 368 -1376 Out
FLAG 288 -672 0
FLAG 96 -784 Verr
IOPIN 96 -784 Out
FLAG -896 -464 0
FLAG 48 -1440 Vout
IOPIN 48 -1440 Out
FLAG 368 -2896 0
FLAG 256 -2064 0
FLAG -256 -2576 0
FLAG -112 -2288 0
FLAG -272 -1840 0
FLAG 176 -1648 0
FLAG 176 -1776 ac
SYMBOL voltage -1360 -1344 R0
WINDOW 123 34 109 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 38 50 Left 0
WINDOW 3 38 78 Left 0
SYMATTR InstName V1
SYMATTR Value 380
SYMBOL res -32 -1264 R0
WINDOW 0 -39 44 Left 0
WINDOW 3 -44 74 Left 0
SYMATTR InstName Resr
SYMATTR Value 55m
SYMBOL cap -32 -1376 R0
WINDOW 0 -47 32 Left 0
WINDOW 3 -45 64 Left 0
SYMATTR InstName C4
SYMATTR Value 2000µ
SYMBOL res 32 -1216 R0
SYMATTR InstName Rlower
SYMATTR Value 10k
SYMBOL ind -176 -1360 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
SYMATTR InstName L2
SYMATTR Value 50µ
SYMBOL res 32 -1360 R0
SYMATTR InstName Rupper
SYMATTR Value {Rupper}
SYMBOL res -288 -1360 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R6
SYMATTR Value 10m
SYMBOL Gain -896 -896 R270
WINDOW 39 92 26 VRight 0
SYMATTR SpiceLine GAIN=.5
SYMATTR InstName X2
SYMBOL voltage 288 -784 R0
WINDOW 0 43 35 Left 0
WINDOW 3 43 66 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vref1
SYMATTR Value 2.5
SYMBOL cap 208 -1024 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C2
SYMATTR Value {C2}
SYMBOL res 192 -944 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R2
SYMATTR Value {R2}
SYMBOL cap 192 -912 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName C1
SYMATTR Value {C1}
SYMBOL cap 448 -1072 R0
WINDOW 0 44 23 Left 0
WINDOW 3 46 49 Left 0
SYMATTR InstName C3
SYMATTR Value {C3}
SYMBOL res 448 -1168 R0
SYMATTR InstName R3
SYMATTR Value {R3}
SYMBOL ind -368 -704 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
SYMATTR InstName L1
SYMATTR Value 1kH
SYMBOL cap -912 -656 R0
SYMATTR InstName C5
SYMATTR Value 1kF
SYMBOL voltage -896 -560 R0
WINDOW 123 34 109 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 38 50 Left 0
WINDOW 3 38 78 Left 0
SYMATTR Value2 AC 1 0
SYMATTR InstName V2
SYMATTR Value ""
SYMBOL res -96 -736 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R1
SYMATTR Value 100m
SYMBOL ampsimp 176 -832 M0
WINDOW 38 0 0 Left 0
WINDOW 3 -248 -26 Left 0
WINDOW 39 -672 2 Left 0
SYMATTR SpiceModel ""
SYMATTR Value AMPSIMP
SYMATTR SpiceLine POLE=30 GAIN=30000 VHIGH=2.5V VLOW=100mV
SYMATTR InstName U1
SYMBOL res 208 -1328 R0
SYMATTR InstName R4
SYMATTR Value 4.0
SYMBOL PWMVM -864 -1344 R0
SYMATTR InstName U2
SYMBOL voltage -272 -1744 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 38 56 Left 0
WINDOW 3 32 88 Left 0
SYMATTR InstName K
SYMATTR Value {K}
SYMBOL voltage -128 -1744 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 37 58 Left 0
WINDOW 3 31 92 Left 0
SYMATTR InstName G
SYMATTR Value {G}
SYMBOL voltage 0 -1744 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 41 67 Left 0
WINDOW 3 24 95 Left 0
SYMATTR InstName Rupperx
SYMATTR Value {Rupper}
SYMBOL XFMR1 -576 -1344 R0
SYMATTR InstName U5
SYMATTR SpiceLine RATIO=.138
SYMBOL diode -368 -1360 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 -11 24 VBottom 0
SYMATTR InstName D1
SYMATTR Value mur1540
SYMBOL voltage 64 -2016 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 15 88 Left 0
WINDOW 3 15 115 Left 0
SYMATTR InstName Rled
SYMATTR Value {Rled}
SYMBOL voltage -64 -2016 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 30 79 Left 0
WINDOW 3 21 111 Left 0
SYMATTR InstName Fpole
SYMATTR Value {fpole}
SYMBOL res 128 -2720 R0
SYMATTR InstName Rled1
SYMATTR Value {Rled}
SYMBOL res 352 -2720 R0
SYMATTR InstName Rupper1
SYMATTR Value {Rupper1}
SYMBOL res 352 -2272 R0
SYMATTR InstName Rlower1
SYMATTR Value 10k
SYMBOL bv 368 -2768 R180
WINDOW 0 24 104 Left 0
WINDOW 3 -198 153 Left 0
SYMATTR InstName B1
SYMATTR Value V=V(ac)+50.00004
SYMBOL cap 288 -2368 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName Czero1
SYMATTR Value {Czero}
SYMBOL res -160 -2656 R0
SYMATTR InstName Rpullup1
SYMATTR Value {Rpullup}
SYMBOL cap -128 -2384 R180
WINDOW 0 24 64 Left 0
WINDOW 3 24 8 Left 0
SYMATTR InstName Cpole1
SYMATTR Value {Cpole}
SYMBOL voltage -256 -2672 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 5
SYMBOL TL431 160 -2304 M0
SYMATTR InstName U3
SYMBOL voltage 96 -2512 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V14
SYMATTR Value ""
SYMBOL f -16 -2496 M0
WINDOW 0 50 28 Left 0
WINDOW 3 35 61 Left 0
SYMATTR InstName F1
SYMATTR Value V14 1
SYMBOL voltage -272 -2016 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -66 210 Left 0
WINDOW 0 7 107 Left 0
SYMATTR Value {Cpole*1000000000}
SYMATTR InstName Cpole
SYMBOL voltage -160 -2016 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 105 206 Left 0
WINDOW 0 8 107 Left 0
SYMATTR Value {Czero*1000000000}
SYMATTR InstName Czero
SYMBOL voltage 176 -2016 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 31 95 Left 0
WINDOW 3 20 118 Left 0
SYMATTR InstName Fzero
SYMATTR Value {fzero}
SYMBOL voltage 176 -1744 R0
WINDOW 123 41 47 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 38 14 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName V18
SYMATTR Value ""
SYMBOL res 240 -2736 R0
SYMATTR InstName R5
SYMATTR Value {Rpz}
SYMBOL cap 240 -2624 R0
SYMATTR InstName C6
SYMATTR Value {Cpz}
TEXT -1288 -2736 Left 0 !.ac dec 100 10 1000000
TEXT -1280 -2768 Left 0 !;tran 0 1m 1u
TEXT -800 -1304 Left 0 ;Fs=100k\nL=75u
TEXT -1280 -2712 Left 0 !.include application.lib
TEXT -1280 -2664 Left 0 !.include pwmswitch.lib
TEXT -1272 -2624 Left 0 !.param Vout = 50.0\n .param Rupper1 = (Vout -2.5)/250u\n.param Rupper = (Vout -2.5)/250u\n.param fc = 10.0k\n.param pm = 100\n.param Gfc = -1\n.param pfc = -97\n \n.param G = 10**(-Gfc/20)\n.param Boost = pm-(pfc)-90\n.param pi = 3.14159\n.param K = (tan((Boost/4+45)*pi/180))**2\n.param C2 = 1/(2*pi*fc*G*Rupper)\n.param C1 = C2*(K-1)\n.param R2 = sqrt(K)/(2*pi*fc*C1)\n.param R3 =Rupper/(K-1)\n.param C3 = 1/(2*pi*fc*sqrt(K)*R3)\n.param Fzero = fc/sqrt(K)\n.param Fpole =sqrt( K) * fc\n \n.param Rpullup = 20k\n \n.param a =(Fpole**2+fc**2)*(fc**2+Fzero**2)*(Fpole**2+fc**2)*(fc**2+Fzero**2)\n.param b =Fpole**2*Fpole**2+Fpole**2* fc**2+fc**2*Fpole**2+fc**4\n \n.param Rled = (sqrt(a)/b)*Rpullup*Fpole*Fpole/(Fzero*fc*G)\n.param Czero = 1/(2*pi*Fzero*Rupper)\n.param Cpole = 1/(2*pi*Fpole*Rpullup)\n.param Cpz = (Fpole-Fzero)/(2*Fzero*Fpole*Rled*pi)\n.param Rpz = 1/(2*pi*Fpole*Cpz)\n.param CTR = 1
TEXT -312 -2816 Left 0 !;ac oct 100 10 1000000
TEXT -312 -2752 Left 0 !;tran 0 1m 1u
TEXT -312 -2784 Left 0 !.include application.lib
