Version 4
SHEET 1 880 1136
WIRE -416 368 -416 320
WIRE -416 480 -416 448
WIRE -416 816 -416 720
WIRE -416 928 -416 896
WIRE -416 960 -416 928
WIRE -336 560 -368 560
WIRE -336 720 -416 720
WIRE -224 560 -256 560
WIRE -224 656 -224 560
WIRE -224 720 -256 720
WIRE -224 720 -224 656
WIRE -224 928 -416 928
WIRE -224 928 -224 752
WIRE -192 320 -416 320
WIRE -192 560 -224 560
WIRE -192 720 -224 720
WIRE -192 752 -224 752
WIRE -176 400 -208 400
WIRE -176 400 -176 368
WIRE -128 480 -416 480
WIRE -128 480 -128 368
WIRE -96 560 -112 560
WIRE -96 656 -224 656
WIRE 0 560 -32 560
WIRE 0 656 -32 656
WIRE 0 656 0 560
WIRE 0 736 -128 736
WIRE 0 736 0 656
WIRE 0 784 -48 784
WIRE 0 816 0 784
WIRE 0 928 -224 928
WIRE 0 928 0 896
WIRE 32 736 0 736
WIRE 32 784 0 784
WIRE 80 656 80 592
WIRE 80 720 80 656
WIRE 80 928 0 928
WIRE 80 928 80 800
WIRE 96 320 -112 320
WIRE 96 384 96 320
WIRE 96 480 -128 480
WIRE 96 480 96 448
WIRE 112 656 80 656
WIRE 224 656 192 656
WIRE 224 816 224 656
WIRE 224 928 80 928
WIRE 224 928 224 896
WIRE 288 480 96 480
WIRE 288 480 288 400
WIRE 352 320 96 320
WIRE 352 400 288 400
WIRE 352 480 288 480
WIRE 368 592 80 592
WIRE 368 704 368 592
WIRE 368 752 336 752
WIRE 368 816 368 752
WIRE 368 928 224 928
WIRE 368 928 368 896
WIRE 416 704 368 704
WIRE 416 752 368 752
WIRE 416 928 368 928
WIRE 416 928 416 800
WIRE 496 592 368 592
WIRE 496 656 496 592
WIRE 496 928 416 928
WIRE 496 928 496 800
WIRE 576 320 432 320
WIRE 576 368 576 320
WIRE 576 480 432 480
WIRE 576 480 576 448
WIRE 576 512 576 480
WIRE 608 560 0 560
WIRE 608 592 496 592
WIRE 608 704 576 704
FLAG -208 400 MDRV
IOPIN -208 400 In
FLAG 576 512 0
FLAG 352 400 ISNS
IOPIN 352 400 Out
FLAG -368 560 ISNS
IOPIN -368 560 In
FLAG -416 960 0
FLAG -48 784 VTRI
IOPIN -48 784 Out
FLAG 608 592 PWM
IOPIN 608 592 Out
FLAG 608 560 VCEA
IOPIN 608 560 Out
FLAG 608 704 MDRV
IOPIN 608 704 Out
FLAG 336 752 CLK
IOPIN 336 752 Out
SYMBOL ind2 336 336 R270
WINDOW 0 60 47 VTop 0
WINDOW 3 63 58 VBottom 0
SYMATTR InstName L1
SYMATTR Value 100µ
SYMATTR Type ind
SYMATTR SpiceLine Rser=10m
SYMBOL diode 112 448 R180
WINDOW 0 53 49 Left 0
WINDOW 3 43 25 Left 0
SYMATTR InstName D1
SYMATTR Value DID
SYMBOL sw -96 320 M270
WINDOW 0 77 87 VLeft 0
WINDOW 3 52 86 VLeft 0
SYMATTR InstName SW1
SYMATTR Value MSW
SYMBOL voltage -416 352 R0
WINDOW 0 39 43 Left 0
WINDOW 3 38 64 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VIN
SYMATTR Value 100V
SYMBOL voltage 576 352 R0
WINDOW 0 38 43 Left 0
WINDOW 3 50 66 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VOUT
SYMATTR Value 50V
SYMBOL res 448 464 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName RSNS
SYMATTR Value 50m
SYMBOL Opamps\\opamp -160 672 R0
SYMATTR InstName CEA
SYMATTR SpiceLine2 GBW=2Meg
SYMBOL res -96 544 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R3
SYMATTR Value 20K
SYMBOL cap -32 544 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C1
SYMATTR Value 500p
SYMBOL res -240 544 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R1
SYMATTR Value 1K
SYMBOL res -240 704 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R2
SYMATTR Value 1K
SYMBOL voltage -416 800 R0
WINDOW 0 37 52 Left 0
WINDOW 3 38 67 Invisible 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VIDEM
SYMATTR Value PULSE(250m 750m 50u 10n 10n 100u 200u)
SYMBOL sw 80 816 M180
WINDOW 0 37 71 Left 0
WINDOW 3 36 44 Left 0
SYMATTR InstName SW2
SYMATTR Value COMP
SYMBOL voltage 0 800 R0
WINDOW 0 -84 57 Left 0
WINDOW 3 -112 64 Invisible 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VTRI
SYMATTR Value PULSE(0 5 0 9.9u 100n 0 10u)
SYMBOL res 208 640 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R4
SYMATTR Value 1K
SYMBOL voltage 224 800 R0
WINDOW 0 38 43 Left 0
WINDOW 3 39 66 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 5V
SYMBOL diode -96 672 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName Z1
SYMATTR Value ZID
SYMBOL voltage 368 800 R0
WINDOW 0 37 55 Left 0
WINDOW 3 24 104 Invisible 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 5 0 10n 10n 100n 10u)
SYMBOL Digital\\dflop 496 656 R0
WINDOW 0 49 -17 Left 0
SYMATTR InstName A1
SYMATTR SpiceLine Vhigh=5 Vlow=0 Trise=10n Tfall=10n Td=100n
TEXT -384 952 Left 0 !.MODEL DID D(RON=10m VFWD=0V)
TEXT -384 1000 Left 0 !.MODEL MSW SW(RON=10m ROFF=1E6 VT=2.5V VH=1)
TEXT -168 1048 Left 0 !.tran 0 500u 10n 10n uic
TEXT -384 1048 Left 0 !.lib opamp.sub
TEXT -384 1024 Left 0 !.MODEL COMP SW(RON=1u ROFF=1E6 VT=0 VH=10m)
TEXT -384 976 Left 0 !.MODEL ZID D(RON=10m VFWD=0V VREV=6V)
