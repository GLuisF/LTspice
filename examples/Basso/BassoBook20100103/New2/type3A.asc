Version 4
SHEET 1 2104 1136
WIRE 112 -704 112 -752
WIRE 272 -704 272 -752
WIRE 432 -704 432 -752
WIRE -304 -672 -304 -720
WIRE -192 -672 -192 -720
WIRE 112 -592 112 -624
WIRE 272 -592 272 -624
WIRE 272 -592 112 -592
WIRE 432 -592 432 -624
WIRE 432 -592 272 -592
WIRE -304 -544 -304 -592
WIRE -192 -544 -192 -592
WIRE -192 -544 -304 -544
WIRE -304 -512 -304 -544
WIRE 128 -512 128 -544
WIRE 272 -512 272 -544
WIRE 128 -416 128 -432
WIRE 272 -416 272 -432
WIRE 272 -416 128 -416
WIRE 432 -416 432 -592
WIRE 432 -416 272 -416
WIRE 272 -368 272 -416
WIRE -672 -192 -672 -224
WIRE -896 -128 -896 -176
WIRE 576 -112 576 -144
WIRE -672 -64 -672 -112
WIRE -336 -48 -480 -48
WIRE -176 -48 -176 -96
WIRE -176 -48 -336 -48
WIRE -480 -16 -480 -48
WIRE -176 -16 -176 -48
WIRE 576 -16 576 -32
WIRE 752 -16 576 -16
WIRE 576 32 576 -16
WIRE 240 64 144 64
WIRE 384 64 304 64
WIRE -288 96 -320 96
WIRE -176 96 -176 64
WIRE -176 96 -224 96
WIRE 752 96 752 64
WIRE -720 112 -784 112
WIRE -672 112 -672 16
WIRE -672 112 -720 112
WIRE -624 112 -672 112
WIRE -480 112 -480 64
WIRE -432 112 -480 112
WIRE -336 112 -336 32
WIRE -336 112 -368 112
WIRE 144 128 144 64
WIRE 288 128 224 128
WIRE 384 128 384 64
WIRE 384 128 352 128
WIRE -720 144 -720 112
WIRE -624 144 -624 112
WIRE -480 160 -480 112
WIRE 384 176 384 128
WIRE 576 176 576 112
WIRE 576 176 384 176
WIRE 752 176 752 160
WIRE 752 176 576 176
WIRE 384 208 384 176
WIRE 384 208 304 208
WIRE 576 208 576 176
WIRE 144 224 144 128
WIRE 144 224 112 224
WIRE 240 224 144 224
WIRE -720 240 -720 208
WIRE -672 240 -720 240
WIRE -624 240 -624 224
WIRE -624 240 -672 240
WIRE 384 240 304 240
WIRE -480 272 -480 240
WIRE -320 272 -320 96
WIRE -320 272 -480 272
WIRE -480 288 -480 272
WIRE 384 304 384 240
WIRE -176 320 -176 96
WIRE -176 320 -448 320
WIRE -176 336 -176 320
WIRE 384 400 384 384
WIRE 576 400 576 288
WIRE 576 400 384 400
WIRE -672 416 -672 240
WIRE -480 416 -480 352
WIRE -480 416 -672 416
WIRE -176 416 -480 416
WIRE 384 416 384 400
WIRE -672 448 -672 416
FLAG -672 -224 0
FLAG -672 448 0
FLAG -784 112 verr
FLAG 384 416 0
FLAG 112 224 Vopamp
IOPIN 112 224 Out
FLAG 576 -144 0
FLAG -176 -176 0
FLAG -896 -48 0
FLAG -896 -176 ac
FLAG 272 -368 0
FLAG -304 -512 0
SYMBOL res -688 32 M180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName Rpullup
SYMATTR Value {Rpullup}
SYMBOL res -160 -32 M0
WINDOW 0 -94 23 Left 0
WINDOW 3 -106 59 Left 0
SYMATTR InstName Rupper2
SYMATTR Value {Rupper}
SYMBOL res -160 320 M0
SYMATTR InstName Rlower2
SYMATTR Value 10K
SYMBOL res -464 -32 M0
WINDOW 0 -65 33 Left 0
WINDOW 3 -72 60 Left 0
SYMATTR InstName Rled
SYMATTR Value {Rled}
SYMBOL cap -224 112 M270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName Czero
SYMATTR Value {Czero}
SYMBOL cap -704 144 M0
SYMATTR InstName Cpole
SYMATTR Value {Cpole}
SYMBOL voltage -672 -96 R180
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL ampsimp 272 224 M0
SYMATTR InstName U4
SYMATTR SpiceLine POLE=30 GAIN=30000 VHIGH=4 VLOW=100mV
SYMBOL cap 304 48 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C2
SYMATTR Value {C2}
SYMBOL cap 352 112 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C1
SYMATTR Value {C1}
SYMBOL res 240 112 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R2
SYMATTR Value {R2}
SYMBOL voltage 384 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 34 42 Left 0
WINDOW 3 33 67 Left 0
SYMATTR InstName V3
SYMATTR Value 2.5
SYMBOL res 560 16 R0
SYMATTR InstName Rupper
SYMATTR Value {Rupper}
SYMBOL res 560 192 R0
SYMATTR InstName Rlower
SYMATTR Value 10k
SYMBOL res -352 -64 R0
SYMATTR InstName R1
SYMATTR Value {Rpz}
SYMBOL cap -368 96 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C4
SYMATTR Value {Cpz}
SYMBOL res 736 -32 R0
SYMATTR InstName R3
SYMATTR Value {R3}
SYMBOL cap 736 96 R0
SYMATTR InstName C3
SYMATTR Value {C3}
SYMBOL bv 576 -16 R180
WINDOW 0 24 104 Left 0
WINDOW 3 -198 153 Left 0
SYMATTR InstName B1
SYMATTR Value V=V(ac)+4.9998352
SYMBOL bv -176 -80 R180
WINDOW 0 24 104 Left 0
WINDOW 3 -198 153 Left 0
SYMATTR InstName B2
SYMATTR Value V=V(ac)+50.00004
SYMBOL voltage -896 -144 R0
WINDOW 123 11 -41 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 11 -13 Left 0
SYMATTR Value2 AC 1
SYMATTR Value ""
SYMATTR InstName V1
SYMBOL f -624 144 M0
WINDOW 0 50 28 Left 0
WINDOW 3 35 61 Left 0
SYMATTR InstName F1
SYMATTR Value V4 1
SYMBOL voltage -480 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 24 44 Left 0
SYMATTR Value 0
SYMATTR InstName V4
SYMBOL TL431 -464 288 M0
SYMATTR InstName U1
SYMBOL voltage 432 -720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 43 74 Left 0
SYMATTR InstName V5
SYMATTR Value {Rled}
SYMBOL voltage 128 -528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 38 38 Left 0
WINDOW 3 32 84 Left 0
SYMATTR InstName V6
SYMATTR Value {K}
SYMBOL voltage 112 -720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 37 70 Left 0
SYMATTR InstName V7
SYMATTR Value {fzero}
SYMBOL voltage 272 -720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 39 79 Left 0
SYMATTR InstName V8
SYMATTR Value {fpole}
SYMBOL voltage 272 -528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 37 40 Left 0
WINDOW 3 31 89 Left 0
SYMATTR InstName V9
SYMATTR Value {G}
SYMBOL voltage -304 -688 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -66 210 Left 0
SYMATTR Value {Cpole*1000000000}
SYMATTR InstName V10
SYMBOL voltage -192 -688 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 43 50 Left 0
SYMATTR Value {Czero*1000000000}
SYMATTR InstName V11
TEXT 872 -488 Left 0 !;tran 0 800u 1u
TEXT 872 -424 Left 0 !.param Vout = 50\n \n.param Rupper = (Vout -2.5)/250u\n.param fc = 1.0k\n.param pm = 100\n.param Gfc = -20\n.param pfc = -55\n \n.param G = 10**(-Gfc/20)\n.param Boost = pm-(pfc)-90\n.param pi = 3.14159\n.param K = (tan((Boost/4+45)*pi/180))**2\n.param C2 = 1/(2*pi*fc*G*Rupper)\n.param C1 = C2*(K-1)\n.param R2 = sqrt(K)/(2*pi*fc*C1)\n.param R3 =Rupper/(K-1)\n.param C3 = 1/(2*pi*fc*sqrt(K)*R3)\n.param Fzero = fc/sqrt(K)\n.param Fpole =sqrt( K) * fc\n \n.param Rpullup = 20k\n \n.param a =(Fpole**2+fc**2)*(fc**2+Fzero**2)*(Fpole**2+fc**2)*(fc**2+Fzero**2)\n.param b =Fpole**2*Fpole**2+Fpole**2* fc**2+fc**2*Fpole**2+fc**4\n \n.param Rled = (sqrt(a)/b)*Rpullup*Fpole*Fpole/(Fzero*fc*G)\n.param Czero = 1/(2*pi*Fzero*Rupper)\n.param Cpole = 1/(2*pi*Fpole*Rpullup)\n.param Cpz = (Fpole-Fzero)/(2*Fzero*Fpole*Rled*pi)\n.param Rpz = 1/(2*pi*Fpole*Cpz)\n.param CTR = 1
TEXT 848 -568 Left 0 !.ac dec 100 1 1000000
TEXT 856 -600 Left 0 !.include application.lib
