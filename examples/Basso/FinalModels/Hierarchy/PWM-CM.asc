Version 4
SHEET 1 1008 680
WIRE -736 -528 -800 -528
WIRE -544 -528 -736 -528
WIRE -144 -528 -352 -528
WIRE -16 -528 -144 -528
WIRE 0 -528 -16 -528
WIRE 80 -528 0 -528
WIRE 192 -528 160 -528
WIRE 224 -528 192 -528
WIRE 352 -528 304 -528
WIRE -736 -496 -736 -528
WIRE -544 -496 -544 -528
WIRE -144 -496 -144 -528
WIRE -16 -496 -16 -528
WIRE -352 -480 -352 -528
WIRE -736 -384 -736 -416
WIRE -544 -384 -544 -416
WIRE -544 -384 -736 -384
WIRE -352 -384 -352 -416
WIRE -352 -384 -544 -384
WIRE -144 -384 -144 -416
WIRE -144 -384 -352 -384
WIRE -16 -384 -16 -416
WIRE -16 -384 -144 -384
WIRE 352 -384 -16 -384
WIRE -736 -272 -800 -272
WIRE -384 -272 -480 -272
WIRE 176 -272 -16 -272
WIRE -736 -208 -736 -272
WIRE -480 -208 -480 -272
WIRE -16 -208 -16 -272
WIRE -736 -64 -736 -128
WIRE -480 -64 -480 -128
WIRE -480 -64 -736 -64
WIRE -16 -64 -16 -128
WIRE -16 -64 -480 -64
WIRE -480 -32 -480 -64
WIRE -672 64 -736 64
WIRE -224 64 -320 64
WIRE 336 64 144 64
WIRE 144 112 144 64
WIRE -736 128 -736 64
WIRE -320 128 -320 64
WIRE -736 272 -736 208
WIRE -320 272 -320 208
WIRE -320 272 -736 272
WIRE 144 272 144 192
WIRE 144 272 -320 272
WIRE -320 304 -320 272
FLAG -480 -32 0
FLAG -800 -528 nA
IOPIN -800 -528 BiDir
FLAG 352 -528 nC
IOPIN 352 -528 BiDir
FLAG 352 -384 nP
IOPIN 352 -384 BiDir
FLAG -384 -272 nD
IOPIN -384 -272 Out
FLAG 176 -272 nDC
IOPIN 176 -272 Out
FLAG -224 64 nDP
IOPIN -224 64 Out
FLAG 336 64 nDPC
IOPIN 336 64 Out
FLAG -320 304 0
FLAG 0 -528 nCx
FLAG -800 -272 nVCtrl
IOPIN -800 -272 In
FLAG -672 64 nMode
IOPIN -672 64 Out
FLAG 192 -528 nCz
SYMBOL Misc\\Gpoly -544 -400 R180
WINDOW 0 24 104 Left 2
WINDOW 3 354 174 Right 2
SYMATTR InstName GA
SYMATTR Value Value={V(nDC)/(V(nDC)+V(nDPC)+1u)*I(VSense)} ; GA
SYMBOL res -752 -512 R0
SYMATTR InstName Rin
SYMATTR Value 1G
SYMBOL res 320 -544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rout
SYMATTR Value 1m
SYMBOL voltage 64 -528 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName VSense
SYMATTR Value 0V
SYMBOL Misc\\Epoly -320 112 R0
WINDOW 0 -112 96 Left 2
WINDOW 3 -15 224 Left 2
SYMATTR InstName EDutyP
SYMATTR Value Value={2*{Lsw}*{Fsw}*I(VSense)/(V(nDC)*V(nA,nCx)+1u)-V(nDC)} ; EDutyP
SYMBOL Misc\\Epoly -16 -224 R0
SYMATTR InstName EDClamp
SYMATTR Value Value={Limit(V(nD),{DCMin},{DCMax})} ; EDClamp
SYMBOL Misc\\Epoly 144 96 R0
SYMATTR InstName EDPClamp
SYMATTR Value Value={Limit(V(nDP),1-{DCMax},1-V(nDC))} ; EDPClamp
SYMBOL Misc\\Epoly -480 -224 R0
WINDOW 3 31 193 Left 2
SYMATTR Value Value={V(nDPC)*V(nCx,nP)/(V(nA,nP)-V(nCx,nP)+1u)} ; EDuty
SYMATTR InstName EDuty
SYMBOL Misc\\Gpoly -16 -512 R0
SYMATTR InstName GC
SYMATTR Value Value={V(nVCtrl)/{RISense}} ; GC
SYMBOL Misc\\Gpoly -144 -400 R180
WINDOW 0 20 11 Left 2
WINDOW 3 301 -46 Right 2
SYMATTR InstName GMu
SYMATTR Value Value={{Slope}*V(nDC)/{RISense}/{Fsw}+V(nCx,nP)/{Lsw}*V(nDPC)*(1-(V(nDC)+V(nDPC))/2)/{Fsw}} ; GMu
SYMBOL res -752 -224 R0
SYMATTR InstName RVCtrl
SYMATTR Value 1Meg
SYMBOL Misc\\Epoly -736 112 R0
WINDOW 3 -12 259 Left 2
SYMATTR Value Value={If(2*{Lsw}*{Fsw}*I(VSense)/(V(nDC)*V(nA,nCx)+1u)<1,0,1)} ; EMode
SYMATTR InstName EMode
SYMBOL cap -368 -480 R0
WINDOW 3 17 -127 Left 2
SYMATTR Value Q=(If(V(nMode),4/({Lsw}*(2*pi*{Fsw})**2),1p))*x ; Cccm
SYMATTR InstName Cccm
TEXT -688 -672 Left 2 !.Param Lsw=100uH Fsw=100kHz DCMax=0.95 DCMin=0.05 RISense=1 Slope=100m
