Version 4
SHEET 1 2936 1904
WIRE 1120 768 912 768
WIRE 1728 768 1120 768
WIRE 912 784 912 768
WIRE 1536 800 1408 800
WIRE 1664 800 1536 800
WIRE 1664 816 1664 800
WIRE 1120 848 1120 768
WIRE 1408 848 1408 800
WIRE 1536 848 1536 800
WIRE 912 880 912 864
WIRE 1664 896 1664 880
WIRE 1728 912 1728 768
WIRE 1536 928 1536 912
WIRE 1536 928 1488 928
WIRE 1680 992 1488 992
WIRE 1536 1008 1536 928
WIRE 912 1056 848 1056
WIRE 1040 1056 976 1056
WIRE 1536 1088 1536 1072
WIRE 1536 1088 1488 1088
WIRE 1728 1088 1728 1008
WIRE 1728 1088 1536 1088
WIRE 1872 1088 1728 1088
WIRE 1904 1088 1872 1088
WIRE 2000 1088 1984 1088
WIRE 2016 1088 2000 1088
WIRE 2112 1088 2096 1088
WIRE 2192 1088 2112 1088
WIRE 2320 1088 2192 1088
WIRE 2480 1088 2320 1088
WIRE 1728 1104 1728 1088
WIRE 2192 1104 2192 1088
WIRE 1872 1120 1872 1088
WIRE 2320 1120 2320 1088
WIRE 2480 1120 2480 1088
WIRE 864 1184 848 1184
WIRE 960 1184 944 1184
WIRE 1040 1184 1024 1184
WIRE 1680 1184 1488 1184
WIRE 2192 1200 2192 1184
WIRE 2192 1200 2144 1200
WIRE 1728 1216 1728 1200
WIRE 1872 1216 1872 1184
WIRE 2192 1216 2192 1200
WIRE 2320 1232 2320 1184
WIRE 2480 1232 2480 1200
WIRE 2000 1264 2000 1088
WIRE 2000 1264 1488 1264
WIRE 928 1312 848 1312
WIRE 1040 1312 992 1312
WIRE 2192 1312 2192 1296
WIRE 2112 1328 2112 1088
WIRE 2112 1328 1488 1328
WIRE 1616 1392 1488 1392
WIRE 1664 1392 1616 1392
WIRE 1776 1392 1744 1392
WIRE 2144 1392 2144 1200
WIRE 2144 1392 1776 1392
WIRE 1152 1488 1152 1456
WIRE 1376 1488 1376 1456
FLAG 1152 1488 0
FLAG 1376 1488 0
FLAG 848 1184 0
FLAG 848 1056 0
FLAG 2192 1312 0
FLAG 2480 1232 0
FLAG 2320 1232 0
FLAG 912 880 0
FLAG 1728 1216 0
FLAG 848 1312 0
FLAG 2480 1088 OUT
FLAG 1664 896 0
FLAG 1872 1216 0
FLAG 1616 1392 B
FLAG 1776 1392 A
FLAG 912 768 IN
SYMBOL RES 960 1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10K
SYMBOL res 2176 1088 R0
SYMATTR InstName R2
SYMATTR Value 20K
SYMBOL res 2176 1200 R0
SYMATTR InstName R3
SYMATTR Value 10K
SYMBOL res 2000 1104 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value .006
SYMBOL cap 1024 1168 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 330p
SYMBOL cap 992 1296 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 43p
SYMBOL cap 976 1040 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value .001µ
SYMBOL polcap 2304 1120 R0
WINDOW 39 27 65 Left 2
WINDOW 123 25 86 Left 2
WINDOW 3 44 37 Left 2
SYMATTR SpiceLine Rser=.05
SYMATTR Value2 x4
SYMATTR Value 180µ
SYMATTR InstName C4
SYMBOL VOLTAGE 912 768 R0
SYMATTR InstName V1
SYMATTR Value 6
SYMBOL ind 1888 1104 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 1.5µ
SYMBOL NMOS 1680 912 R0
SYMATTR InstName Q1
SYMATTR Value Si4410DY
SYMBOL nmos 1680 1104 R0
SYMATTR InstName Q2
SYMATTR Value Si4410DY
SYMBOL cap 1648 816 R0
SYMATTR InstName C5
SYMATTR Value 4.7µ
SYMBOL cap 1520 1008 R0
SYMATTR InstName C6
SYMATTR Value .22µ
SYMBOL schottky 1520 848 R0
SYMATTR InstName D1
SYMATTR Value 1N5818
SYMBOL schottky 1856 1184 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value 1N5818
SYMBOL POWERPRODUCTS\\LTC1735 1264 1120 R0
SYMATTR InstName U1
SYMBOL voltage 1760 1392 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 39 53 56 VTop 2
WINDOW 123 74 56 VTop 2
SYMATTR InstName V2
SYMATTR Value SINE(0 10m {Freq})
SYMBOL res 2464 1104 R0
SYMATTR InstName Rload
SYMATTR Value .5
TEXT 1856 1624 Left 2 !.param t0=.5m\n.tran 0 {t0+10/Freq} {t0} 10n
TEXT 1856 1536 Left 2 !.ic V(out)=2.4\n.save V(a) V(b)  I(L1)
TEXT 800 1480 Left 2 !.measure Aavg avg V(a)\n.measure Bavg avg V(b)\n.measure Are avg  (V(a)-Aavg)*cos(360*time*Freq)\n.measure Aim avg -(V(a)-Aavg)*sin(360*time*Freq)\n.measure Bre avg  (V(b)-Bavg)*cos(360*time*Freq)\n.measure Bim avg -(V(b)-Bavg)*sin(360*time*Freq)\n.measure GainMag param 20*log10(hypot(Are,Aim) / hypot(Bre,Bim))\n.measure GainPhi param mod(atan2(Aim, Are) - atan2(Bim, Bre)+180,360)-180
TEXT 1856 1464 Left 2 !.param  freq=21K ; iterate to 0dB gain or use the .step statement below\n.step oct param Freq 15K 30K 4
TEXT 2256 1576 Left 2 ;Loop crossover frequency: 21KHz\nPhase Margin: 66°
