Version 4
SHEET 1 2536 1572
WIRE -1856 256 -1856 -480
WIRE -1760 -128 -1760 -368
WIRE -1760 64 -1760 -64
WIRE -1728 256 -1856 256
WIRE -1712 -128 -1760 -128
WIRE -1712 -64 -1760 -64
WIRE -1696 -176 -1696 -224
WIRE -1664 16 -1680 16
WIRE -1648 -368 -1760 -368
WIRE -1648 -176 -1648 -240
WIRE -1648 16 -1664 16
WIRE -1648 16 -1648 -16
WIRE -1520 -96 -1600 -96
WIRE -1504 256 -1728 256
WIRE -1424 -480 -1856 -480
WIRE -1424 -368 -1568 -368
WIRE -1424 -368 -1424 -480
WIRE -1424 -96 -1456 -96
WIRE -1424 -96 -1424 -368
WIRE -1408 112 -1472 112
WIRE -1408 176 -1408 112
WIRE -1312 -48 -1312 -80
WIRE -1248 112 -1280 112
WIRE -1248 176 -1248 112
WIRE -1248 400 -1328 400
WIRE -1248 400 -1248 336
WIRE -1232 -112 -1232 -368
WIRE -1184 -112 -1232 -112
WIRE -1184 -48 -1312 -48
WIRE -1168 -160 -1168 -192
WIRE -1136 32 -1152 32
WIRE -1120 -160 -1120 -208
WIRE -1120 32 -1136 32
WIRE -1120 32 -1120 0
WIRE -1120 640 -1120 592
WIRE -1104 -368 -1232 -368
WIRE -1056 592 -1120 592
WIRE -1040 848 -1248 848
WIRE -1024 720 -1024 688
WIRE -1008 112 -1072 112
WIRE -1008 208 -1056 208
WIRE -1008 208 -1008 112
WIRE -992 288 -1056 288
WIRE -992 288 -992 272
WIRE -960 -80 -1072 -80
WIRE -960 208 -1008 208
WIRE -960 272 -992 272
WIRE -912 688 -1024 688
WIRE -912 720 -912 688
WIRE -912 848 -960 848
WIRE -912 848 -912 800
WIRE -880 -480 -1424 -480
WIRE -880 -368 -1024 -368
WIRE -880 -368 -880 -480
WIRE -880 -352 -880 -368
WIRE -880 -80 -896 -80
WIRE -880 -80 -880 -352
WIRE -880 176 -880 112
WIRE -832 592 -976 592
WIRE -832 784 -832 592
WIRE -816 -352 -880 -352
WIRE -800 592 -832 592
WIRE -800 592 -800 496
WIRE -736 272 -800 272
WIRE -720 496 -800 496
WIRE -720 592 -800 592
WIRE -704 784 -832 784
WIRE -704 848 -912 848
WIRE -688 208 -800 208
WIRE -688 736 -688 704
WIRE -656 -352 -736 -352
WIRE -656 208 -688 208
WIRE -656 928 -672 928
WIRE -640 736 -640 704
WIRE -640 928 -656 928
WIRE -640 928 -640 896
WIRE -592 -352 -656 -352
WIRE -560 496 -656 496
WIRE -560 592 -640 592
WIRE -560 592 -560 496
WIRE -496 592 -560 592
WIRE -496 816 -592 816
WIRE -496 816 -496 592
WIRE -448 192 -448 96
WIRE -416 -416 -416 -480
WIRE -416 -112 -416 -176
WIRE -416 272 -736 272
WIRE -416 448 -416 272
WIRE -400 96 -448 96
WIRE -384 448 -416 448
WIRE -304 -416 -304 -480
WIRE -304 720 -304 656
WIRE -304 880 -304 800
WIRE -272 96 -320 96
WIRE -272 112 -272 96
WIRE -272 208 -272 176
WIRE -272 240 -272 208
WIRE -272 352 -272 320
WIRE -272 368 -272 352
WIRE -272 448 -304 448
WIRE -272 448 -272 432
WIRE -272 592 -496 592
WIRE -208 -256 -240 -256
WIRE -144 656 -304 656
WIRE -128 96 -272 96
WIRE -128 176 -128 96
WIRE -128 208 -272 208
WIRE -128 240 -128 208
WIRE -128 352 -272 352
WIRE -128 352 -128 304
WIRE -128 448 -272 448
WIRE -128 448 -128 368
WIRE -96 176 -128 176
WIRE -96 240 -128 240
WIRE -96 304 -128 304
WIRE -96 368 -128 368
WIRE -80 -256 -128 -256
WIRE -48 144 -48 96
WIRE 32 144 32 32
WIRE 32 480 -48 480
WIRE 32 480 32 400
WIRE 48 -352 -240 -352
WIRE 48 -256 -16 -256
WIRE 48 -96 0 -96
WIRE 48 -96 48 -256
WIRE 80 720 80 656
WIRE 80 880 80 800
WIRE 144 -576 144 -672
WIRE 144 -464 144 -576
WIRE 144 -352 48 -352
WIRE 144 -352 144 -464
WIRE 144 -288 144 -352
WIRE 176 32 176 -32
WIRE 176 656 80 656
WIRE 208 336 144 336
WIRE 208 592 -272 592
WIRE 208 592 208 336
WIRE 224 -464 144 -464
WIRE 224 -288 144 -288
WIRE 224 208 144 208
WIRE 240 -672 144 -672
WIRE 240 -576 144 -576
WIRE 240 -32 176 -32
WIRE 304 -208 272 -208
WIRE 320 -368 320 -384
WIRE 384 -576 304 -576
WIRE 384 -464 304 -464
WIRE 384 -464 384 -576
WIRE 384 208 224 208
WIRE 400 -672 304 -672
WIRE 400 -576 384 -576
WIRE 400 -576 400 -672
WIRE 448 -256 336 -256
WIRE 448 1280 448 1216
WIRE 448 1440 448 1360
WIRE 464 -576 400 -576
WIRE 464 -464 384 -464
WIRE 464 -320 336 -320
WIRE 464 -320 464 -464
WIRE 464 -32 320 -32
WIRE 464 144 464 -32
WIRE 464 1008 464 944
WIRE 464 1168 464 1088
WIRE 480 736 480 656
WIRE 480 880 480 816
WIRE 544 1216 448 1216
WIRE 560 944 464 944
WIRE 576 -256 528 -256
WIRE 576 -208 576 -256
WIRE 576 -32 464 -32
WIRE 576 656 480 656
WIRE 592 -464 464 -464
WIRE 592 144 464 144
WIRE 592 208 464 208
WIRE 608 96 608 64
WIRE 608 656 576 656
WIRE 640 288 624 288
WIRE 656 96 656 64
WIRE 656 288 640 288
WIRE 656 288 656 256
WIRE 752 176 704 176
WIRE 768 992 768 928
WIRE 768 1152 768 1072
WIRE 800 -464 672 -464
WIRE 800 -32 656 -32
WIRE 800 -32 800 -464
WIRE 800 176 752 176
WIRE 800 176 800 -32
WIRE 864 928 768 928
WIRE 880 -576 544 -576
WIRE 880 720 880 656
WIRE 880 848 880 800
WIRE 960 656 880 656
WIRE 992 336 992 288
WIRE 992 448 992 416
WIRE 1008 64 1008 0
WIRE 1008 176 1008 144
WIRE 1008 656 960 656
WIRE 1104 288 992 288
WIRE 1104 336 1104 288
WIRE 1104 432 1104 400
WIRE 1104 448 1104 432
WIRE 1136 0 1008 0
WIRE 1136 976 1136 912
WIRE 1136 1136 1136 1056
WIRE 1184 80 1184 32
WIRE 1216 32 1184 32
WIRE 1232 336 1232 288
WIRE 1232 432 1104 432
WIRE 1232 432 1232 416
WIRE 1232 912 1136 912
WIRE 1280 704 1280 656
WIRE 1280 848 1280 784
WIRE 1328 288 1232 288
WIRE 1392 656 1280 656
WIRE 1408 32 1312 32
WIRE 1408 80 1408 32
WIRE 1424 288 1328 288
WIRE 1424 320 1424 288
WIRE 1424 432 1232 432
WIRE 1424 432 1424 400
WIRE 1440 0 1312 0
WIRE 1440 656 1392 656
WIRE 1472 0 1440 0
WIRE 1664 368 1664 224
WIRE 1664 496 1664 448
WIRE 1792 944 1792 896
WIRE 1792 1056 1792 1024
WIRE 1808 704 1808 656
WIRE 1808 816 1808 784
WIRE 1824 224 1664 224
WIRE 1824 272 1824 224
WIRE 1824 400 1824 352
WIRE 1824 896 1792 896
WIRE 1840 656 1808 656
WIRE 1952 224 1824 224
FLAG 32 32 Vcc
FLAG -48 480 Vss
FLAG -304 880 0
FLAG 448 1440 0
FLAG -144 656 Vcc
FLAG 544 1216 dac3
FLAG -736 272 mon
FLAG -1280 112 Vcc
IOPIN -1280 112 BiDir
FLAG -1328 400 Vss
IOPIN -1328 400 BiDir
FLAG -1728 256 TEC_Curr_Cont
FLAG -448 192 0
FLAG 880 848 0
FLAG -640 704 Vcc
FLAG -656 928 Vss
FLAG -1120 640 0
FLAG -1248 848 5Vref
IOPIN -1248 848 BiDir
FLAG -272 592 offset
FLAG 80 880 0
FLAG 176 656 Vss
FLAG 224 208 Inamp_Out
FLAG 656 64 Vcc
FLAG 640 288 Vss
FLAG 176 32 0
FLAG 752 176 Gain1
FLAG 272 -368 Vcc
FLAG 304 -208 Vss
FLAG 576 -208 0
FLAG 48 -352 TEC_error
FLAG -416 -112 Vss
FLAG -416 -480 Vcc
FLAG -1648 -240 Vcc
FLAG -1664 16 Vss
FLAG -1120 -208 Vcc
FLAG -1136 32 Vss
FLAG -1312 -80 5Vref
IOPIN -1312 -80 BiDir
FLAG -1760 64 0
FLAG -656 -352 Int_Out
FLAG 1280 848 0
FLAG 0 -96 disable_5V
IOPIN 0 -96 In
FLAG 1104 448 0
FLAG 1328 288 TEC_Ramp_Rate
FLAG 768 1152 0
FLAG 864 928 dac2
FLAG -688 208 TEC_Temp
FLAG -1024 720 0
FLAG 480 880 0
FLAG -1072 112 V5V
IOPIN -1072 112 BiDir
FLAG 576 656 V5V
FLAG 960 656 5Vref
FLAG 880 -576 dac1
IOPIN 880 -576 BiDir
FLAG 1392 656 disable_5V
FLAG 992 448 0
FLAG 1184 80 0
FLAG 1408 80 0
FLAG 1440 0 TEC_Temp_Del
FLAG 1664 496 0
FLAG 1952 224 slew
FLAG 1136 1136 0
FLAG 1232 912 ramp
FLAG 1808 816 0
FLAG 1840 656 dac1_old
IOPIN 1840 656 Out
FLAG 464 1168 0
FLAG 560 944 V1V
FLAG 1824 400 0
FLAG 1792 1056 0
FLAG 1824 896 dac1
IOPIN 1824 896 Out
FLAG 1008 176 0
FLAG -1696 -224 V1V
FLAG -1168 -192 V1V
FLAG -1472 112 V1V
IOPIN -1472 112 BiDir
FLAG -880 112 V1V
FLAG -48 96 V1V
FLAG -688 704 V1V
FLAG 320 -384 V1V
FLAG 608 64 V1V
FLAG -304 -480 V1V
SYMBOL ad620b 32 272 R0
SYMATTR InstName U1
SYMBOL res -288 224 R0
SYMATTR InstName R1
SYMATTR Value 5.49K
SYMBOL cap -288 112 R0
SYMATTR InstName C1
SYMATTR Value 1000p
SYMBOL cap -288 368 R0
SYMATTR InstName C2
SYMATTR Value 1000p
SYMBOL res -304 80 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R2
SYMATTR Value 1000
SYMBOL res -288 432 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R3
SYMATTR Value 1000
SYMBOL voltage -304 704 R0
WINDOW 39 24 132 Left 0
WINDOW 123 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PWL(0 0 1 0 11 12 10000 12)
SYMBOL voltage 448 1264 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 132 Left 0
SYMATTR SpiceLine Rser=10 Cpar=1u
SYMATTR InstName V2
SYMATTR Value PWL(0 0 20 0 21 {5.0*dac_setting/2**dac_bits} 4000 {5.0*dac_setting/2**dac_bits} 4001 331.22mV 8000 331.22mV)
SYMBOL TEC_CUR_SRC -1376 288 R0
SYMATTR InstName X2
SYMBOL res -624 576 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R4
SYMATTR Value 13.7K
SYMBOL res -960 576 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R5
SYMATTR Value 93.1G
SYMBOL cap -656 480 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C3
SYMATTR Value 1000p
SYMBOL res -944 832 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R6
SYMATTR Value 5K
SYMBOL op200a -656 816 R0
SYMATTR InstName U3
SYMBOL res 672 -48 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R8
SYMATTR Value 23.7K
SYMBOL res 336 -48 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R9
SYMATTR Value 22.1k
SYMBOL res 480 192 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R10
SYMATTR Value 6.65K
SYMBOL op200a 640 176 R0
SYMATTR InstName U2
SYMBOL res 208 -480 M90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 576 -480 M90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R12
SYMATTR Value 10.0K
SYMBOL res 432 -272 M90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R13
SYMATTR Value 4.99K
SYMBOL res 448 -592 M90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R14
SYMATTR Value 10K
SYMBOL op200a 288 -288 M0
SYMATTR InstName U4
SYMBOL res -720 -368 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R15
SYMATTR Value 1000
SYMBOL res -1552 -384 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R16
SYMATTR Value 1Meg
SYMBOL res -1008 -384 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R17
SYMATTR Value 1Meg
SYMBOL diode -1520 -80 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D2
SYMATTR Value D1N6638
SYMBOL diode -896 -96 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName D3
SYMATTR Value D1N6638
SYMBOL op200a -1136 -80 R0
SYMATTR InstName U7
SYMBOL op200a -1664 -96 R0
SYMATTR InstName U8
SYMBOL voltage 80 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 132 Left 0
SYMATTR InstName V4
SYMATTR Value PWL(0 0 1 0 11 -12 10000 -12)
SYMBOL voltage 880 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 132 Left 0
SYMATTR InstName V3
SYMATTR Value PWL(0 0 1 0 11 5 10000 5)
SYMBOL diode 304 -592 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName D1
SYMATTR Value D1N5711
SYMBOL res -112 -272 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R18
SYMATTR Value 120K
SYMBOL cap 1088 336 R0
SYMATTR InstName C4
SYMATTR Value 1.0
SYMBOL bi2 1232 336 R0
WINDOW 3 39 57 Left 0
SYMATTR Value I=I(C4)
SYMATTR InstName B2
SYMBOL res 1408 304 R0
SYMATTR InstName R7
SYMATTR Value 60
SYMBOL Integrator_Block_NoZener -416 -304 M0
SYMATTR InstName X3
SYMBOL voltage 768 976 R0
SYMATTR InstName V12
SYMATTR Value PWL file=dac_ramp2.txt
SYMBOL diode -16 -272 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName D4
SYMATTR Value D1N6638
SYMBOL voltage 1280 688 R0
WINDOW 123 0 0 Left 0
WINDOW 39 45 44 Left 0
WINDOW 3 43 71 Left 0
SYMATTR Value PWL(0 0 10 0 11 5 80 5 81 0 10000 0)
SYMATTR InstName V5
SYMBOL TEC_block1 -880 240 R0
WINDOW 39 -122 91 Left 0
SYMATTR SpiceLine Tcool=130 Twarm=130 Ambient=30 initial_temp=30
SYMATTR InstName X4
SYMBOL res -928 704 R0
SYMATTR InstName R19
SYMATTR Value 281k
SYMBOL voltage 480 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 132 Left 0
SYMATTR InstName V11
SYMATTR Value PWL(0 0 1 0 11 5 10000 5)
SYMBOL res 1232 -16 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R20
SYMATTR Value 50
SYMBOL tline 1264 16 R0
SYMATTR InstName T1
SYMATTR Value Td=60 Z0=50
SYMBOL voltage 1136 960 R0
WINDOW 3 24 44 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 24 72 Left 0
SYMATTR Value PWL(0 0 81 0 1747.7 5.00 2000 5.00 3666.7 0 4000 0)
SYMATTR InstName V14
SYMBOL bv 1808 688 R0
WINDOW 39 32 130 Left 0
WINDOW 3 32 104 Left 0
SYMATTR SpiceLine tripdv=10m tripdt=10m
SYMATTR Value V=int(V(ramp)/120m)*120m
SYMATTR InstName B5
SYMBOL diode 240 -656 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D5
SYMATTR Value D1N5711
SYMBOL voltage 464 992 R0
WINDOW 3 24 44 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value 1V
SYMATTR InstName V15
SYMBOL res 1808 256 R0
SYMATTR InstName R22
SYMATTR Value 1.0
SYMBOL bv 1792 928 R0
WINDOW 39 32 130 Left 0
WINDOW 3 32 104 Left 0
SYMATTR Value V=V(ramp)
SYMATTR InstName B4
SYMBOL bv 992 320 R0
WINDOW 3 2 177 Left 0
SYMATTR Value V=V(TEC_Temp)*V(V1V)
SYMATTR InstName B6
SYMBOL bv 1008 48 R0
WINDOW 3 40 122 Left 0
SYMATTR Value V=V(TEC_Temp)*V(V1V)
SYMATTR InstName B1
SYMBOL bv 1664 352 R0
SYMATTR InstName B7
SYMATTR Value V=V(TEC_Temp,TEC_Temp_Del)*V(V1V)
TEXT -1376 1376 Left 0 !.tran 0 4000 11.1 10
TEXT -1376 1184 Left 0 !.inc op200a.cir
TEXT -1376 1152 Left 0 !.model MySw SW(Ron=.1 Roff=100G Vt=0.5 )
TEXT 1312 832 Left 0 ;Loop Enabled at t=62sec
TEXT -1376 1240 Left 0 !.param dac_setting=1024\n.param dac_bits=10
TEXT -1376 1096 Left 0 !.MODEL D1N6638 D (IS=99.5918N N=2.5 BV=150 RS=765.257M TT=1.87665N CJO=2P\n+ VJ=747.596M M=324.028M RL=303.561MEG)
TEXT -1376 1408 Left 0 !;dc V7 1 5 1
TEXT -1376 1440 Left 0 !;op
TEXT -2064 712 Left 0 ;Remove R5 (Note it is 93.1 Gohm in simulation) and add R19=281kohm, 1%.\nThis is one of the changes required to scale the zero code of the DAC to\n+40 degrees C.
TEXT 136 -176 Left 0 ;Change the value of R9 from 9.42kohm to 22.1kohm\nThis is an additional change required to scale the DAC\nzero code to +40C. The full scale range of DAC will now be\nfrom +40 degrees C to about -60 degrees C.
TEXT 416 -704 Left 0 ;Add diode D5 to limit the maximum integrator\nslew rate when the servo is commanded to warm\nthe TEC.
TEXT -1376 1312 Left 0 ;.options gminsteps=0\n.options gmin=1e-10
TEXT -1376 1064 Left 0 !.MODEL D1N5711 D(Is=22.31n N=1.347 Rs=17.29 Ikf=42.09 Xti=5 Eg=.7 Cjo=1.397p M=.1659 Vj=.3914 Fc=.5 Isr=23.92n Nr=4.99 Bv=70 Ibv=10u Tt=144.3p)
TEXT -1376 1216 Left 0 !.inc 2n7292.cir
CIRCLE Normal -832 960 -1200 512
CIRCLE Normal 400 112 128 -80
CIRCLE Normal 352 -624 192 -720
