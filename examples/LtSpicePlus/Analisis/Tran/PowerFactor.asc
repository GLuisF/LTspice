Version 4
SHEET 1 912 876
WIRE 400 16 320 16
WIRE 480 16 400 16
WIRE 544 16 480 16
WIRE 560 16 544 16
WIRE 320 48 320 16
WIRE 400 48 400 16
WIRE 160 112 128 112
WIRE 192 112 160 112
WIRE 128 128 128 112
WIRE 480 128 480 16
WIRE 560 128 560 16
WIRE 192 144 192 112
WIRE 400 144 400 112
WIRE 400 144 192 144
WIRE 320 192 320 112
WIRE 320 192 192 192
WIRE 128 224 128 208
WIRE 160 224 128 224
WIRE 192 224 192 192
WIRE 192 224 160 224
WIRE 320 224 320 192
WIRE 400 224 400 144
WIRE 320 304 320 288
WIRE 400 304 400 288
WIRE 400 304 320 304
WIRE 480 304 480 192
WIRE 480 304 400 304
WIRE 560 304 560 208
WIRE 560 304 480 304
WIRE 560 336 560 304
WIRE 144 384 128 384
WIRE 160 384 144 384
WIRE 240 384 224 384
WIRE 256 384 240 384
WIRE 368 384 320 384
WIRE 128 400 128 384
WIRE 224 400 224 384
WIRE 320 400 320 384
WIRE 128 496 128 480
WIRE 224 496 224 480
WIRE 320 496 320 480
FLAG 560 336 0
FLAG 160 112 1
FLAG 160 224 2
FLAG 320 496 0
FLAG 128 496 0
FLAG 144 384 3
FLAG 224 496 0
FLAG 240 384 4
FLAG 544 16 o
FLAG 368 384 PF
IOPIN 368 384 Out
SYMBOL voltage 128 112 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value SINE(0 {10*2**.5} {f})
SYMBOL schottky 336 112 R180
WINDOW 0 24 72 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 464 128 R0
SYMATTR InstName C1
SYMATTR Value {C}
SYMBOL res 544 112 R0
SYMATTR InstName R1
SYMATTR Value 10
SYMBOL bv 320 384 M0
WINDOW 3 0 176 Center 2
SYMATTR Value V=sdt(0,limit(0,1,sdt(I(V1)*V(2,1),0,V(4))/(sdt(I(V1)**2,0,V(4))*sdt(V(2,1)**2,0,V(4)))**.5),V(3))
SYMATTR InstName B1
SYMBOL voltage 128 384 M0
WINDOW 3 16 96 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 1 {1/f} 5n 5n 15n {1/f})
SYMATTR InstName V2
SYMBOL voltage 224 384 M0
WINDOW 3 0 144 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 1 {1/f+20n} 5n 5n 15n {1/f})
SYMATTR InstName V3
SYMBOL schottky 336 288 R180
WINDOW 0 24 72 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 416 112 R180
WINDOW 0 24 72 Left 2
WINDOW 3 24 0 Invisible 2
SYMATTR InstName D3
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 416 288 R180
WINDOW 0 24 72 Left 2
WINDOW 3 24 0 Invisible 2
SYMATTR InstName D4
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
TEXT -80 304 Left 2 !.tran {5/f}
TEXT -80 336 Left 2 !.param C=1m f=50
TEXT 536 336 Right 2 !.step param C list 0m1 1m0 10m
TEXT 320 -40 Center 2 ;B-source Power Factor Calculation
TEXT 96 600 Left 2 ;V2 and V3 generate hold and reset pulses for the B integrators.\nB1 calculates power factor over one cycle of "f" and also\nfunctions as a sample and hold for the prior cycle's PF.
TEXT 440 384 Left 2 ;Power Factor
