Version 4
SHEET 1 2660 2468
WIRE 2080 -640 2016 -640
WIRE 1136 112 1072 112
WIRE 144 128 80 128
WIRE 592 128 144 128
WIRE 720 128 656 128
WIRE 1072 144 1072 112
WIRE 80 160 80 128
WIRE 1072 272 1072 224
WIRE 80 288 80 240
WIRE 96 592 64 592
WIRE 176 592 96 592
WIRE 304 592 240 592
WIRE 368 592 304 592
WIRE 496 592 432 592
WIRE 560 592 496 592
WIRE 688 592 624 592
WIRE 736 592 688 592
WIRE 848 592 800 592
WIRE 864 592 848 592
WIRE 1008 592 928 592
WIRE 64 640 64 592
WIRE 928 640 928 592
WIRE 64 752 64 720
WIRE 928 752 928 720
WIRE 624 1040 448 1040
WIRE 848 1040 688 1040
WIRE 1072 1040 912 1040
WIRE 1280 1040 1136 1040
WIRE 1424 1040 1344 1040
WIRE 448 1152 448 1040
WIRE 656 1152 656 1072
WIRE 880 1152 880 1072
WIRE 1104 1152 1104 1072
WIRE 1312 1152 1312 1072
WIRE 176 1264 128 1264
WIRE 272 1264 208 1264
WIRE 400 1264 336 1264
WIRE 448 1264 448 1184
WIRE 448 1264 400 1264
WIRE 496 1264 448 1264
WIRE 608 1264 560 1264
WIRE 656 1264 656 1184
WIRE 656 1264 608 1264
WIRE 720 1264 656 1264
WIRE 832 1264 784 1264
WIRE 880 1264 880 1184
WIRE 880 1264 832 1264
WIRE 944 1264 880 1264
WIRE 1056 1264 1008 1264
WIRE 1104 1264 1104 1184
WIRE 1104 1264 1056 1264
WIRE 1152 1264 1104 1264
WIRE 1264 1264 1216 1264
WIRE 1312 1264 1312 1184
WIRE 1312 1264 1264 1264
WIRE 656 1328 656 1264
WIRE 880 1328 880 1264
WIRE 1104 1328 1104 1264
WIRE 1312 1328 1312 1264
WIRE 656 1456 656 1360
WIRE 880 1456 880 1360
WIRE 1104 1456 1104 1360
WIRE 304 1488 304 1296
WIRE 624 1488 304 1488
WIRE 848 1488 688 1488
WIRE 1072 1488 912 1488
WIRE 1312 1488 1312 1360
WIRE 1312 1488 1136 1488
WIRE 160 1824 96 1824
WIRE 272 1824 192 1824
WIRE 592 1824 272 1824
WIRE 864 1824 592 1824
WIRE 1136 1824 864 1824
WIRE 1408 1824 1136 1824
WIRE 272 1920 272 1824
WIRE 592 1920 592 1824
WIRE 864 1920 864 1824
WIRE 1136 1920 1136 1824
WIRE 1408 1920 1408 1824
WIRE 272 2016 272 1952
WIRE 592 2016 592 1952
WIRE 864 2016 864 1952
WIRE 1136 2016 1136 1952
WIRE 1408 2016 1408 1952
WIRE 240 2048 208 2048
WIRE 352 2048 304 2048
WIRE 400 2048 352 2048
WIRE 512 2048 464 2048
WIRE 560 2048 512 2048
WIRE 672 2048 624 2048
WIRE 784 2048 736 2048
WIRE 832 2048 784 2048
WIRE 944 2048 896 2048
WIRE 1056 2048 1008 2048
WIRE 1104 2048 1056 2048
WIRE 1216 2048 1168 2048
WIRE 1328 2048 1280 2048
WIRE 1376 2048 1328 2048
WIRE 1488 2048 1440 2048
WIRE 1536 2048 1488 2048
WIRE 208 2064 208 2048
WIRE 592 2160 592 2080
WIRE 864 2160 864 2080
WIRE 1136 2160 1136 2080
WIRE 272 2176 272 2080
WIRE 272 2272 272 2208
WIRE 592 2272 592 2192
WIRE 592 2272 272 2272
WIRE 864 2272 864 2192
WIRE 864 2272 592 2272
WIRE 1136 2272 1136 2192
WIRE 1136 2272 864 2272
WIRE 1488 2272 1488 2048
WIRE 1488 2272 1136 2272
FLAG 80 288 0
FLAG 144 128 in0
FLAG 1072 272 0
FLAG 1136 112 z_phase1
FLAG 64 752 0
FLAG 304 592 z_1
FLAG 496 592 z_2
FLAG 688 592 z_3
FLAG 928 752 0
FLAG 96 592 sum
FLAG 1008 592 out
IOPIN 1008 592 Out
FLAG 720 128 in
IOPIN 720 128 Out
FLAG 848 592 z_4
FLAG 608 1264 z_1_
FLAG 832 1264 z_2_
FLAG 1056 1264 z_3_
FLAG 400 1264 sum_
FLAG 1424 1040 out_
IOPIN 1424 1040 Out
FLAG 1264 1264 z_4_
FLAG 128 1264 in
IOPIN 128 1264 In
FLAG 512 2048 z_1_t
FLAG 784 2048 z_2_t
FLAG 1056 2048 z_3_t
FLAG 352 2048 sum_t
FLAG 1536 2048 out_t
IOPIN 1536 2048 Out
FLAG 1328 2048 z_4_t
FLAG 96 1824 in
IOPIN 96 1824 In
FLAG 208 2064 0
SYMBOL voltage 80 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(-1 +1 {TS/2} 1p 1p 5m 10m)
SYMBOL voltage 1072 128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 1 0 1p 1p {1m*TS} {TS})
SYMBOL bv 64 624 R0
SYMATTR InstName SUM1
SYMATTR Value V={G1}*V(in) -(A1*V(z_1)+A2*V(z_2)+A3*V(z_3)+A4*V(z_4))
SYMBOL bv 928 624 R0
SYMATTR InstName SUM2
SYMATTR Value V=B0*V(sum) + B1*V(z_1) + B2*V(z_2) + B3*V(z_3) + B4*V(z_4)
SYMBOL Z_0_sh 624 128 R0
WINDOW 39 -33 52 Left 0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X5
SYMBOL Z_gain 1312 1360 R0
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A4
SYMATTR InstName X32
SYMBOL Z_gain 1104 1360 R0
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A3
SYMATTR InstName X33
SYMBOL Z_gain 880 1360 R0
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A2
SYMATTR InstName X34
SYMBOL Z_gain 656 1360 R0
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A1
SYMATTR InstName X35
SYMBOL z_gain 448 1152 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B0
SYMATTR InstName X40
SYMBOL z_gain 656 1152 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B1
SYMATTR InstName X44
SYMBOL z_gain 880 1152 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B2
SYMATTR InstName X45
SYMBOL z_gain 1104 1152 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B3
SYMATTR InstName X46
SYMBOL z_gain 1312 1152 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B4
SYMATTR InstName X47
SYMBOL z_gain 208 1264 M90
WINDOW 39 34 7 VLeft 0
SYMATTR SpiceLine G=G1
SYMATTR InstName X49
SYMBOL z_sum2p 656 1040 R0
SYMATTR InstName X36
SYMBOL z_sum2p 1104 1040 R0
SYMATTR InstName X37
SYMBOL z_sum2p 1312 1040 R0
SYMATTR InstName X38
SYMBOL z_sum2p 880 1040 R0
SYMATTR InstName X42
SYMBOL z_sum2p 1104 1488 R180
SYMATTR InstName X41
SYMBOL z_sum2p 880 1488 R180
SYMATTR InstName X43
SYMBOL z_sum2p 656 1488 R180
SYMATTR InstName X48
SYMBOL z_sum1p1n 304 1264 R0
SYMATTR InstName X50
SYMBOL Z_gain 272 2176 M180
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A4
SYMATTR InstName X10
SYMBOL Z_gain 592 2160 M180
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A3
SYMATTR InstName X11
SYMBOL Z_gain 864 2160 M180
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A2
SYMATTR InstName X12
SYMBOL Z_gain 1136 2160 M180
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A1
SYMATTR InstName X13
SYMBOL z_gain 1408 1952 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B0
SYMATTR InstName X14
SYMBOL z_gain 1136 1952 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B1
SYMATTR InstName X15
SYMBOL z_gain 864 1952 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B2
SYMATTR InstName X16
SYMBOL z_gain 592 1952 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B3
SYMATTR InstName X17
SYMBOL z_gain 272 1952 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B4
SYMATTR InstName X18
SYMBOL z_gain 192 1824 M90
WINDOW 39 34 7 VLeft 0
SYMATTR SpiceLine G=G1
SYMATTR InstName X19
SYMBOL z_sum2p1n 592 2048 R0
SYMATTR InstName X20
SYMBOL z_sum2p1n 864 2048 R0
SYMATTR InstName X21
SYMBOL z_sum2p1n 1136 2048 R0
SYMATTR InstName X23
SYMBOL z_sum2p1n 272 2048 R0
SYMATTR InstName X24
SYMBOL z_sum2p 1408 2048 M180
SYMATTR InstName X25
SYMBOL Z_1_sh 208 592 R0
WINDOW 39 -42 56 Left 0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X1
SYMBOL Z_1_sh 400 592 R0
SYMATTR InstName X2
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 592 592 R0
SYMATTR InstName X3
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 768 592 R0
SYMATTR InstName X4
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 528 1264 R0
SYMATTR InstName X6
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 752 1264 R0
SYMATTR InstName X7
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 976 1264 R0
SYMATTR InstName X8
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 1184 1264 R0
SYMATTR InstName X9
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 432 2048 R0
SYMATTR InstName X22
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 704 2048 R0
SYMATTR InstName X26
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 976 2048 R0
SYMATTR InstName X27
SYMATTR SpiceLine TS={TS}
SYMBOL Z_1_sh 1248 2048 R0
SYMATTR InstName X28
SYMATTR SpiceLine TS={TS}
TEXT 0 -264 Left 0 !.PARAM FS=10k
TEXT 0 -232 Left 0 !.PARAM TS=1/FS
TEXT 8 -312 Left 0 !.tran 150m
TEXT 0 -96 Left 0 !.PARAM  G1=0.00482434336   \n.PARAM   B0=1  B1=4  B2=6  B3=4  B4=1\n.PARAM   A0=1.0  A1=-2.369513   A2=2.3139884 A3=-1.0546654  A4=0.187379492
TEXT 288 -352 Left 0 ;.options plotwinsize=0
TEXT 8 -352 Left 0 !.options reltol=1e-5
TEXT 1544 168 Left 0 !.GLOBAL z_phase1
TEXT 48 504 Left 0 ;Direct Form II
TEXT 1104 64 Left 0 ;Pulses Generators used by  |Z-1| and |Z-0|
TEXT 0 -128 Left 0 ;Example: 4th order Butterworth lowpass, fg=0.1*fs
TEXT 232 -264 Left 0 ;sampling frequency
TEXT 584 56 Left 0 ;Sampler
TEXT 72 72 Left 0 ;Source for step response
TEXT 544 216 Left 0 ;Aperture time is 1e-3*TS_period
TEXT 8 -1160 Left 0 ;Simulation Of Sampled Systems with Z-Transform, Helmut Sennewald V2.0\n \nThe input signal is sampled with the z^0 sampler with nearly zero delay.\nIt may be replaced by your A/D converter.\n \nTwo realizations of Z-transform filters have been investigated, "Direct Form II" \nand "Direct Transposed Form II". I recommend to go with " Direct Form II",\nbecause it is less effort to use it in SPICE. The used delay elements z^-1\nconsist of a sample and hold stage with a small capacitor. They \ncan't be used for a frequency analysis. A second schematic with e^-sT\ndelay elements is necessary for the AC analysis.\nClick the right hand mouse button over the symbols to see the passed parameters.\n \nH(z) = G1 * ( B0 + B1*z^-1 + B2*z^-2  + .... Bn*z^-n) / (1 + A1*z^^-1 + A2*z^-2 + A3*z^-3 + ... Am*z^-m)    B0 = 1
TEXT 8 392 Left 0 ;Delay with sample and hold z_1_sh.asy
TEXT 536 264 Left 0 ;Sample and hold z_0_sh.asy
TEXT 1544 -328 Left 0 ;Z
TEXT 1560 -344 Left 0 ;-1
TEXT 1720 -328 Left 0 ;Z
TEXT 1736 -344 Left 0 ;-1
TEXT 1368 -328 Left 0 ;Z
TEXT 1384 -344 Left 0 ;-1
TEXT 1192 -328 Left 0 ;Z
TEXT 1208 -344 Left 0 ;-1
TEXT 1456 -208 Left 0 ;A2
TEXT 1280 -208 Left 0 ;A1
TEXT 1632 -208 Left 0 ;A3
TEXT 1808 -208 Left 0 ;A4
TEXT 912 -336 Left 0 ;G1
TEXT 1016 -336 Left 0 ;+
TEXT 856 -352 Left 0 ;IN
TEXT 1136 -144 Left 0 ;+
TEXT 1136 -112 Left 0 ;+
TEXT 1136 -80 Left 0 ;+
TEXT 1136 -48 Left 0 ;+
TEXT 1040 -320 Left 0 ;-
TEXT 1456 -496 Left 0 ;B2
TEXT 1280 -496 Left 0 ;B1
TEXT 1632 -496 Left 0 ;B3
TEXT 1808 -496 Left 0 ;B4
TEXT 1960 -672 Left 0 ;+
TEXT 1960 -640 Left 0 ;+
TEXT 1960 -608 Left 0 ;+
TEXT 1960 -576 Left 0 ;+
TEXT 1104 -496 Left 0 ;B0
TEXT 1960 -704 Left 0 ;+
TEXT 2040 -664 Left 0 ;OUT
TEXT 1096 -320 Left 0 ;sum
TEXT 1360 -752 Left 0 ;Direct Form II  4th Order System
TEXT 40 984 Left 0 ;Direct Form II
TEXT 24 1760 Left 0 ;Transposed Direct Form II
TEXT 640 504 Left 0 ;Delay with sample and hold z_1_sh.asy
TEXT 1248 960 Left 0 ;Used symbols: z_1_sh.asy
TEXT 16 -720 Left 0 ;Used symbols:\n                          z_0_sh.asy\n                          z_1_sh.asy\n                          z_gain.asy\n                          z_sum_2p.asy\n                          z_sum_1p1n.asy\n                          z_sum_2p1n.asy\n \nThis is a hierarchical schematic.\nEach symbol has a corresponding \nschematic xxx.asc .
TEXT 232 -232 Left 0 ;sampling period
TEXT 1544 128 Left 0 ;Global CLOCK for S/H
LINE Normal 1344 -336 1248 -336
LINE Normal 1344 -336 1344 -336
LINE Normal 1520 -336 1424 -336
LINE Normal 1520 -336 1520 -336
LINE Normal 1696 -336 1600 -336
LINE Normal 1824 -336 1776 -336
LINE Normal 1296 -336 1296 -240
LINE Normal 1472 -336 1472 -240
LINE Normal 1648 -336 1648 -240
LINE Normal 1824 -336 1824 -240
LINE Normal 1296 -144 1296 -176
LINE Normal 1152 -144 1296 -144
LINE Normal 1472 -112 1472 -176
LINE Normal 1152 -112 1472 -112
LINE Normal 1648 -80 1648 -176
LINE Normal 1152 -80 1648 -80
LINE Normal 1824 -48 1824 -176
LINE Normal 1152 -48 1824 -48
LINE Normal 1056 -96 1088 -96
LINE Normal 1040 -96 1056 -96
LINE Normal 1040 -304 1040 -96
LINE Normal 1168 -336 1120 -336
LINE Normal 1168 -336 1168 -336
LINE Normal 1072 -336 1120 -336
LINE Normal 896 -336 864 -336
LINE Normal 896 -336 896 -336
LINE Normal 1008 -336 960 -336
LINE Normal 1008 -336 1008 -336
LINE Normal 1472 -464 1472 -336
LINE Normal 1296 -464 1296 -336
LINE Normal 1648 -464 1648 -336
LINE Normal 1824 -464 1824 -336
LINE Normal 1120 -464 1120 -336
LINE Normal 1296 -624 1296 -528
LINE Normal 1296 -672 1296 -624
LINE Normal 1952 -672 1296 -672
LINE Normal 1472 -608 1472 -528
LINE Normal 1472 -640 1472 -608
LINE Normal 1648 -608 1648 -528
LINE Normal 1648 -608 1648 -608
LINE Normal 1824 -544 1824 -528
LINE Normal 1824 -576 1824 -544
LINE Normal 1120 -608 1120 -528
LINE Normal 1120 -704 1120 -608
LINE Normal 1952 -640 1472 -640
LINE Normal 1952 -608 1648 -608
LINE Normal 1952 -576 1824 -576
LINE Normal 1952 -704 1120 -704
RECTANGLE Normal 1696 816 -16 464 2
RECTANGLE Normal 1840 320 1008 32 2
RECTANGLE Normal 960 320 528 32 2
RECTANGLE Normal 480 320 0 32 2
RECTANGLE Normal 1600 -304 1520 -368
RECTANGLE Normal 1776 -304 1696 -368
RECTANGLE Normal 1424 -304 1344 -368
RECTANGLE Normal 1248 -304 1168 -368
RECTANGLE Normal 1152 -32 1088 -160
RECTANGLE Normal 2016 -560 1952 -720
RECTANGLE Normal 1696 1584 -16 928 2
RECTANGLE Normal 1696 2352 -16 1712 2
RECTANGLE Normal 1808 208 1520 96
CIRCLE Normal 1504 -176 1440 -240
CIRCLE Normal 1328 -176 1264 -240
CIRCLE Normal 1680 -176 1616 -240
CIRCLE Normal 1856 -176 1792 -240
CIRCLE Normal 960 -304 896 -368
CIRCLE Normal 1072 -304 1008 -368
CIRCLE Normal 1504 -464 1440 -528
CIRCLE Normal 1328 -464 1264 -528
CIRCLE Normal 1680 -464 1616 -528
CIRCLE Normal 1856 -464 1792 -528
CIRCLE Normal 1152 -464 1088 -528
