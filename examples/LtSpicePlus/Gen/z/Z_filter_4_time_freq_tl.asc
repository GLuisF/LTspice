Version 4
SHEET 1 2632 2420
WIRE 48 240 48 208
WIRE 48 320 48 368
WIRE 48 208 384 208
WIRE 240 640 304 640
WIRE 432 640 496 640
WIRE 64 800 64 768
WIRE 64 688 64 640
WIRE 64 640 96 640
WIRE 304 640 368 640
WIRE 496 640 560 640
WIRE 928 800 928 768
WIRE 928 688 928 640
WIRE 688 640 736 640
WIRE 928 640 1008 640
WIRE 96 640 176 640
WIRE 800 640 848 640
WIRE 848 640 864 640
WIRE 1920 -208 1984 -208
WIRE 624 640 688 640
WIRE 560 1328 608 1328
WIRE 784 1328 832 1328
WIRE 336 1328 400 1328
WIRE 656 1328 720 1328
WIRE 880 1328 944 1328
WIRE 1008 1328 1056 1328
WIRE 1104 1328 1152 1328
WIRE 400 1328 448 1328
WIRE 1216 1328 1264 1328
WIRE 1264 1328 1312 1328
WIRE 272 1328 208 1328
WIRE 656 1328 656 1392
WIRE 656 1424 656 1520
WIRE 880 1392 880 1328
WIRE 1104 1392 1104 1328
WIRE 1312 1392 1312 1328
WIRE 1312 1424 1312 1552
WIRE 1104 1424 1104 1520
WIRE 880 1424 880 1520
WIRE 448 1248 448 1328
WIRE 448 1328 496 1328
WIRE 448 1216 448 1104
WIRE 656 1248 656 1328
WIRE 656 1216 656 1136
WIRE 880 1216 880 1136
WIRE 1104 1216 1104 1136
WIRE 1312 1216 1312 1136
WIRE 1136 1104 1280 1104
WIRE 1104 1248 1104 1328
WIRE 880 1248 880 1328
WIRE 1344 1104 1424 1104
WIRE 1312 1328 1312 1248
WIRE 176 1328 128 1328
WIRE 608 1328 656 1328
WIRE 832 1328 880 1328
WIRE 1056 1328 1104 1328
WIRE 688 1104 848 1104
WIRE 912 1104 1072 1104
WIRE 448 1104 624 1104
WIRE 1312 1552 1136 1552
WIRE 848 1552 688 1552
WIRE 1072 1552 912 1552
WIRE 624 1552 304 1552
WIRE 304 1360 304 1552
WIRE 464 2112 512 2112
WIRE 736 2112 784 2112
WIRE 304 2112 352 2112
WIRE 512 2112 560 2112
WIRE 1008 2112 1056 2112
WIRE 1056 2112 1104 2112
WIRE 1280 2112 1328 2112
WIRE 272 1888 192 1888
WIRE 592 2256 592 2336
WIRE 1488 2336 1488 2112
WIRE 1136 2256 1136 2336
WIRE 864 2256 864 2336
WIRE 864 1984 864 1888
WIRE 1136 1984 1136 1888
WIRE 1408 1984 1408 1888
WIRE 272 1888 592 1888
WIRE 1488 2112 1536 2112
WIRE 160 1888 96 1888
WIRE 1488 2336 1136 2336
WIRE 592 2336 272 2336
WIRE 272 2144 272 2240
WIRE 272 2272 272 2336
WIRE 352 2112 400 2112
WIRE 624 2112 672 2112
WIRE 896 2112 944 2112
WIRE 272 1984 272 1888
WIRE 864 1888 1136 1888
WIRE 1136 1888 1408 1888
WIRE 592 1984 592 1888
WIRE 592 1888 864 1888
WIRE 592 2016 592 2080
WIRE 272 2016 272 2080
WIRE 864 2016 864 2080
WIRE 1136 2016 1136 2080
WIRE 1136 2224 1136 2144
WIRE 864 2224 864 2144
WIRE 592 2224 592 2144
WIRE 1136 2336 864 2336
WIRE 864 2336 592 2336
WIRE 240 2112 208 2112
WIRE 208 2112 208 2128
WIRE 1440 2112 1488 2112
WIRE 1408 2016 1408 2080
WIRE 784 2112 832 2112
WIRE 1168 2112 1216 2112
WIRE 1328 2112 1376 2112
FLAG 48 368 0
FLAG 64 800 0
FLAG 304 640 z_1
FLAG 496 640 z_2
FLAG 688 640 z_3
FLAG 928 800 0
FLAG 96 640 sum
FLAG 1008 640 out
IOPIN 1008 640 Out
FLAG 384 208 in
IOPIN 384 208 Out
FLAG 848 640 z_4
FLAG 608 1328 z_1_
FLAG 832 1328 z_2_
FLAG 1056 1328 z_3_
FLAG 400 1328 sum_
FLAG 1424 1104 out_
IOPIN 1424 1104 Out
FLAG 1264 1328 z_4_
FLAG 128 1328 in
IOPIN 128 1328 In
FLAG 512 2112 z_1_t
FLAG 784 2112 z_2_t
FLAG 1056 2112 z_3_t
FLAG 352 2112 sum_t
FLAG 1536 2112 out_t
IOPIN 1536 2112 Out
FLAG 1328 2112 z_4_t
FLAG 96 1888 in
IOPIN 96 1888 In
FLAG 208 2128 0
SYMBOL voltage 48 224 R0
WINDOW 123 24 132 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName V1
SYMATTR Value PULSE(0 +1 0 100n 100n 5m 10m)
SYMBOL bv 64 672 R0
SYMATTR InstName SUM1
SYMATTR Value V={G1}*V(in) -(A1*V(z_1)+A2*V(z_2)+A3*V(z_3)+A4*V(z_4))
SYMBOL bv 928 672 R0
SYMATTR InstName SUM2
SYMATTR Value V=B0*V(sum) + B1*V(z_1) + B2*V(z_2) + B3*V(z_3) + B4*V(z_4)
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 208 640 R0
WINDOW 39 -40 53 Left 0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X1
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 400 640 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X2
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 592 640 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X3
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 768 640 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X5
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\Z_gain 1312 1424 R0
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A4
SYMATTR InstName X9
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\Z_gain 1104 1424 R0
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A3
SYMATTR InstName X10
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\Z_gain 880 1424 R0
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A2
SYMATTR InstName X11
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\Z_gain 656 1424 R0
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A1
SYMATTR InstName X12
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 448 1216 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B0
SYMATTR InstName X13
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 656 1216 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B1
SYMATTR InstName X14
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 880 1216 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B2
SYMATTR InstName X15
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 1104 1216 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B3
SYMATTR InstName X16
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 1312 1216 M180
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B4
SYMATTR InstName X17
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 208 1328 M90
WINDOW 39 34 7 VLeft 0
SYMATTR SpiceLine G=G1
SYMATTR InstName X18
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p 656 1104 R0
SYMATTR InstName X19
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p 1104 1104 R0
SYMATTR InstName X20
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p 1312 1104 R0
SYMATTR InstName X21
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p 880 1104 R0
SYMATTR InstName X22
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p 1104 1552 R180
SYMATTR InstName X23
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p 880 1552 R180
SYMATTR InstName X24
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p 656 1552 R180
SYMATTR InstName X25
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum1p1n 304 1328 R0
SYMATTR InstName X26
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\Z_gain 272 2240 M180
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A4
SYMATTR InstName X31
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\Z_gain 592 2224 M180
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A3
SYMATTR InstName X32
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\Z_gain 864 2224 M180
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A2
SYMATTR InstName X33
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\Z_gain 1136 2224 M180
WINDOW 39 13 -2 Left 0
SYMATTR SpiceLine G=A1
SYMATTR InstName X34
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 1408 2016 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B0
SYMATTR InstName X35
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 1136 2016 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B1
SYMATTR InstName X36
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 864 2016 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B2
SYMATTR InstName X37
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 592 2016 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B3
SYMATTR InstName X38
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 272 2016 R0
WINDOW 39 12 -9 Left 0
SYMATTR SpiceLine G=B4
SYMATTR InstName X39
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_gain 192 1888 M90
WINDOW 39 34 7 VLeft 0
SYMATTR SpiceLine G=G1
SYMATTR InstName X40
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p1n 592 2112 R0
SYMATTR InstName X41
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p1n 864 2112 R0
SYMATTR InstName X42
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p1n 1136 2112 R0
SYMATTR InstName X43
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p1n 272 2112 R0
SYMATTR InstName X44
SYMBOL D:\\WUTemp\\Z-transform\\Yahoo\\z_sum2p 1408 2112 M180
SYMATTR InstName X45
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 528 1328 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X4
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 752 1328 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X6
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 976 1328 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X7
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 1184 1328 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X8
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 432 2112 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X27
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 704 2112 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X28
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 976 2112 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X29
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 1248 2112 R0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X30
TEXT -24 -184 Left 0 !.PARAM FS=10k
TEXT -24 -152 Left 0 !.PARAM TS=1/FS
TEXT -24 -232 Left 0 !.tran 0 15m 0 {TS/100}
TEXT -24 -56 Left 0 !.PARAM  G1=0.00482434336   \n.PARAM   B0=1  B1=4  B2=6  B3=4  B4=1\n.PARAM   A0=1.0  A1=-2.369513   A2=2.3139884 A3=-1.0546654  A4=0.187379492
TEXT 480 -280 Left 0 !.options plotwinsize=0
TEXT 232 -280 Left 0 !.options reltol=1e-5
TEXT 48 552 Left 0 ;Direct Form II
TEXT -16 -88 Left 0 ;Example: 4th order Butterworth lowpass, fg=0.1*fs
TEXT 208 -184 Left 0 ;sampling frequency
TEXT 40 152 Left 0 ;Source for step response
TEXT 144 264 Left 0 ;The source signal has to be a sampled signal.
TEXT -24 -1080 Left 0 ;Simulation Of Sampled Systems with Z-Transform,   Helmut Sennewald  V2.0 \n \nThe input signal has to be a sampled signal.\nIt may be replaced by your A/D converter.\n \nTwo realizations of Z-transform filters have been investigated, "Direct Form II" \nand "Direct Transposed Form II". I recommend to go with " Direct Form II",\nbecause it is less effort to use it in SPICE. The used delay elements\nconsist of delay lines. They can be used for a frequency analysis too. \nClick the right hand mouse button over the symbols to see the passed parameters.\n \nH(z) = G1 * ( B0 + B1*z^-1 + B2*z^-2  + .... Bn*z^-n) / (1 + A1*z^^-1 + A2*z^-2 + A3*z^-3 + ... Am*z^-m)    B0 = 1\n \nOutput has wrong spikes if V(in) has a too short rise time, e.g. 10ns.
TEXT 720 560 Left 0 ;Delay with sample and hold z_1_tl.asy
TEXT 1448 104 Left 0 ;Z
TEXT 1464 88 Left 0 ;-1
TEXT 1624 104 Left 0 ;Z
TEXT 1640 88 Left 0 ;-1
TEXT 1272 104 Left 0 ;Z
TEXT 1288 88 Left 0 ;-1
TEXT 1096 104 Left 0 ;Z
TEXT 1112 88 Left 0 ;-1
TEXT 1360 224 Left 0 ;A2
TEXT 1184 224 Left 0 ;A1
TEXT 1536 224 Left 0 ;A3
TEXT 1712 224 Left 0 ;A4
TEXT 816 96 Left 0 ;G1
TEXT 920 96 Left 0 ;+
TEXT 760 80 Left 0 ;IN
TEXT 1040 288 Left 0 ;+
TEXT 1040 320 Left 0 ;+
TEXT 1040 352 Left 0 ;+
TEXT 944 112 Left 0 ;-
TEXT 1360 -64 Left 0 ;B2
TEXT 1184 -64 Left 0 ;B1
TEXT 1536 -64 Left 0 ;B3
TEXT 1712 -64 Left 0 ;B4
TEXT 1864 -240 Left 0 ;+
TEXT 1864 -208 Left 0 ;+
TEXT 1864 -176 Left 0 ;+
TEXT 1864 -144 Left 0 ;+
TEXT 1008 -64 Left 0 ;B0
TEXT 1864 -272 Left 0 ;+
TEXT 1944 -232 Left 0 ;OUT
TEXT 1000 112 Left 0 ;sum
TEXT 1264 -320 Left 0 ;Direct Form II  4th Order System
TEXT -24 -280 Left 0 ;.ac lin 1000 10 5k
TEXT 40 1048 Left 0 ;Direct Form II
TEXT 24 1824 Left 0 ;Transposed Direct Form II
TEXT 184 368 Left 0 ;Keep tr , tf  greater than  0.001*TS
TEXT -24 -632 Left 0 ;Used symbols:\n                          z_1_tl.asy\n                          z_gain.asy\n                          z_sum_2p.asy\n                          z_sum_1p1n.asy\n                          z_sum_2p1n.asy\n \nThis is a hierarchical schematic.\nEach symbol has a corresponding \nschematic xxx.asc .
TEXT 208 -152 Left 0 ;sampling period
LINE Normal 1248 96 1152 96
LINE Normal 1248 96 1248 96
LINE Normal 1424 96 1328 96
LINE Normal 1424 96 1424 96
LINE Normal 1600 96 1504 96
LINE Normal 1728 96 1680 96
LINE Normal 1200 96 1200 192
LINE Normal 1376 96 1376 192
LINE Normal 1552 96 1552 192
LINE Normal 1728 96 1728 192
LINE Normal 1200 288 1200 256
LINE Normal 1056 288 1200 288
LINE Normal 1376 320 1376 256
LINE Normal 1056 320 1376 320
LINE Normal 1552 352 1552 256
LINE Normal 1056 352 1552 352
LINE Normal 1728 384 1728 256
LINE Normal 1056 384 1728 384
LINE Normal 960 336 992 336
LINE Normal 944 336 960 336
LINE Normal 944 128 944 336
LINE Normal 1072 96 1024 96
LINE Normal 1072 96 1072 96
LINE Normal 976 96 1024 96
LINE Normal 800 96 784 96
LINE Normal 800 96 800 96
LINE Normal 912 96 864 96
LINE Normal 912 96 912 96
LINE Normal 1376 -32 1376 96
LINE Normal 1200 -32 1200 96
LINE Normal 1552 -32 1552 96
LINE Normal 1728 -32 1728 96
LINE Normal 1024 -32 1024 96
LINE Normal 1200 -192 1200 -96
LINE Normal 1200 -240 1200 -192
LINE Normal 1856 -240 1200 -240
LINE Normal 1376 -176 1376 -96
LINE Normal 1376 -208 1376 -176
LINE Normal 1552 -176 1552 -96
LINE Normal 1552 -176 1552 -176
LINE Normal 1728 -112 1728 -96
LINE Normal 1728 -144 1728 -112
LINE Normal 1024 -176 1024 -96
LINE Normal 1024 -272 1024 -176
LINE Normal 1856 -208 1376 -208
LINE Normal 1856 -176 1552 -176
LINE Normal 1856 -144 1728 -144
LINE Normal 1856 -272 1024 -272
RECTANGLE Normal 1696 864 -16 512 2
RECTANGLE Normal 640 416 -16 112 2
RECTANGLE Normal 1504 128 1424 64
RECTANGLE Normal 1680 128 1600 64
RECTANGLE Normal 1328 128 1248 64
RECTANGLE Normal 1152 128 1072 64
RECTANGLE Normal 1056 400 992 272
RECTANGLE Normal 1920 -128 1856 -288
RECTANGLE Normal 1696 1648 -16 992 2
RECTANGLE Normal 1696 2416 -16 1776 2
CIRCLE Normal 1408 256 1344 192
CIRCLE Normal 1232 256 1168 192
CIRCLE Normal 1584 256 1520 192
CIRCLE Normal 1760 256 1696 192
CIRCLE Normal 864 128 800 64
CIRCLE Normal 976 128 912 64
CIRCLE Normal 1408 -32 1344 -96
CIRCLE Normal 1232 -32 1168 -96
CIRCLE Normal 1584 -32 1520 -96
CIRCLE Normal 1760 -32 1696 -96
CIRCLE Normal 1056 -32 992 -96
