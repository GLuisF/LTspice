Version 4
SHEET 1 2632 1348
WIRE 80 160 80 128
WIRE 80 240 80 288
WIRE 80 128 416 128
WIRE 304 592 368 592
WIRE 496 592 560 592
WIRE 128 752 128 720
WIRE 128 640 128 592
WIRE 128 592 160 592
WIRE 368 592 432 592
WIRE 560 592 624 592
WIRE 992 752 992 720
WIRE 992 640 992 592
WIRE 752 592 800 592
WIRE 992 592 1072 592
WIRE 160 592 240 592
WIRE 864 592 912 592
WIRE 912 592 928 592
WIRE 1920 -208 1984 -208
WIRE 688 592 752 592
FLAG 80 288 0
FLAG 128 752 0
FLAG 368 592 z_1
FLAG 560 592 z_2
FLAG 752 592 z_3
FLAG 992 752 0
FLAG 160 592 sum
FLAG 1072 592 out
IOPIN 1072 592 Out
FLAG 416 128 in
IOPIN 416 128 Out
FLAG 912 592 z_4
SYMBOL voltage 80 144 R0
WINDOW 123 24 132 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName V1
SYMATTR Value PULSE(0 +1 0 10n 10n 5m 10m)
SYMBOL bv 128 624 R0
SYMATTR InstName SUM1
SYMATTR Value V={G1}*V(in) -(A1*V(z_1)+A2*V(z_2)+A3*V(z_3)+A4*V(z_4))
SYMBOL bv 992 624 R0
SYMATTR InstName SUM2
SYMATTR Value V=B0*V(sum) + B1*V(z_1) + B2*V(z_2) + B3*V(z_3) + B4*V(z_4)
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 272 592 R0
WINDOW 39 -40 53 Left 0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X1
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 464 592 R0
WINDOW 39 -40 53 Left 0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X2
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 656 592 R0
WINDOW 39 -40 53 Left 0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X3
SYMBOL D:\\WUTemp\\Z-transform\\z_1_tl 832 592 R0
WINDOW 39 -40 53 Left 0
SYMATTR SpiceLine TS={TS}
SYMATTR InstName X5
TEXT 0 -264 Left 0 !.PARAM FS=10k
TEXT 0 -232 Left 0 !.PARAM TS=1/FS
TEXT 8 -312 Left 0 !.tran 0 15m 0 {TS/100}
TEXT 0 -96 Left 0 !.PARAM  G1=0.00482434336   \n.PARAM   B0=1  B1=4  B2=6  B3=4  B4=1\n.PARAM   A0=1.0  A1=-2.369513   A2=2.3139884 A3=-1.0546654  A4=0.187379492
TEXT 512 -360 Left 0 !.options plotwinsize=0
TEXT 264 -360 Left 0 !.options reltol=1e-5
TEXT 48 504 Left 0 ;Direct Form II
TEXT 0 -128 Left 0 ;Example: 4th order Butterworth lowpass, fg=0.1*fs
TEXT 232 -264 Left 0 ;sampling frequency
TEXT 72 72 Left 0 ;Source for step response
TEXT 176 184 Left 0 ;The source signal has to be a sampled signal.
TEXT 0 -744 Left 0 ;Simulation Of Sampled Systems with Z-transform\n \nThe input signal has to be a sampled signal.\nIt may be replaced by your A/D converter.\n \nTwo realizations of Z-transform filters have been investigated, "Direct Form II" \nand "Direct Transposed Form II". I recommend to go with " Direct Form II",\nbecause it is less effort to use it in SPICE. The used delay elements\nconsist of delay lines. They can be used for a frequency analysis too. \n \nH(z) = G1 * ( B0 + B1*z^-1 + B2*z^-2  + .... Bn*z^-n) / (1 + A1*z^^-1 + A2*z^-2 + A3*z^-3 + ... Am*z^-m)    B0 = 1
TEXT 1224 512 Left 0 ;Delay with sample and hold z_1_sh.asy
TEXT 1448 104 Left 0 ;Z
TEXT 1464 88 Left 0 ;-1
TEXT 1624 104 Left 0 ;Z
TEXT 1640 88 Left 0 ;-1
TEXT 1272 104 Left 0 ;Z
TEXT 1288 88 Left 0 ;-1
TEXT 1096 104 Left 0 ;Z
TEXT 1112 88 Left 0 ;-1
TEXT 1360 224 Left 0 ;A2
TEXT 1184 224 Left 0 ;A1
TEXT 1536 224 Left 0 ;A3
TEXT 1712 224 Left 0 ;A4
TEXT 816 96 Left 0 ;G1
TEXT 920 96 Left 0 ;+
TEXT 760 80 Left 0 ;IN
TEXT 1040 288 Left 0 ;+
TEXT 1040 320 Left 0 ;+
TEXT 1040 352 Left 0 ;+
TEXT 944 112 Left 0 ;-
TEXT 1360 -64 Left 0 ;B2
TEXT 1184 -64 Left 0 ;B1
TEXT 1536 -64 Left 0 ;B3
TEXT 1712 -64 Left 0 ;B4
TEXT 1864 -240 Left 0 ;+
TEXT 1864 -208 Left 0 ;+
TEXT 1864 -176 Left 0 ;+
TEXT 1864 -144 Left 0 ;+
TEXT 1008 -64 Left 0 ;B0
TEXT 1864 -272 Left 0 ;+
TEXT 1944 -232 Left 0 ;OUT
TEXT 1000 112 Left 0 ;sum
TEXT 1264 -320 Left 0 ;Direct Form II  4th Order System
TEXT 8 -360 Left 0 ;.ac lin 1000 10 5k
LINE Normal 1248 96 1152 96
LINE Normal 1248 96 1248 96
LINE Normal 1424 96 1328 96
LINE Normal 1424 96 1424 96
LINE Normal 1600 96 1504 96
LINE Normal 1728 96 1680 96
LINE Normal 1200 96 1200 192
LINE Normal 1376 96 1376 192
LINE Normal 1552 96 1552 192
LINE Normal 1728 96 1728 192
LINE Normal 1200 288 1200 256
LINE Normal 1056 288 1200 288
LINE Normal 1376 320 1376 256
LINE Normal 1056 320 1376 320
LINE Normal 1552 352 1552 256
LINE Normal 1056 352 1552 352
LINE Normal 1728 384 1728 256
LINE Normal 1056 384 1728 384
LINE Normal 960 336 992 336
LINE Normal 944 336 960 336
LINE Normal 944 128 944 336
LINE Normal 1072 96 1024 96
LINE Normal 1072 96 1072 96
LINE Normal 976 96 1024 96
LINE Normal 800 96 784 96
LINE Normal 800 96 800 96
LINE Normal 912 96 864 96
LINE Normal 912 96 912 96
LINE Normal 1376 -32 1376 96
LINE Normal 1200 -32 1200 96
LINE Normal 1552 -32 1552 96
LINE Normal 1728 -32 1728 96
LINE Normal 1024 -32 1024 96
LINE Normal 1200 -192 1200 -96
LINE Normal 1200 -240 1200 -192
LINE Normal 1856 -240 1200 -240
LINE Normal 1376 -176 1376 -96
LINE Normal 1376 -208 1376 -176
LINE Normal 1552 -176 1552 -96
LINE Normal 1552 -176 1552 -176
LINE Normal 1728 -112 1728 -96
LINE Normal 1728 -144 1728 -112
LINE Normal 1024 -176 1024 -96
LINE Normal 1024 -272 1024 -176
LINE Normal 1856 -208 1376 -208
LINE Normal 1856 -176 1552 -176
LINE Normal 1856 -144 1728 -144
LINE Normal 1856 -272 1024 -272
RECTANGLE Normal 1696 816 -16 464 2
RECTANGLE Normal 672 336 16 32 2
RECTANGLE Normal 1504 128 1424 64
RECTANGLE Normal 1680 128 1600 64
RECTANGLE Normal 1328 128 1248 64
RECTANGLE Normal 1152 128 1072 64
RECTANGLE Normal 1056 400 992 272
RECTANGLE Normal 1920 -128 1856 -288
CIRCLE Normal 1408 256 1344 192
CIRCLE Normal 1232 256 1168 192
CIRCLE Normal 1584 256 1520 192
CIRCLE Normal 1760 256 1696 192
CIRCLE Normal 864 128 800 64
CIRCLE Normal 976 128 912 64
CIRCLE Normal 1408 -32 1344 -96
CIRCLE Normal 1232 -32 1168 -96
CIRCLE Normal 1584 -32 1520 -96
CIRCLE Normal 1760 -32 1696 -96
CIRCLE Normal 1056 -32 992 -96
