Version 4
SHEET 1 1476 888
WIRE -272 144 -304 144
WIRE -176 144 -272 144
WIRE 112 144 -96 144
WIRE 144 144 112 144
WIRE 256 144 224 144
WIRE 384 144 336 144
WIRE 560 144 384 144
WIRE 560 176 560 144
WIRE 112 208 112 144
WIRE 384 208 384 144
WIRE -112 224 -112 192
WIRE -304 256 -304 144
WIRE 560 320 560 256
WIRE -304 352 -304 320
WIRE -160 352 -160 192
WIRE -160 352 -304 352
WIRE -112 352 -112 304
WIRE -112 352 -160 352
WIRE 112 352 112 288
WIRE 112 352 -112 352
WIRE 384 352 384 288
WIRE 384 352 112 352
WIRE 480 352 384 352
WIRE 224 544 80 544
WIRE 400 544 304 544
WIRE 560 544 560 384
WIRE 560 544 400 544
WIRE 864 544 560 544
WIRE 80 576 80 544
WIRE 864 592 864 544
WIRE 80 704 80 656
WIRE 224 704 80 704
WIRE 400 704 304 704
WIRE 480 704 480 352
WIRE 480 704 400 704
WIRE 864 704 864 672
WIRE 864 704 480 704
WIRE 80 832 80 704
WIRE 864 832 80 832
WIRE 80 864 80 832
FLAG -272 144 charge
FLAG 80 864 0
FLAG 400 544 line
FLAG 400 704 neutral
SYMBOL res 240 128 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Rm
SYMATTR Value 1.1
SYMBOL res 96 304 M180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName Rs1
SYMATTR Value 6
SYMBOL res 400 304 R180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName Rs2
SYMATTR Value 25
SYMBOL ind 240 160 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
SYMATTR InstName Lr
SYMATTR Value 8µ
SYMBOL cap -320 256 R0
SYMATTR InstName Cc
SYMATTR Value 12µ
SYMBOL sw -192 144 R270
WINDOW 0 30 86 VRight 0
WINDOW 3 -15 88 VRight 0
SYMATTR InstName S1
SYMATTR Value MySwitch
SYMBOL bv -112 208 R0
WINDOW 0 32 75 Left 0
WINDOW 3 7 105 Left 0
SYMATTR InstName B1
SYMATTR Value V=if(time>{Tdelay},1,0)
SYMBOL res 848 576 R0
SYMATTR InstName Rload
SYMATTR Value 10k
SYMBOL res 544 160 R0
SYMATTR InstName Rcouple
SYMATTR Value 1m
SYMBOL cap 544 320 R0
WINDOW 0 38 18 Left 0
WINDOW 3 38 46 Left 0
SYMATTR InstName Ccouple
SYMATTR Value 18µ
SYMBOL voltage 80 560 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 35 51 Left 0
SYMATTR InstName Vac
SYMATTR Value SINE(0 340 50)
SYMBOL ind 208 560 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
WINDOW 39 -16 56 VBottom 0
SYMATTR InstName L1
SYMATTR Value 1.5m
SYMATTR SpiceLine Rser=10m
SYMBOL ind 208 720 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
WINDOW 39 -16 56 VBottom 0
SYMATTR InstName L2
SYMATTR Value 1.5m
SYMATTR SpiceLine Rser=10m
TEXT -248 376 Left 0 !.model MySwitch SW(Ron=10m Roff=10Meg Vt=0 Vh=-0.5)
TEXT -1008 528 Left 0 !.ic v(charge)={Vopen*1.1}
TEXT -1008 392 Left 0 !.param\n+Vopen=2000\n+Tdelay=0m
TEXT -1032 64 Left 0 ;Parameters to specify:\n- Open circuit test voltage\n  \n- Use the time delay parameter to start the surge at a \ndifferent AC line phase angle.\n \n- Coupling network (IEC61000-4-5 Figures 6 & 7)\nThe coupling network for a phase-to-phase surge is shown.\nFor a phase-to-ground surge, use values of 10 ohms & 9uF.
TEXT -1008 592 Left 0 !.tran 40m
TEXT -112 -32 Left 0 ;IEC 61000-4-5 Line Surge Generator
TEXT -80 40 Left 0 ;Basic surge generator\n(IEC61000-4-5 Figure 1 & Table 2)
TEXT 792 448 Left 0 ;Sample system\n(replace with the \nsystem to be tested)
TEXT 136 480 Left 0 ;Decoupling network
TEXT 504 96 Left 0 ;Coupling network
RECTANGLE Normal 432 400 -336 88 3
RECTANGLE Normal 528 400 688 120 3
RECTANGLE Normal 816 864 960 528 3
RECTANGLE Normal 352 768 160 496 3
