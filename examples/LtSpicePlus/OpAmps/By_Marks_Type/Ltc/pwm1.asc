Version 4
SHEET 1 1520 1732
WIRE -288 -96 -384 -96
WIRE -160 -96 -224 -96
WIRE 272 -96 -16 -96
WIRE 336 -96 272 -96
WIRE 528 -96 336 -96
WIRE -16 -64 -16 -96
WIRE -704 16 -704 -16
WIRE -736 32 -800 32
WIRE -288 32 -288 0
WIRE -16 32 -16 16
WIRE -576 48 -672 48
WIRE -496 48 -576 48
WIRE -384 48 -384 -96
WIRE -384 48 -416 48
WIRE -320 48 -384 48
WIRE 672 48 672 16
WIRE 832 48 832 16
WIRE -736 64 -752 64
WIRE -160 64 -160 -96
WIRE -160 64 -256 64
WIRE 336 64 336 -96
WIRE -320 80 -384 80
WIRE 528 80 528 -96
WIRE -704 112 -704 80
WIRE -288 128 -288 96
WIRE -16 128 -16 112
WIRE 80 128 -16 128
WIRE -16 144 -16 128
WIRE 672 160 672 128
WIRE 832 160 832 128
WIRE -752 192 -752 64
WIRE -704 192 -752 192
WIRE -576 192 -576 48
WIRE -576 192 -624 192
WIRE 336 192 336 144
WIRE -16 240 -16 224
WIRE -752 288 -752 192
WIRE -704 288 -752 288
WIRE -240 288 -624 288
WIRE -160 288 -160 64
WIRE -160 288 -240 288
WIRE 336 304 336 256
WIRE 448 304 336 304
WIRE 528 304 528 144
WIRE 528 304 448 304
WIRE -896 336 -896 240
WIRE -16 352 -16 320
WIRE 448 352 448 304
WIRE -800 368 -800 32
WIRE -608 368 -800 368
WIRE -528 368 -608 368
WIRE -384 368 -384 80
WIRE -384 368 -528 368
WIRE 672 384 672 352
WIRE 144 400 144 368
WIRE 80 416 80 128
WIRE 112 416 80 416
WIRE -688 432 -688 416
WIRE 224 432 224 352
WIRE 224 432 176 432
WIRE 272 432 224 432
WIRE 400 432 352 432
WIRE -800 448 -800 368
WIRE -720 448 -800 448
WIRE -160 448 -160 288
WIRE -64 448 -160 448
WIRE 112 448 16 448
WIRE -608 464 -608 368
WIRE -608 464 -656 464
WIRE -896 480 -896 416
WIRE -720 480 -896 480
WIRE 144 496 144 464
WIRE 448 496 448 448
WIRE -688 512 -688 496
WIRE 672 512 672 464
WIRE -896 528 -896 480
WIRE -896 656 -896 608
WIRE -288 896 -384 896
WIRE -160 896 -224 896
WIRE 272 896 16 896
WIRE 336 896 272 896
WIRE 528 896 336 896
WIRE 16 928 16 896
WIRE -704 1008 -704 976
WIRE -736 1024 -800 1024
WIRE -288 1024 -288 992
WIRE 16 1024 16 1008
WIRE -576 1040 -672 1040
WIRE -496 1040 -576 1040
WIRE -384 1040 -384 896
WIRE -384 1040 -416 1040
WIRE -320 1040 -384 1040
WIRE -736 1056 -752 1056
WIRE -160 1056 -160 896
WIRE -160 1056 -256 1056
WIRE 336 1056 336 896
WIRE 736 1056 736 1024
WIRE -320 1072 -384 1072
WIRE 528 1072 528 896
WIRE -704 1104 -704 1072
WIRE -288 1120 -288 1088
WIRE 16 1120 16 1104
WIRE 80 1120 16 1120
WIRE 16 1136 16 1120
WIRE -752 1184 -752 1056
WIRE -704 1184 -752 1184
WIRE -576 1184 -576 1040
WIRE -576 1184 -624 1184
WIRE 336 1184 336 1136
WIRE 736 1184 736 1136
WIRE 16 1232 16 1216
WIRE -752 1280 -752 1184
WIRE -704 1280 -752 1280
WIRE -256 1280 -624 1280
WIRE -160 1280 -160 1056
WIRE -160 1280 -256 1280
WIRE 336 1296 336 1248
WIRE 448 1296 336 1296
WIRE 528 1296 528 1136
WIRE 528 1296 448 1296
WIRE -896 1328 -896 1232
WIRE 16 1344 16 1312
WIRE 448 1344 448 1296
WIRE -800 1360 -800 1024
WIRE -608 1360 -800 1360
WIRE -496 1360 -608 1360
WIRE -384 1360 -384 1072
WIRE -384 1360 -496 1360
WIRE 144 1392 144 1360
WIRE 80 1408 80 1120
WIRE 112 1408 80 1408
WIRE -688 1424 -688 1408
WIRE 224 1424 224 1344
WIRE 224 1424 176 1424
WIRE 272 1424 224 1424
WIRE 400 1424 352 1424
WIRE -800 1440 -800 1360
WIRE -720 1440 -800 1440
WIRE -160 1440 -160 1280
WIRE 112 1440 -160 1440
WIRE -608 1456 -608 1360
WIRE -608 1456 -656 1456
WIRE -896 1472 -896 1408
WIRE -720 1472 -896 1472
WIRE 144 1488 144 1456
WIRE 448 1488 448 1440
WIRE -896 1520 -896 1472
WIRE -688 1520 -688 1488
WIRE -896 1648 -896 1600
FLAG 672 512 0
FLAG -896 656 0
FLAG -16 352 0
FLAG 224 352 pwm_out
FLAG -528 368 pwm_V_ref
FLAG -576 48 pwm_V_sq
FLAG -240 288 pwm_V_tri
FLAG 448 496 0
FLAG 672 160 0
FLAG 832 160 0
FLAG 672 16 V+
FLAG 832 16 V-
FLAG -688 512 V-
FLAG -688 416 V+
FLAG -896 240 V+
FLAG -704 112 V-
FLAG -704 -16 V+
FLAG -288 128 V-
FLAG -288 0 V+
FLAG 144 496 V-
FLAG 144 368 V+
FLAG 672 352 +5V
FLAG 272 -96 +5V
FLAG -896 1648 0
FLAG 16 1344 0
FLAG 224 1344 pwm_out1
FLAG -496 1360 pwm_V_ref1
FLAG -576 1040 pwm_V_sq1
FLAG -256 1280 pwm_V_tri1
FLAG 448 1488 0
FLAG -688 1408 5V
FLAG -896 1232 5V
FLAG -704 976 5V
FLAG -288 992 5V
FLAG 144 1360 5V
FLAG 272 896 5V
FLAG -288 1120 0
FLAG -704 1104 0
FLAG 144 1488 0
FLAG -688 1520 0
FLAG 736 1184 0
FLAG 736 1024 5V
SYMBOL Misc\\battery 672 368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5V
SYMBOL res -912 320 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res -912 512 R0
SYMATTR InstName R5
SYMATTR Value 1
SYMBOL res -608 176 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res -608 272 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R2
SYMATTR Value 47k
SYMBOL res -400 32 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL res -32 32 M180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R7
SYMATTR Value 3.3k
SYMBOL res -32 128 M180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R8
SYMATTR Value 3k
SYMBOL res -32 240 M180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R9
SYMATTR Value 6
SYMBOL res -32 336 M180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R10
SYMATTR Value 3.3k
SYMBOL cap -224 -112 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C1
SYMATTR Value 0.01µF
SYMBOL nmos 400 352 R0
SYMATTR InstName M1
SYMATTR Value BSS123
SYMBOL res 368 416 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R11
SYMATTR Value 1K
SYMBOL res 320 48 R0
SYMATTR InstName R12
SYMATTR Value 2.7k
SYMBOL LED 320 192 R0
SYMATTR InstName D1
SYMBOL diode 544 144 R180
WINDOW 0 24 72 Left 0
WINDOW 3 24 0 Left 0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL voltage 672 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 15V
SYMBOL voltage 832 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value -15v
SYMBOL Opamps\\LT1012S8 -688 400 R0
SYMATTR InstName U3
SYMBOL Opamps\\LT1012S8 144 368 R0
SYMATTR InstName U4
SYMBOL Opamps\\LT1012S8 -704 -16 R0
SYMATTR InstName U1
SYMBOL Opamps\\LT1012S8 -288 0 R0
SYMATTR InstName U2
SYMBOL res -80 464 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res -912 1312 R0
SYMATTR InstName R24
SYMATTR Value 100k
SYMBOL res -912 1504 R0
SYMATTR InstName R25
SYMATTR Value 100k
SYMBOL res -608 1168 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R23
SYMATTR Value 100k
SYMBOL res -608 1264 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R22
SYMATTR Value 47k
SYMBOL res -400 1024 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R21
SYMATTR Value 100k
SYMBOL res 32 1024 R180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R27
SYMATTR Value 3.3k
SYMBOL res 32 1120 R180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R28
SYMATTR Value 3k
SYMBOL res 32 1232 R180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R29
SYMATTR Value 6
SYMBOL res 32 1328 R180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R30
SYMATTR Value 3.3k
SYMBOL cap -224 880 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C21
SYMATTR Value 0.01µF
SYMBOL nmos 400 1344 R0
SYMATTR InstName M21
SYMATTR Value BSS123
SYMBOL res 368 1408 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R31
SYMATTR Value 1K
SYMBOL res 320 1040 R0
SYMATTR InstName R32
SYMATTR Value 2.7k
SYMBOL LED 320 1184 R0
SYMATTR InstName D21
SYMBOL diode 544 1136 R180
WINDOW 0 24 72 Left 0
WINDOW 3 24 0 Left 0
SYMATTR InstName D22
SYMATTR Value 1N4148
SYMBOL Opamps\\LT1366 -688 1392 R0
SYMATTR InstName U23
SYMBOL Opamps\\LT1366 -288 992 R0
SYMATTR InstName U22
SYMBOL Opamps\\LT1366 -704 976 R0
SYMATTR InstName U21
SYMBOL Opamps\\LT1366 144 1360 R0
SYMATTR InstName U24
SYMBOL Misc\\battery 736 1040 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5V
TEXT -728 -264 Left 0 !.tran 0 10m 0 10u  ; minimum time step for a faster startup of oscillation
TEXT 0 -216 Left 0 ;The left circuit is the one used in the application. The right circuit tries to use the \nresistor divider for transistor biasing.
TEXT -888 824 Left 0 ;Single Supply Solution\n \nAny rail to rail IN/OUT Amplifier will work.
TEXT -728 -224 Left 0 !.options gminsteps=0   ; help for convergence
TEXT -808 512 Left 0 ;0V
TEXT -104 520 Left 0 ;limit current
TEXT -728 -184 Left 0 !.options plotwinsize=0  ; is optional for saving all data
RECTANGLE Normal 896 1728 -1040 768
