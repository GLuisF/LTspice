Version 4
SHEET 1 2168 1300
WIRE 416 64 416 80
WIRE 320 192 416 192
WIRE 416 160 416 192
WIRE 416 192 512 192
WIRE 96 160 96 144
WIRE 96 240 96 224
WIRE 96 320 96 336
WIRE 96 64 96 48
WIRE 128 192 240 192
WIRE 32 208 64 208
WIRE -80 320 -80 288
WIRE -80 208 -80 176
WIRE -80 176 64 176
WIRE 304 384 272 384
WIRE 272 384 272 288
WIRE 272 288 320 288
WIRE 384 384 464 384
WIRE 464 384 464 288
WIRE 464 288 384 288
WIRE 704 416 704 448
WIRE 592 192 656 192
WIRE 656 192 656 336
WIRE 656 384 464 384
WIRE 704 336 656 336
WIRE 656 336 656 384
WIRE 272 384 -128 384
WIRE -128 384 -128 176
WIRE 112 608 112 560
WIRE 112 688 112 672
WIRE 112 768 112 784
WIRE 112 480 112 464
WIRE 144 640 448 640
WIRE 48 656 80 656
WIRE -64 736 -64 720
WIRE -64 640 -64 624
WIRE -64 624 80 624
WIRE 288 832 256 832
WIRE 256 832 256 736
WIRE 256 736 304 736
WIRE 368 832 448 832
WIRE 448 832 448 736
WIRE 448 736 368 736
WIRE 672 800 672 832
WIRE 624 640 624 720
WIRE 624 832 448 832
WIRE 672 720 624 720
WIRE 624 720 624 832
WIRE 256 832 -112 832
WIRE -112 832 -112 624
WIRE -112 624 -64 624
WIRE 544 640 576 640
WIRE 448 640 464 640
WIRE 576 640 624 640
WIRE 1088 384 1088 352
WIRE 1088 464 1088 448
WIRE 1088 544 1088 560
WIRE 1088 272 1088 256
WIRE 1120 416 1408 416
WIRE 1024 432 1056 432
WIRE 848 512 848 496
WIRE 848 416 848 400
WIRE 848 400 896 400
WIRE 1264 608 1232 608
WIRE 1232 608 1232 512
WIRE 1232 512 1280 512
WIRE 1344 608 1376 608
WIRE 1376 608 1376 512
WIRE 1376 512 1344 512
WIRE 1456 592 1456 608
WIRE 1408 416 1408 496
WIRE 1408 608 1376 608
WIRE 1408 496 1408 608
WIRE 1232 608 800 608
WIRE 800 608 800 400
WIRE 800 400 848 400
WIRE 992 400 1024 400
WIRE 896 400 912 400
WIRE 1024 400 1056 400
WIRE -128 176 -80 176
WIRE 1456 512 1456 496
WIRE 1456 496 1408 496
FLAG 416 64 0
FLAG 96 48 0
FLAG 96 336 0
FLAG 32 208 0
FLAG -80 320 0
FLAG 704 448 0
FLAG 112 464 0
FLAG 112 784 0
FLAG 48 656 0
FLAG -64 736 0
FLAG 672 832 0
FLAG 448 640 X
FLAG 576 640 Y
FLAG 1088 256 0
FLAG 1088 560 0
FLAG 1024 432 0
FLAG 848 512 0
FLAG 1456 608 0
FLAG 896 400 X2
FLAG 1024 400 Y2
SYMBOL voltage 96 160 M180
WINDOW 0 24 104 Left 0
WINDOW 3 24 16 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 25
SYMBOL voltage 96 336 M180
WINDOW 0 24 89 Left 0
WINDOW 3 24 16 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 25
SYMBOL current 416 80 R0
WINDOW 38 39 48 Left 0
SYMATTR SpiceModel AC
SYMATTR InstName I1
SYMATTR Value 1
SYMBOL voltage 336 192 R90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName V3
SYMATTR Value 0
SYMBOL voltage 496 192 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 -32 56 VBottom 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 0
SYMBOL res 688 320 R0
SYMATTR InstName R1
SYMATTR Value 100
SYMBOL res -96 192 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL res 400 368 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL cap 384 272 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C1
SYMATTR Value 3p
SYMBOL Opamps\\LT1001 96 128 R0
WINDOW 0 27 42 Left 0
WINDOW 3 25 87 Left 0
SYMATTR InstName U1
SYMBOL voltage 112 576 R180
WINDOW 0 24 104 Left 0
WINDOW 3 24 16 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 25
SYMBOL voltage 112 784 M180
WINDOW 0 31 91 Left 0
WINDOW 3 24 16 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 25
SYMBOL res 656 704 R0
SYMATTR InstName R4
SYMATTR Value 100
SYMBOL res -80 624 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 384 848 M270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL cap 368 752 M270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName C2
SYMATTR Value 3p
SYMBOL Opamps\\LT1001 112 576 R0
WINDOW 3 19 86 Left 0
SYMATTR InstName U2
SYMBOL voltage 560 640 R90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 38 60 56 VTop 0
SYMATTR InstName V9
SYMATTR Value 1
SYMATTR SpiceModel AC
SYMBOL voltage 1088 368 M180
WINDOW 0 36 65 Left 0
WINDOW 3 31 25 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value 25
SYMBOL voltage 1088 560 M180
WINDOW 0 27 85 Left 0
WINDOW 3 26 20 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V11
SYMATTR Value 25
SYMBOL res 1440 496 R0
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL res 832 400 R0
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL res 1360 624 M270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL cap 1344 528 M270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName C3
SYMATTR Value 3p
SYMBOL Opamps\\LT1001 1088 352 R0
WINDOW 0 19 37 Left 0
WINDOW 3 27 81 Left 0
SYMATTR InstName U3
SYMBOL voltage 1008 400 R90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 38 60 56 VTop 0
SYMATTR InstName V14
SYMATTR Value 1
SYMATTR SpiceModel AC
TEXT -90 902 Left 0 !.ac dec 30 1 1G
TEXT 224 600 Left 0 ;Gv=-V(x)/V(y)
TEXT 200 72 Left 0 ;Gi=I(V3)/I(V4)
TEXT -128 -184 Left 0 ;True loop:((I(V3)/I(V4))*(-V(x)/V(y))-1)/((I(V3)/I(V4))+(-V(x)/V(y))+2)
TEXT 848 208 Left 0 ;Approximated by Voltage Gain: -V(x2)/V(y2)
TEXT 0 -128 Left 0 ;Or plot middlebrook(-V(x)/V(y),I(V3)/I(V4))
TEXT 0 -104 Left 0 ;After you add the line
TEXT 0 -80 Left 0 ;.func middlebrook(x,y) = (x*y-1)/(x+y+2)
TEXT 0 -56 Left 0 ;to your plot.defs file