Version 4
SHEET 1 1564 680
WIRE 32 -240 -240 -240
WIRE 240 -240 32 -240
WIRE 592 -240 240 -240
WIRE 240 -224 240 -240
WIRE 592 -176 592 -240
WIRE 240 -128 240 -144
WIRE 528 -128 240 -128
WIRE 32 -32 32 -240
WIRE 592 16 592 -80
WIRE 720 16 592 16
WIRE 864 16 720 16
WIRE 1008 16 864 16
WIRE 1056 16 1008 16
WIRE 592 48 592 16
WIRE 176 64 144 64
WIRE 240 64 240 -128
WIRE 240 64 176 64
WIRE 304 64 240 64
WIRE 368 64 304 64
WIRE 480 64 448 64
WIRE 304 80 304 64
WIRE 480 80 480 64
WIRE -240 128 -240 -240
WIRE 176 160 144 160
WIRE 304 160 304 144
WIRE 304 160 176 160
WIRE 480 160 480 144
WIRE 480 160 304 160
WIRE 592 160 592 128
WIRE 592 160 480 160
WIRE 1008 160 1008 16
WIRE 1136 160 1008 160
WIRE 240 192 240 64
WIRE 592 192 592 160
WIRE 720 208 720 16
WIRE 864 208 864 16
WIRE 1008 208 1008 160
WIRE 1136 208 1136 160
WIRE 176 272 144 272
WIRE 240 288 240 256
WIRE 1008 336 1008 288
WIRE 1136 336 1136 288
WIRE 1136 336 1008 336
WIRE -64 368 -64 336
WIRE -32 368 -64 368
WIRE 48 384 48 336
WIRE 112 384 48 384
WIRE 240 384 240 368
WIRE 240 384 112 384
WIRE 48 416 48 384
WIRE -240 528 -240 208
WIRE -64 528 -64 368
WIRE -64 528 -240 528
WIRE -48 528 -64 528
WIRE 48 528 48 496
WIRE 48 528 32 528
WIRE 176 528 176 272
WIRE 176 528 48 528
WIRE 592 528 592 272
WIRE 592 528 176 528
WIRE 720 528 720 272
WIRE 720 528 592 528
WIRE 864 528 864 288
WIRE 864 528 720 528
WIRE 1008 528 1008 336
WIRE 1008 528 864 528
WIRE 1056 528 1008 528
WIRE 176 560 176 528
FLAG 176 560 0
FLAG 1056 16 OUT+
IOPIN 1056 16 Out
FLAG 1056 528 OUT-
IOPIN 1056 528 Out
FLAG 32 -240 Vsupply
FLAG 176 64 out
FLAG 176 160 fb
FLAG 112 384 vsense
FLAG -32 368 ictrl
SYMBOL res -64 544 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName Rsense
SYMATTR Value 1
SYMBOL npn 528 -176 R0
SYMATTR InstName Q1
SYMBOL res 224 -240 R0
SYMATTR InstName Rled
SYMATTR Value 1.k
SYMBOL res 576 176 R0
SYMATTR InstName R1
SYMATTR Value 41.9k
SYMBOL res 576 32 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res 992 192 R0
SYMATTR InstName Rload
SYMATTR Value 100
SYMBOL voltage -240 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VG
SYMATTR Value 10
SYMBOL res 32 400 R0
SYMATTR InstName Ric2
SYMATTR Value 470
SYMBOL Misc\\battery 864 192 R0
WINDOW 3 24 102 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 24 132 Left 0
SYMATTR Value 4.1
SYMATTR SpiceLine Rser=1
SYMATTR InstName V1
SYMBOL cap 288 80 R0
SYMATTR InstName Cvc2
SYMATTR Value 22p
SYMBOL res 352 80 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName Rvc1
SYMATTR Value 470k
SYMBOL cap 464 80 R0
SYMATTR InstName Cvc1
SYMATTR Value 2.2n
SYMBOL cap 224 192 R0
SYMATTR InstName Cic1
SYMATTR Value 2.2n
SYMBOL res 224 272 R0
SYMATTR InstName Ric1
SYMATTR Value 22k
SYMBOL polcap 704 208 R0
SYMATTR InstName C1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=1
SYMBOL load2 1136 208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 25 112 Left 0
SYMATTR SpiceLine load
SYMATTR InstName Iload
SYMATTR Value PULSE(0 20m 0 1u 1u 10m 20m)
SYMBOL tsm1051 32 176 R0
SYMATTR InstName X1
TEXT -200 -376 Left 0 !.op
TEXT -200 -344 Left 0 ;.tran 100m
TEXT -200 -312 Left 0 !.options plotwinsize=0
TEXT 880 168 Left 0 ;Li-Bat
TEXT 200 -424 Left 0 ;Battery Voltage And Current Controller\n \nTSM1051\nDatasheet: http://www.st.com/stonline/products/literature/ds/8484.pdf\nAppnote: http://www.st.com/stonline/products/literature/an/9326.pdf
TEXT -64 592 Left 0 ;Imax=0.2V/R1
TEXT 728 -32 Left 0 ;Vout = 1.21V*(R2/R1+1)
TEXT 608 -8 Left 0 ;4.1V
