Version 4
SHEET 1 2536 1752
WIRE 1264 1136 1152 1136
WIRE 1632 1136 1264 1136
WIRE 1824 1136 1632 1136
WIRE 1888 1136 1824 1136
WIRE 2160 1136 2080 1136
WIRE 2208 1136 2160 1136
WIRE 2080 1152 2080 1136
WIRE 2208 1152 2208 1136
WIRE 1152 1168 1152 1136
WIRE 1264 1168 1264 1136
WIRE 1632 1184 1632 1136
WIRE 1888 1184 1888 1136
WIRE 1392 1232 1376 1232
WIRE 1472 1232 1456 1232
WIRE 1824 1232 1824 1136
WIRE 1824 1232 1792 1232
WIRE 2208 1248 2208 1216
WIRE 1152 1280 1152 1248
WIRE 1264 1280 1264 1232
WIRE 1472 1328 1456 1328
WIRE 1888 1328 1888 1264
WIRE 1888 1328 1792 1328
WIRE 1968 1328 1888 1328
WIRE 2080 1328 2080 1232
WIRE 2080 1328 2032 1328
WIRE 2208 1328 2080 1328
WIRE 2336 1328 2208 1328
WIRE 1888 1344 1888 1328
WIRE 2336 1344 2336 1328
WIRE 2208 1360 2208 1328
WIRE 2080 1376 2080 1328
WIRE 1168 1424 1120 1424
WIRE 1280 1424 1248 1424
WIRE 1472 1424 1280 1424
WIRE 1840 1424 1792 1424
WIRE 1120 1440 1120 1424
WIRE 1280 1440 1280 1424
WIRE 2208 1440 2208 1424
WIRE 2336 1440 2336 1424
WIRE 1888 1456 1888 1440
WIRE 1120 1520 1120 1504
WIRE 1280 1520 1280 1504
WIRE 1376 1520 1360 1520
WIRE 1472 1520 1456 1520
WIRE 1904 1520 1792 1520
WIRE 1936 1520 1904 1520
WIRE 2048 1520 2016 1520
WIRE 2080 1520 2080 1456
WIRE 2080 1520 2048 1520
WIRE 2080 1536 2080 1520
WIRE 1632 1584 1632 1568
WIRE 2080 1632 2080 1616
FLAG 1888 1456 0
FLAG 1360 1520 0
FLAG 2080 1632 0
FLAG 1632 1584 0
FLAG 2208 1440 0
FLAG 1280 1520 0
FLAG 1120 1520 0
FLAG 2336 1440 0
FLAG 1152 1280 0
FLAG 1456 1328 0
FLAG 1376 1232 0
FLAG 2336 1328 OUT
FLAG 1264 1280 0
FLAG 1152 1136 IN
FLAG 2208 1248 0
FLAG 2160 1136 test
FLAG 1904 1520 fb1
FLAG 2048 1520 fb2
SYMBOL NMOS 1840 1344 R0
SYMATTR InstName Q1
SYMATTR Value IRF7811
SYMBOL RES 1472 1504 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R1
SYMATTR Value 80.6K
SYMBOL res 2064 1520 R0
SYMATTR InstName R2
SYMATTR Value 4K
SYMBOL res 2064 1360 R0
SYMATTR InstName R3
SYMATTR Value 36.8K
SYMBOL ind 1872 1168 R0
SYMATTR InstName L1
SYMATTR Value 1µ
SYMBOL schottky 1968 1344 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D1
SYMATTR Value MBR735
SYMBOL polcap 2192 1360 R0
WINDOW 40 28 62 Left 0
WINDOW 3 40 38 Left 0
SYMATTR SpiceLine2 x2
SYMATTR Value 150µ
SYMATTR InstName C1
SYMATTR SpiceLine Rser=.05
SYMBOL res 1264 1408 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R4
SYMATTR Value 22K
SYMBOL cap 1104 1440 R0
SYMATTR InstName C2
SYMATTR Value 6800p
SYMBOL cap 1264 1440 R0
SYMATTR InstName C3
SYMATTR Value 50p
SYMBOL VOLTAGE 1152 1152 R0
SYMATTR InstName V1
SYMATTR Value 8
SYMBOL polcap 1456 1216 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C4
SYMATTR Value 4.7µ
SYMBOL polcap 1248 1168 R0
SYMATTR InstName C5
SYMATTR Value 100µ
SYMBOL PowerProducts\\LTC1871-7 1632 1376 R0
SYMATTR InstName U1
SYMBOL res 2320 1328 R0
SYMATTR InstName Rload
SYMATTR Value 10
SYMBOL voltage 2032 1520 R90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 49 80 VTop 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VBode
SYMATTR Value SINE(0 5m {Fmeas})
SYMBOL cap 2192 1152 R0
SYMATTR InstName C6
SYMATTR Value 20p
SYMBOL res 2064 1136 R0
SYMATTR InstName R5
SYMATTR Value 100k
TEXT 1624 1008 Left 0 !.tran 0 {Ttot} {Tset}
TEXT 1528 1632 Left 0 ;PWL(0 0 1m 0 1.001m 0.01 1.5m 0.01 1.501m 0)
TEXT 1624 760 Left 0 !.param  Fmeas=5k ; actual frequency\n*\n.param N=10 ; 10 periods for FFT\n.param Tmeas=N*1/Fmeas ; simulation time for FFT\n.param Tset=1m ; setling time\n.param Ttot=Tset+Tmeas
TEXT 1624 952 Left 0 !.FOUR {Fmeas} 5 -1 V(fb1) V(fb2) ; used for loop gain calculation
TEXT 1144 560 Left 0 ;How BODEPLOT works\n \nRepeat the following two steps for \nevery frequency value of interest.\n \n1. Setup and run simulation\nApply a small sine voltage with \nthe frequency of interest to \nthe voltage source "Vbode".\nRun a transient simulation.\n \n2. Calculate Loop Gain (LG)\nOpen the Error-Log-file\nLook in the row harmonic number 1\nfor "Fourier component" and "Phase"\nLG-Magnitude=mag(V(fb2)/mag(V(fb1)\nLG Phase= phase(V(fb2))-phase(V(fb1))
