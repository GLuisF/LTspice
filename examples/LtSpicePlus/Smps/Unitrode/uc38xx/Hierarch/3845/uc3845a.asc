Version 4
SHEET 1 1792 932
WIRE 496 96 576 96
WIRE -144 400 -144 352
WIRE -144 352 -192 352
WIRE -144 512 -144 464
WIRE 496 128 496 96
WIRE 496 208 496 240
WIRE 656 144 656 96
WIRE 656 240 656 208
WIRE 576 96 656 96
WIRE 240 -544 192 -544
WIRE 240 -512 240 -544
WIRE 240 -432 240 -400
WIRE 144 -496 144 -544
WIRE 144 -400 144 -432
WIRE 496 -96 496 -64
WIRE 656 -160 656 -208
WIRE 656 -64 656 -96
WIRE 496 -208 576 -208
WIRE 496 -208 496 -176
WIRE 496 352 576 352
WIRE 496 384 496 352
WIRE 496 464 496 496
WIRE 656 400 656 352
WIRE 656 496 656 464
WIRE 576 352 656 352
WIRE 48 -544 48 -512
WIRE 48 -432 48 -384
WIRE -240 -512 -240 -544
WIRE -240 -544 -144 -544
WIRE -240 -448 -240 -416
WIRE -240 -544 -288 -544
WIRE -272 352 -288 352
WIRE -272 -416 -240 -416
WIRE 752 352 736 352
WIRE -272 96 -304 96
WIRE -144 96 -192 96
WIRE -144 160 -144 96
WIRE -144 256 -144 224
WIRE -288 -64 -272 -64
WIRE 752 -544 720 -544
WIRE 496 -512 496 -544
WIRE 496 -432 496 -384
WIRE 576 -208 656 -208
WIRE 48 -176 48 -208
WIRE 48 -208 -32 -208
WIRE 48 -96 48 -48
WIRE -400 -640 -400 -672
WIRE -400 -672 -368 -672
WIRE -400 576 -400 608
WIRE -400 608 -368 608
WIRE 816 608 848 608
WIRE 848 608 848 576
WIRE 816 -672 848 -672
WIRE 848 -672 848 -640
WIRE 400 -496 400 -544
WIRE 400 -432 400 -384
WIRE -32 -96 -32 -48
WIRE 448 -544 496 -544
WIRE -240 -416 -240 -384
WIRE -112 96 -128 96
WIRE -32 96 -16 96
WIRE -144 352 -112 352
WIRE -128 96 -144 96
WIRE -112 352 -80 352
WIRE -144 -208 -144 -160
WIRE -144 -64 -192 -64
WIRE -144 -96 -144 -64
WIRE -144 -208 -304 -208
WIRE -144 -64 -112 -64
WIRE -112 -64 -80 -64
WIRE 192 -544 144 -544
WIRE 640 -544 624 -544
WIRE 400 -544 448 -544
WIRE 496 -544 544 -544
WIRE -96 160 -144 160
WIRE -32 160 -16 160
WIRE -16 160 -16 96
WIRE -16 96 0 96
WIRE 336 -208 288 -208
WIRE 336 -176 336 -208
WIRE 336 -96 336 -64
WIRE 240 -160 240 -208
WIRE 240 -64 240 -96
WIRE 288 -208 240 -208
WIRE -48 -544 -48 -496
WIRE -48 -432 -48 -384
WIRE -48 -544 48 -544
WIRE -144 -448 -144 -384
WIRE -144 -512 -144 -544
WIRE -144 -544 -48 -544
WIRE 80 384 80 352
WIRE 80 352 128 352
WIRE 176 352 176 400
WIRE 176 464 176 496
WIRE 80 496 80 464
WIRE 224 400 224 352
WIRE 224 352 272 352
WIRE 320 352 320 384
WIRE 272 352 320 352
WIRE 224 496 224 464
WIRE 320 496 320 464
WIRE 128 352 176 352
WIRE -128 -208 -144 -208
WIRE -32 -160 -32 -208
WIRE -32 -208 -48 -208
FLAG -112 -64 fb
FLAG 576 96 latch
FLAG -112 352 hys
FLAG 496 240 0
FLAG 656 240 0
FLAG 192 -544 ok
FLAG 240 -400 0
FLAG 144 -400 0
FLAG 496 -64 0
FLAG 752 -544 Out
IOPIN 752 -544 Out
FLAG 656 -64 0
FLAG -288 -544 Vcc
IOPIN -288 -544 In
FLAG 576 352 Ierr
FLAG 496 496 0
FLAG 656 496 0
FLAG -304 96 Ref
IOPIN -304 96 Out
FLAG -288 352 Osc
IOPIN -288 352 In
FLAG -272 -416 Com
IOPIN -272 -416 In
FLAG 752 352 Ifb
IOPIN 752 352 In
FLAG -128 96 5
FLAG -304 -208 Err
IOPIN -304 -208 Out
FLAG -288 -64 Vfb
IOPIN -288 -64 In
FLAG 576 -208 drv
FLAG -144 512 COM
FLAG 448 -544 o
FLAG -240 -384 COM
FLAG 400 -384 COM
FLAG -32 -48 COM
FLAG -144 256 COM
FLAG 48 -48 COM
FLAG 496 -384 COM
FLAG 0 96 Vcc
FLAG 48 -384 COM
FLAG 80 496 0
FLAG 320 496 0
FLAG 224 496 0
FLAG 176 496 0
FLAG 288 -208 good
FLAG 336 -64 0
FLAG 240 -64 0
FLAG -48 -384 COM
FLAG -144 -384 5
FLAG 128 352 ff1
FLAG 272 352 ff2
SYMBOL bi 48 -176 R0
WINDOW 0 40 16 Left 0
WINDOW 3 -400 -136 Left 0
WINDOW 123 -400 -104 Left 0
WINDOW 39 40 48 Left 0
WINDOW 40 32 80 Left 0
SYMATTR InstName Be1
SYMATTR Value I = V(good)*(limit(5*(V(fb,Com)-V(5,Com)/2),-1m,6m)
SYMATTR Value2 +limit(V(Err,Com)-6,0,1m)-limit(0.7-V(Err,Com),0,6m)-0.1m)
SYMATTR SpiceLine Rpar=25k
SYMATTR SpiceLine2 tripdt=30n
SYMBOL bi -272 352 R270
WINDOW 0 -34 40 VBottom 0
WINDOW 3 -192 -80 VRight 0
WINDOW 123 48 -80 VRight 0
SYMATTR InstName Bosc
SYMATTR Value I = 8.3m*u(V(hys)+V(Osc,Com)-2.6)
SYMATTR Value2 tripdv=1m tripdt=.2n
SYMBOL cap -160 400 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
WINDOW 39 0 64 Right 0
SYMATTR InstName Cosc
SYMATTR Value 50p
SYMATTR SpiceLine Rpar={1.7/8.3m}
SYMBOL bi 496 -96 M180
WINDOW 0 41 64 Left 0
WINDOW 3 304 -96 Right 0
WINDOW 123 40 32 Left 0
WINDOW 39 32 0 Left 0
SYMATTR InstName Bdrv
SYMATTR Value I = !V(ff1) & V(good) & V(latch) & !V(hys)
SYMATTR Value2 Rpar=1
SYMATTR SpiceLine tripdt=30n
SYMBOL bi 496 208 M180
WINDOW 0 40 64 Left 0
WINDOW 3 304 160 Right 0
WINDOW 123 40 32 Left 0
WINDOW 39 32 0 Left 0
SYMATTR InstName Blch
SYMATTR Value I = (u(V(Ierr)) & V(latch)) | V(hys)
SYMATTR Value2 Rpar=1
SYMATTR SpiceLine tripdt=30n
SYMBOL cap 640 144 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
SYMATTR InstName Clch
SYMATTR Value 10n
SYMBOL bi 240 -432 R180
WINDOW 0 -40 64 Right 0
WINDOW 3 48 152 Right 0
WINDOW 123 -40 32 Right 0
SYMATTR InstName Bok
SYMATTR Value I = u(V(Vcc,Com)-8.5+.6*V(ok))
SYMATTR Value2 Rpar=1
SYMBOL cap 128 -496 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
SYMATTR InstName Cok
SYMATTR Value 100n
SYMBOL cap 640 -160 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
SYMATTR InstName Cdrv
SYMATTR Value 10n
SYMBOL bi 496 464 M180
WINDOW 0 40 64 Left 0
WINDOW 3 304 -80 Right 0
WINDOW 123 40 32 Left 0
SYMATTR InstName BIer
SYMATTR Value I = limit(V(Err,Com)-1.3,3,0)-3*V(Ifb,Com)
SYMATTR Value2 Rpar=1
SYMBOL cap 640 400 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
SYMATTR InstName CIer
SYMATTR Value 300n
SYMBOL bi 48 -512 R0
WINDOW 0 40 16 Left 0
WINDOW 3 -402 -73 Left 0
WINDOW 123 -40 48 Right 0
SYMATTR InstName Bi
SYMATTR Value I = V(drv)*I(Vo)+tbl(V(Vcc,Com),0,0,1,.2m)
SYMBOL bi -32 96 R90
WINDOW 0 -32 40 VBottom 0
WINDOW 3 -80 320 VLeft 0
SYMATTR InstName Bref
SYMATTR Value I = limit(50*(5*V(ok)-V(5,Com)),100m,0)
SYMBOL res -176 80 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Rref
SYMATTR Value 280m
SYMBOL cap -128 160 M0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
WINDOW 39 48 32 Left 0
SYMATTR InstName Cref
SYMATTR Value 3n
SYMATTR SpiceLine Rpar=480
SYMBOL res -176 -80 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Re1
SYMATTR Value 165k
SYMBOL zener -256 -448 M180
WINDOW 0 40 48 Left 0
WINDOW 3 40 -16 Left 0
SYMATTR InstName Di
SYMATTR Value 34V
SYMBOL cap 384 -496 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
SYMATTR InstName Co
SYMATTR Value 30n
SYMBOL cap -16 -160 M0
WINDOW 0 32 8 Left 0
WINDOW 3 32 56 Left 0
SYMATTR InstName Ce2
SYMATTR Value 5p
SYMBOL bi 496 -432 M180
WINDOW 0 40 64 Left 0
WINDOW 3 304 -80 Right 0
WINDOW 39 32 0 Left 0
WINDOW 123 40 32 Left 0
SYMATTR InstName Bo
SYMATTR Value I = V(drv)*V(Vcc,Com)+table(-I(Vo),-1m,-1.3,0,0,.09,.5,.11,1.3,.3,1.4,1,5)
SYMATTR SpiceLine tripdt=30n
SYMATTR Value2 Rpar=1
SYMBOL voltage 528 -544 M90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 Invisible 0
WINDOW 123 32 56 VTop 0
WINDOW 39 32 56 VTop 0
SYMATTR InstName Vo
SYMATTR Value 0
SYMBOL cap -128 -160 M0
WINDOW 0 32 8 Left 0
WINDOW 3 32 56 Left 0
WINDOW 39 32 -24 Left 0
SYMATTR InstName Ce1
SYMATTR Value 1p
SYMATTR SpiceLine Rpar=10G
SYMBOL res 624 -528 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName Ro
SYMATTR Value 0.1
SYMBOL cap -32 144 R90
WINDOW 0 32 48 VRight 0
WINDOW 3 32 16 VLeft 0
WINDOW 39 64 80 VLeft 0
SYMATTR InstName Cp
SYMATTR Value 1p
SYMATTR SpiceLine Rser=10k Rpar=1e7
SYMBOL bi 336 -96 R180
WINDOW 0 -40 64 Right 0
WINDOW 3 1 152 Right 0
WINDOW 123 -40 32 Right 0
SYMATTR InstName Bb
SYMATTR Value I = u(V(Ref,Com)-4.9+.2*V(good))
SYMATTR Value2 Rpar=1
SYMBOL cap 224 -160 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
SYMATTR InstName Cb
SYMATTR Value 100n
SYMBOL cap -64 -496 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 64 Left 0
SYMATTR InstName Ci
SYMATTR Value 50p
SYMBOL diode -160 -448 M180
WINDOW 0 40 48 Left 0
WINDOW 3 40 -16 Left 0
SYMATTR InstName Dr
SYMATTR Value V65
SYMBOL bi2 80 384 M0
WINDOW 123 32 72 Left 0
WINDOW 39 32 96 Left 0
WINDOW 0 40 16 Left 0
WINDOW 3 72 -112 Right 0
SYMATTR Value2 tripdv=.1
SYMATTR SpiceLine tripdt=5n
SYMATTR InstName Bff3
SYMATTR Value I = (!V(hys)& V(ff1)) | (buf(V(hys))&V(ff2))
SYMBOL bi2 320 384 R0
WINDOW 123 32 72 Left 0
WINDOW 0 40 16 Left 0
WINDOW 3 -312 -80 Left 0
WINDOW 39 32 96 Left 0
SYMATTR Value2 tripdv=.1
SYMATTR InstName Bff4
SYMATTR Value I = (!V(hys)&!V(ff1)) | (buf(V(hys))&V(ff2))
SYMATTR SpiceLine tripdt=5n
SYMBOL cap 192 400 M0
WINDOW 0 32 0 Left 0
WINDOW 3 32 56 Left 0
WINDOW 123 32 112 Left 0
WINDOW 39 24 80 Left 0
SYMATTR InstName Cff3
SYMATTR Value 10n
SYMATTR Value2 IC=1
SYMATTR SpiceLine Rpar=1
SYMBOL cap 208 400 R0
WINDOW 0 32 0 Left 0
WINDOW 3 32 56 Left 0
WINDOW 39 25 80 Left 0
SYMATTR InstName Cff4
SYMATTR Value 10n
SYMATTR SpiceLine Rpar=1
SYMBOL res -32 -224 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Re2
SYMATTR Value 10k
TEXT -352 -624 Left 0 !.model 34V d(Ron=.5 Vfwd=.5 Vrev=34 Rrev=22)
TEXT 232 80 Center 0 ;>> UC3845A <<\nB-Source Behavioral Model\nCopyright 2004 by analog@ieee.org
TEXT 0 272 Right 0 ;ff1:
TEXT 0 304 Right 0 ;ff2:
TEXT 192 -624 Left 0 !.model V65 d(vfwd=0.65)
RECTANGLE Normal 832 592 -384 -656
