Version 4
SHEET 1 1692 792
WIRE 80 96 48 96
WIRE 336 96 304 96
WIRE 368 96 336 96
WIRE 736 96 368 96
WIRE 832 96 736 96
WIRE 368 128 368 96
WIRE 736 128 736 96
WIRE 800 128 736 128
WIRE 80 160 -160 160
WIRE 320 160 304 160
WIRE -160 176 -160 160
WIRE 720 176 576 176
WIRE 832 176 832 160
WIRE 688 192 608 192
WIRE 80 224 -16 224
WIRE 320 224 320 160
WIRE 320 224 304 224
WIRE 368 224 368 208
WIRE 368 224 320 224
WIRE 400 224 368 224
WIRE 512 224 480 224
WIRE 720 240 720 176
WIRE 800 240 720 240
WIRE 688 272 688 192
WIRE 688 272 672 272
WIRE 704 272 688 272
WIRE 800 272 800 240
WIRE 800 272 784 272
WIRE 832 272 832 256
WIRE 832 272 800 272
WIRE 64 288 -80 288
WIRE 80 288 64 288
WIRE 608 288 608 256
WIRE 608 288 304 288
WIRE 832 288 832 272
WIRE -80 304 -80 288
WIRE 704 304 672 304
WIRE -80 320 -80 304
WIRE 64 320 64 288
WIRE 336 320 336 96
WIRE 336 320 64 320
WIRE -16 336 -16 224
WIRE 176 336 -16 336
WIRE 48 368 48 96
WIRE 48 368 -48 368
WIRE 96 368 48 368
WIRE 368 368 368 224
WIRE 832 384 832 368
WIRE 96 416 96 368
WIRE -80 432 -80 416
WIRE -160 464 -160 256
WIRE 48 464 48 368
WIRE 48 464 -160 464
WIRE 368 464 368 432
WIRE 368 464 48 464
WIRE 576 464 576 272
WIRE 576 464 368 464
WIRE 704 464 576 464
WIRE 832 464 704 464
FLAG 96 416 0
FLAG 176 336 Out555
IOPIN 176 336 Out
FLAG -80 304 V+
FLAG 640 256 V+
FLAG -80 432 V-
FLAG 640 320 V-
SYMBOL Robertugo\\555_ALL 240 208 R0
WINDOW 38 -93 79 Left 0
SYMATTR InstName U1
SYMBOL cap 352 368 R0
WINDOW 0 -29 9 Left 0
WINDOW 3 -47 52 Left 0
SYMATTR InstName Ct
SYMATTR Value 1µ
SYMBOL res 384 224 R180
WINDOW 0 -32 96 Left 0
WINDOW 3 -42 69 Left 0
SYMATTR InstName Rt
SYMATTR Value 1e6
SYMBOL voltage 832 368 R0
WINDOW 3 -78 114 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 -27 59 Left 0
SYMATTR Value {vpwm}
SYMATTR InstName Vctrl
SYMBOL voltage -160 160 R0
WINDOW 3 -56 -1 Invisible 0
WINDOW 0 -24 60 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 {Vdd} 0 1u 1u .5 1)
SYMATTR InstName Vclk
SYMBOL Robertugo\\OPAMP5 640 224 M0
WINDOW 0 -26 64 Left 0
WINDOW 38 -52 133 Left 0
SYMATTR InstName U2
SYMATTR SpiceModel LM741/NS
SYMBOL res 688 288 R270
WINDOW 0 -13 19 VTop 0
WINDOW 3 13 114 VBottom 0
SYMATTR InstName R1
SYMATTR Value 1e5
SYMBOL voltage 704 368 R0
WINDOW 3 -93 113 Left 0
WINDOW 0 -24 56 Left 0
SYMATTR Value {2*vdd/3}
SYMATTR InstName Vref
SYMBOL res 688 288 R0
SYMATTR InstName R2
SYMATTR Value 1e4
SYMBOL npn2 512 176 R0
WINDOW 0 -2 -23 Left 0
WINDOW 3 -43 5 Left 0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL res 496 208 R90
WINDOW 0 15 106 VBottom 0
WINDOW 3 -12 5 VTop 0
SYMATTR InstName R3
SYMATTR Value 47k
SYMBOL v+&- -80 352 R0
WINDOW 0 -67 -19 Left 0
WINDOW 3 -73 -82 Left 0
SYMATTR InstName U3
SYMATTR Value VNP={vdd}
SYMBOL res 848 272 R180
WINDOW 0 46 66 Left 0
WINDOW 3 36 46 Left 0
SYMATTR InstName R4
SYMATTR Value 2k5
SYMBOL res 816 272 R0
WINDOW 0 -38 51 Left 0
WINDOW 3 -42 76 Left 0
SYMATTR InstName R5
SYMATTR Value 1e4
SYMBOL Robertugo\\Pote 816 64 R0
WINDOW 0 -75 48 Left 0
WINDOW 3 -71 86 Left 0
WINDOW 123 -39 107 Center 0
SYMATTR InstName Offset
SYMATTR Value Rt=5K
SYMATTR Value2 Set=1
SYMBOL cap 592 192 R0
WINDOW 0 -21 14 Left 0
WINDOW 3 -24 52 Left 0
SYMATTR InstName C1
SYMATTR Value 10µ
TEXT 894 152 Left 0 !.tran 0 10 0 startup
TEXT 888 176 Left 0 !.params: Vdd 15 Ronx=.1\n.step param Vpwm 0 1.5 .5\n.meas tran ta FIND time WHEN V(out555)={Vdd/2} td=.5m rise=1\n.meas tran tb FIND time WHEN V(out555)={Vdd/2} td=.5m rise=11\n.meas tran Frec PARAM 10/(tb-ta)\n.Meas tran Tc FIND time WHEN V(Out555)={Vdd/2} td=.5m fall=1\n.Meas tran Td FIND time WHEN V(Out555)={Vdd/2} td=.5m fall=2\n.Meas tran T1 Param  (Tc-Ta)\n.Meas tran T2  Param  (Td-Ta)\n.Meas tran Ton Param If (T1>0, T1, T2)\n.Meas tran Duty% Param  Ton*Frec*100
