Version 4
SHEET 1 880 680
WIRE -736 -64 -800 -64
WIRE -704 -64 -736 -64
WIRE -608 -64 -640 -64
WIRE -448 -64 -480 -64
WIRE -320 -64 -384 -64
WIRE -288 -64 -320 -64
WIRE 32 -64 -288 -64
WIRE 112 -64 32 -64
WIRE 240 -64 112 -64
WIRE 304 -64 240 -64
WIRE 32 -48 32 -64
WIRE -480 -32 -480 -64
WIRE -416 -32 -480 -32
WIRE -320 -32 -320 -64
WIRE 240 -32 240 -64
WIRE 304 -32 304 -64
WIRE 112 0 112 -64
WIRE 208 0 112 0
WIRE -800 16 -800 -64
WIRE -1008 48 -1056 48
WIRE -880 48 -928 48
WIRE -736 48 -736 -64
WIRE -704 48 -736 48
WIRE -624 48 -640 48
WIRE -480 48 -480 -32
WIRE -464 48 -480 48
WIRE -368 48 -368 32
WIRE -368 48 -384 48
WIRE -176 48 -368 48
WIRE 32 48 32 32
WIRE 32 48 -48 48
WIRE 192 48 32 48
WIRE -288 64 -288 -64
WIRE 32 64 32 48
WIRE 240 64 240 32
WIRE 304 64 304 32
WIRE 304 64 240 64
WIRE -1056 80 -1056 48
WIRE -880 96 -880 48
WIRE -560 96 -592 96
WIRE -480 96 -480 48
WIRE -432 96 -480 96
WIRE 192 96 192 48
WIRE 304 96 192 96
WIRE 384 96 304 96
WIRE 448 96 384 96
WIRE 464 96 448 96
WIRE -432 112 -432 96
WIRE -800 128 -800 96
WIRE -560 128 -800 128
WIRE -480 128 -480 96
WIRE -480 128 -496 128
WIRE 448 128 448 96
WIRE 384 144 384 96
WIRE -800 160 -800 128
WIRE -608 160 -608 -64
WIRE -560 160 -608 160
WIRE -288 160 -288 144
WIRE -288 160 -320 160
WIRE 192 160 192 96
WIRE 240 176 240 64
WIRE 240 176 224 176
WIRE 304 176 304 96
WIRE 304 176 256 176
WIRE -160 192 -192 192
WIRE -128 192 -160 192
WIRE -112 192 -112 96
WIRE -64 192 -112 192
WIRE 32 192 32 144
WIRE 32 192 0 192
WIRE 64 192 32 192
WIRE 160 192 128 192
WIRE 304 192 304 176
WIRE -1056 208 -1056 160
WIRE -944 208 -1056 208
WIRE -880 208 -880 176
WIRE -880 208 -944 208
WIRE -704 208 -736 208
WIRE -608 208 -608 160
WIRE -608 208 -640 208
WIRE -592 208 -592 96
WIRE -480 208 -480 128
WIRE -432 208 -432 192
WIRE -384 208 -432 208
WIRE 256 208 256 176
WIRE 256 208 224 208
WIRE -944 224 -944 208
WIRE -432 224 -432 208
WIRE -160 224 -160 192
WIRE 384 224 384 208
WIRE 448 224 448 208
WIRE 448 224 384 224
WIRE -288 240 -288 160
WIRE -256 240 -288 240
WIRE -112 240 -112 192
WIRE -80 240 -112 240
WIRE 240 240 240 176
WIRE 240 240 0 240
WIRE 448 240 448 224
WIRE 192 256 192 224
WIRE 192 256 176 256
WIRE -112 288 -112 240
WIRE 0 288 -112 288
WIRE 272 288 80 288
WIRE 304 288 304 272
WIRE 304 288 272 288
WIRE 352 288 304 288
WIRE 496 288 496 272
WIRE 496 288 416 288
WIRE -320 304 -320 256
WIRE -288 304 -320 304
WIRE -288 320 -288 304
WIRE -128 320 -128 192
WIRE -80 320 -128 320
WIRE 192 320 160 320
WIRE 272 320 272 288
WIRE 272 320 256 320
WIRE -944 336 -944 304
WIRE -800 336 -800 240
WIRE -736 336 -736 208
WIRE -736 336 -800 336
WIRE -704 336 -736 336
WIRE -624 336 -624 48
WIRE -624 336 -640 336
WIRE -592 336 -592 288
WIRE -592 336 -624 336
WIRE -480 336 -480 272
WIRE -480 336 -592 336
WIRE -432 336 -432 304
WIRE -432 336 -480 336
WIRE -320 336 -320 304
WIRE -320 336 -432 336
WIRE -192 336 -192 288
WIRE -192 336 -320 336
WIRE -160 336 -160 288
WIRE -160 336 -192 336
WIRE 160 336 160 320
WIRE 160 336 -160 336
WIRE 288 336 160 336
WIRE 384 336 384 320
WIRE 384 336 368 336
WIRE 496 336 496 288
WIRE 496 336 384 336
FLAG -288 320 0
FLAG -944 336 0
FLAG 448 240 0
FLAG 176 256 Rng
IOPIN 176 256 In
FLAG 464 96 Out
IOPIN 464 96 Out
FLAG 496 272 Rng
IOPIN 496 272 In
FLAG -80 320 Rng
IOPIN -80 320 Out
SYMBOL Robertugo\\opamp5 192 128 M0
WINDOW 0 -25 63 Left 0
WINDOW 38 5 -25 Left 0
SYMATTR InstName U1
SYMATTR SpiceModel uA741
SYMBOL LED 64 208 R270
WINDOW 0 17 5 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D1
SYMATTR Value QTLP690C
SYMBOL diode -64 208 R270
WINDOW 0 16 64 VTop 0
WINDOW 3 44 -15 VBottom 0
SYMATTR InstName D2
SYMATTR Value 1N914
SYMBOL res 16 48 R0
WINDOW 0 36 47 Left 0
SYMATTR InstName R1
SYMATTR Value 680
SYMBOL pnp2 -320 32 M270
WINDOW 0 34 63 VLeft 0
WINDOW 3 65 93 VLeft 0
SYMATTR InstName Q1
SYMATTR Value TIP2955
SYMBOL res -368 32 R90
WINDOW 0 18 17 VBottom 0
WINDOW 3 -24 64 VTop 0
SYMATTR InstName R2
SYMATTR Value 33
SYMBOL res 16 -64 R0
WINDOW 0 -16 13 Left 0
WINDOW 3 -26 36 Left 0
SYMATTR InstName R3
SYMATTR Value 0.1
SYMBOL Robertugo\\Pote 224 -64 R0
WINDOW 0 -12 12 Left 0
WINDOW 3 -96 24 Left 0
WINDOW 123 -61 50 Center 0
SYMATTR InstName Pi
SYMATTR Value Rt=100K
SYMATTR Value2 Set=0.83
SYMBOL cap 288 -32 R0
WINDOW 0 -16 8 Left 0
WINDOW 3 -38 72 Left 0
SYMATTR InstName C1
SYMATTR Value 100p
SYMBOL res 16 224 R90
WINDOW 0 18 103 VBottom 0
WINDOW 3 -11 11 VTop 0
SYMATTR InstName R4
SYMATTR Value 180k
SYMBOL res 96 272 R90
WINDOW 0 17 107 VBottom 0
WINDOW 3 -10 13 VTop 0
SYMATTR InstName R5
SYMATTR Value 220
SYMBOL res 320 288 R180
WINDOW 0 30 79 Left 0
WINDOW 3 29 47 Left 0
SYMATTR InstName R6
SYMATTR Value 220
SYMBOL Robertugo\\Pote 320 304 R270
WINDOW 0 30 -1 VRight 0
WINDOW 3 1 93 VRight 0
WINDOW 123 -18 123 VCenter 0
SYMATTR InstName Pv
SYMATTR Value Rt=5k
SYMATTR Value2 Set={cur}
SYMBOL polcap 256 304 R90
WINDOW 0 14 100 VBottom 0
WINDOW 3 -15 -2 VTop 0
SYMATTR InstName C2
SYMATTR Value 1u
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=63 Irms=170m Rser=1 Lser=0 mfg="Nichicon" pn="UPG1J100MPH" type="Al electrolytic"
SYMBOL polcap 368 144 R0
WINDOW 3 24 64 Left 0
SYMATTR Value 10u
SYMATTR InstName C3
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=63 Irms=170m Rser=1 Lser=0 mfg="Nichicon" pn="UPG1J100MPH" type="Al electrolytic"
SYMBOL diode -704 -48 R270
WINDOW 0 16 -2 VTop 0
WINDOW 3 42 87 VBottom 0
SYMATTR InstName D3
SYMATTR Value MR760
SYMBOL diode -640 64 M270
WINDOW 0 16 69 VTop 0
WINDOW 3 64 10 Invisible 0
SYMATTR InstName D4
SYMATTR Value MR760
SYMBOL diode -704 224 R270
WINDOW 0 16 -9 VTop 0
WINDOW 3 66 52 Invisible 0
SYMATTR InstName D5
SYMATTR Value MR760
SYMBOL polcap -496 208 R0
WINDOW 3 -70 35 Left 0
WINDOW 0 -48 9 Left 0
SYMATTR Value 10m
SYMATTR InstName Cf1
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=63 Irms=10 Rser=0.008 Lser=0
SYMBOL ind2 -784 112 R180
WINDOW 0 -43 70 Left 0
WINDOW 3 -47 44 Left 0
SYMATTR InstName Ls1
SYMATTR Value 10m
SYMBOL ind2 -784 256 R180
WINDOW 0 -45 84 Left 0
WINDOW 3 -49 56 Left 0
SYMATTR InstName Ls2
SYMATTR Value 10m
SYMBOL ind2 -896 192 M180
WINDOW 0 -36 80 Left 0
WINDOW 3 -25 53 Left 0
SYMATTR InstName Lp
SYMATTR Value 1
SYMATTR SpiceLine Rser=1
SYMBOL res -960 208 R0
WINDOW 0 32 46 Left 0
SYMATTR InstName Rfuga
SYMATTR Value 1g
SYMBOL voltage -1056 64 R0
WINDOW 0 -15 58 Left 0
WINDOW 3 5 108 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 311 50)
SYMBOL Robertugo\\Sw321 -528 128 R0
SYMATTR InstName LL1
SYMATTR Value sel={llave}
SYMBOL res -608 192 R0
WINDOW 0 32 89 Left 0
WINDOW 3 32 115 Left 0
SYMATTR InstName Roff1
SYMATTR Value 1g
SYMBOL res -912 32 R90
WINDOW 0 17 129 VBottom 0
WINDOW 3 -11 -12 VTop 0
SYMATTR InstName Rfuse1
SYMATTR Value 0.1
SYMBOL diode -640 352 M270
WINDOW 0 16 69 VTop 0
WINDOW 3 64 10 Invisible 0
SYMATTR InstName D6
SYMATTR Value MR760
SYMBOL res 432 112 R0
WINDOW 0 39 51 Left 0
WINDOW 3 43 81 Left 0
SYMATTR InstName RL
SYMATTR Value 8
SYMBOL res 384 320 R90
WINDOW 0 -2 83 VBottom 0
WINDOW 3 -30 48 VTop 0
SYMATTR InstName R8
SYMATTR Value 3k3
SYMBOL npn2 -256 192 R0
WINDOW 3 -19 112 Left 0
WINDOW 0 -22 32 Left 0
SYMATTR Value BC546A
SYMATTR InstName Q2
SYMBOL npn2 -384 160 R0
WINDOW 3 66 5 VRight 0
WINDOW 0 -26 34 Left 0
SYMATTR Value BC546A
SYMATTR InstName Q3
SYMBOL res -448 208 R0
WINDOW 0 37 49 Left 0
WINDOW 3 38 78 Left 0
SYMATTR InstName Rd1
SYMATTR Value 1k
SYMBOL res -448 96 R0
WINDOW 0 45 33 Left 0
WINDOW 3 42 60 Left 0
SYMATTR InstName Rd2
SYMATTR Value 56k
SYMBOL res -304 48 R0
WINDOW 0 -29 36 Left 0
WINDOW 3 -33 72 Left 0
SYMATTR InstName R7
SYMATTR Value 22k
SYMBOL polcap -176 224 R0
WINDOW 0 -16 -2 Left 0
WINDOW 3 -10 55 Left 0
SYMATTR InstName C4
SYMATTR Value 1u
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=63 Irms=170m Rser=1 Lser=0 mfg="Nichicon" pn="UPG1J100MPH" type="Al electrolytic"
SYMBOL diode -384 -48 M270
WINDOW 0 16 80 VTop 0
WINDOW 3 64 10 Invisible 0
SYMATTR InstName Dz38
SYMATTR Value 1N4001
SYMBOL reg3all -48 64 R0
SYMATTR InstName U3
SYMATTR SpiceModel LM317
TEXT -1072 -80 Left 0 !.tran 0 {.01*llave*llave} 0 10u startup
TEXT -840 48 VRight 0 !K Lp Ls1 Ls2 1
TEXT -1072 -48 Left 0 !.step param cur 0 1 .15\n.step param llave 2 3 1
TEXT 176 304 Left 0 ;10u
TEXT -104 264 Left 0 ;330k
TEXT 160 16 Left 0 ;250k
TEXT 64 -16 Left 0 ;0.2
TEXT 248 272 Left 0 ;240
TEXT 64 24 Left 0 ;4w
