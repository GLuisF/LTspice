**************************************************************************************************************************************************************************************************
*
*  888888              888888               888888  .o888888888888o.    8888         88888888888  o888888888888888   88888888888888o   88888888888  88888888888  8888888888o
*   88888             88888888             88888   .8888888  8888888.   8888         88888888888  o8888888888888888  888888  8888888o  88888888888  88888888888  88888888888o
*    88888           8888  8888           88888   .8888888.  .8888888.  8888         8888         888888888          888888  88888888  8888         8888         8888   88888
*     88888         8888    8888         88888    88888888    88888888  8888         8888         888888888          888888  88888888  8888         8888         8888   88888
*      88888       8888      8888       88888     88888888    88888888  8888         8888888      o888888888888888o  888888  8888888o  8888888      8888888      8888   88888
*       88888     8888        8888     88888      88888888    88888888  8888         8888888      o888888888888888o  88888888888888o   8888888      8888888      8888   88888
*        88888   8888          8888   88888       88888888    88888888  8888         8888                  88888888  8888              8888         8888         8888   88888
*         88888 8888            8888 88888        .8888888.  .8888888.  8888         8888                  88888888  8888              8888         8888         8888   88888
*          88888888             88888888           .8888888  8888888.   88888888888  8888         8888888888888888o  8888              88888888888  88888888888  88888888888o
*           888888               888888             .o888888888888o.    88888888888  8888         888888888888888o   8888              88888888888  88888888888  8888888888o
*
**************************************************************************************************************************************************************************************************
*******************************************************************************
**	DISCLAIMER
*******************************************************************************
**	This model is provided as is, where is, and with no warranty of any kind
**	either expressed or implied, including but not rdlimed to any implied
**	warranties of merchantability and fitness for a particular purpose.
*******************************************************************************

***********************************************************
****	Wolfspeed SiC MOSFET C3M0045065D Spice Library
****	Version 1.0 Date: 01-19-2021
****	Version 2.0 Date: 10-27-2021
****	Version 3.0	Date: 07-31-2023
***********************************************************
****	Revision record
****	Version 1	Initial Release, Datasheet Rev 1, 1-2021
****	Version 2	Improved 3rd quadrant and body diode
****	Version 3	Update to new model structure
*********************************************************************************
****Parasitics Included
****Tj = Junction Temperature
****Tc = Case Temperature
****D = Drain
****G = Gate
****S1 = Kelvin Source
****S2 = Power Source
***********************************************************

.subckt C3M0045065D d g s1 Tj Tc

* Put in specified Rgint
.param Rgint = 3.5

Ci_d d 0 1p Rpar=1G
Ci_g	g 0 1p Rpar=1G
Ci_s1 s1 0 1p Rpar=1G
Ci_Tj Tj 0 1p Rpar=1G
Ci_Tc Tc 0 1p Rpar=1G

.func rdlim(x,n,p,z) {
+	uplim(dnlim(x,n,z),p,z)
+}

R1022	Tjc	0	1E6
E1022	Tjc	0 	value {rdlim(v(Tj),-40,175,.1)}

R100	gk	0	1E6
E100	gk	0 	value {rdlim(v(g1,s),-4,19,.1)}


e33	NET3	0	Value {rdlim(12.9761u*V(Tjc)**2-6.0066m*V(Tjc)+2.6953,-3.5,3.5,0.01)}
R_cc	NET3	0 	1E6

Ls1 		s1	s	2.17n Rser=1.31m
R_Ls1 		s1	s  	100

*R_gg 		g1	s	1E6
R_g 		g1	g2	{Rgint}
Lg 			g	g2	7.7n Rser=13.255m
R_Lg 		g	g2	100

Ld 		d	d3	4.366n Rser=87.416u
R_Ld		d	d3	100


Rdrain_s	d3	d1	10u
Cdrs		d3	d1	1p
Gheat		0	Tj	value = {abs((V(d1,s)*I(Rdrain_s)))+abs((V(g1,g2)**2/Rgint))}
CGS		g1	s	1613p Rpar=100k

*Body Diode Implementation
.func rbody(vgs,t) {table(t,-40,r1(vgs),25,r2(vgs),175,r3(vgs))}
.func r1(vgs) {table(vgs,-4,40.47m,-2,41.8m,0,44.7m,5,20m,10,30m,15,60m)}
.func r2(vgs) {table(vgs,-4,39.68m,-2,42.21m,0,46.9m,5,20m,10,35m,15,65m)}
.func r3(vgs) {table(vgs,-4,37.56m,-2,40.644m,0,45.602m,5,10m,10,30m,15,60m)}

.func nd(vgs,t) {table(t,-40,nd_n40(vgs),25,nd_25(vgs),175,nd_175(vgs))}
.func nd_n40(vgs) {table(vgs,-4,352.55m,-2,299.8m,0,232.8m,5,40m,10,10m,15,1m)}
.func nd_25(vgs) {table(vgs,-4,317.1m,-2,267.27m,0,203.2m,5,55m,10,35m,15,20m)}
.func nd_175(vgs) {table(vgs,-4,290.546m,-2,250.61m,0,204.66m,5,40m,10,10m,15,1m)}

GRbd d1 dd2 value {V(d1,dd2)/rdlim(rbody(V(gk),V(Tjc)),10m,60m,0.1)}
GITQ s dd2 value {uplim(1u*(-1+exp(V(s,dd2)/(V(ND)))),1e4,1m)}

Ef	ND	0	value {rdlim(nd(V(gk),V(Tjc)),1m,360m,0.01)}
Rf	ND	0	10Meg		

CDS1		dd2	s	1p
CGD1		g1	d3	1p
R_DS1		dd2	s	0.5G


R0 N1 Tj 0.1315
R1 N2 N1 0.2833
R2 N3 N2 0.2236
R3 Tc N3 0.2118

C0 Tj 0 0.9357m
C1 N1 0 4.604m
C2 N2 0 23.89m
C3 N3 0 0.2139

R_tc Tc 0 10k

****************************************
.func gain(vgs,t) {
+	table(t,-40,g1(vgs),25,g2(vgs),175,g3(vgs))
+}

.func nval(vgs,t) {
+	table(t,-40,n1(vgs),25,n2(vgs),175,n3(vgs))
+}

.func lam(vgs,t) {
+	table(t,-40,l1(vgs),25,l2(vgs),175,l3(vgs))
+}

.func drain_current(vgs,vds,vth,g,n,l) {
+	g*(vgs-vth)*(log(1+exp(vgs-vth))**2 - log(1+exp(vgs-vth-n*vds))**2)*(1+l*vds)
+}

.func g1(vgs) {table(vgs,3,0.502335,3.32653,0.403762,3.65306,0.303909,3.97959,0.21104,4.30612,0.133419,4.63265,0.079307,4.95918,0.0569689,5.28571,0.0583057,5.61224,0.0606066,5.93878,0.0634117,6.26531,0.0665731,6.59184,0.0699428,6.91837,0.0733729,7.2449,0.0768506,7.57143,0.0805451,7.89796,0.0842974,8.22449,0.0879332,8.55102,0.0912782,8.87755,0.0941581,9.20408,0.0965308,9.53061,0.0987492,9.85714,0.100753,10.1837,0.102437,10.5102,0.103694,10.8367,0.10442,11.1633,0.10454,11.4898,0.104214,11.8163,0.103545,12.1429,0.102612,12.4694,0.101494,12.7959,0.100267,13.1224,0.0989875,13.449,0.0974698,13.7755,0.0956672,14.102,0.0935932,14.4286,0.0912615,14.7551,0.0886854,15.0816,0.0858474,15.4082,0.0821695,15.7347,0.0777224,16.0612,0.0728935,16.3878,0.0680703,16.7143,0.0636403,17.0408,0.0599823,17.3673,0.0567458,17.6939,0.0536364,18.0204,0.050746,18.3469,0.0481666,18.6735,0.0459904,19,0.0443093)}
.func n1(vgs) {table(vgs,3,0.295346,3.32653,0.315374,3.65306,0.340596,3.97959,0.369948,4.30612,0.402362,4.63265,0.436775,4.95918,0.47212,5.28571,0.515262,5.61224,0.572883,5.93878,0.635788,6.26531,0.694596,6.59184,0.739926,6.91837,0.762398,7.2449,0.761507,7.57143,0.755144,7.89796,0.745726,8.22449,0.7348,8.55102,0.723912,8.87755,0.714608,9.20408,0.707514,9.53061,0.700211,9.85714,0.692802,10.1837,0.685694,10.5102,0.679293,10.8367,0.674007,11.1633,0.670084,11.4898,0.666804,11.8163,0.663961,12.1429,0.661489,12.4694,0.659321,12.7959,0.65739,13.1224,0.655663,13.449,0.654478,13.7755,0.654027,14.102,0.654421,14.4286,0.655773,14.7551,0.658193,15.0816,0.662026,15.4082,0.671867,15.7347,0.687858,16.0612,0.70785,16.3878,0.729693,16.7143,0.751239,17.0408,0.770373,17.3673,0.788114,17.6939,0.805895,18.0204,0.823719,18.3469,0.84159,18.6735,0.859513,19,0.877491)}
.func l1(vgs) {table(vgs,3,0.0228838,3.32653,0.0229619,3.65306,0.0230382,3.97959,0.0231111,4.30612,0.0231792,4.63265,0.0232412,4.95918,0.0232954,5.28571,0.0233428,5.61224,0.0233864,5.93878,0.0234272,6.26531,0.023466,6.59184,0.0235034,6.91837,0.0235403,7.2449,0.0235766,7.57143,0.0236103,7.89796,0.0236408,8.22449,0.0236675,8.55102,0.0236899,8.87755,0.0237074,9.20408,0.0237052,9.53061,0.0236355,9.85714,0.0235058,10.1837,0.023329,10.5102,0.0231182,10.8367,0.0228864,11.1633,0.0226326,11.4898,0.0222909,11.8163,0.0218726,12.1429,0.0214031,12.4694,0.0209078,12.7959,0.0204124,13.1224,0.0199269,13.449,0.0193338,13.7755,0.0186705,14.102,0.0180209,14.4286,0.0174688,14.7551,0.0170982,15.0816,0.0169828,15.4082,0.016959,15.7347,0.0169412,16.0612,0.0169282,16.3878,0.0169185,16.7143,0.016911,17.0408,0.0169043,17.3673,0.016897,17.6939,0.0168891,18.0204,0.0168813,18.3469,0.0168742,18.6735,0.0168686,19,0.0168651)}
.func g2(vgs) {table(vgs,3,0.133662,3.32653,0.125508,3.65306,0.117313,3.97959,0.109847,4.30612,0.103878,4.63265,0.100177,4.95918,0.0995105,5.28571,0.101621,5.61224,0.104886,5.93878,0.108771,6.26531,0.11276,6.59184,0.116335,6.91837,0.11898,7.2449,0.120668,7.57143,0.12228,7.89796,0.123752,8.22449,0.124971,8.55102,0.125823,8.87755,0.126193,9.20408,0.125956,9.53061,0.125049,9.85714,0.123552,10.1837,0.121558,10.5102,0.119156,10.8367,0.116438,11.1633,0.113393,11.4898,0.109556,11.8163,0.105076,12.1429,0.100208,12.4694,0.0952099,12.7959,0.0903379,13.1224,0.085793,13.449,0.0812086,13.7755,0.0765602,14.102,0.0719689,14.4286,0.067556,14.7551,0.0634426,15.0816,0.0597385,15.4082,0.0562897,15.7347,0.0530266,16.0612,0.0499725,16.3878,0.0471506,16.7143,0.0445843,17.0408,0.0422943,17.3673,0.0401113,17.6939,0.0379765,18.0204,0.0359656,18.3469,0.0341544,18.6735,0.0326186,19,0.031434)}
.func n2(vgs) {table(vgs,3,0.329284,3.32653,0.35487,3.65306,0.385068,3.97959,0.418968,4.30612,0.455657,4.63265,0.494225,4.95918,0.53376,5.28571,0.581065,5.61224,0.642576,5.93878,0.709137,6.26531,0.771412,6.59184,0.820066,6.91837,0.845763,7.2449,0.846145,7.57143,0.835711,7.89796,0.81906,8.22449,0.800152,8.55102,0.782946,8.87755,0.771404,9.20408,0.767204,9.53061,0.764185,9.85714,0.762053,10.1837,0.761255,10.5102,0.762236,10.8367,0.765443,11.1633,0.771754,11.4898,0.783636,11.8163,0.800505,12.1429,0.821282,12.4694,0.844886,12.7959,0.870238,13.1224,0.896705,13.449,0.927666,13.7755,0.962613,14.102,0.999747,14.4286,1.03727,14.7551,1.07338,15.0816,1.10639,15.4082,1.13741,15.7347,1.16755,16.0612,1.19711,16.3878,1.22644,16.7143,1.25585,17.0408,1.28567,17.3673,1.31573,17.6939,1.34581,18.0204,1.37592,18.3469,1.40606,18.6735,1.43623,19,1.46642)}
.func l2(vgs) {table(vgs,3,0.0164293,3.32653,0.0164778,3.65306,0.016525,3.97959,0.01657,4.30612,0.0166122,4.63265,0.0166506,4.95918,0.0166845,5.28571,0.0167135,5.61224,0.0167386,5.93878,0.0167613,6.26531,0.0167832,6.59184,0.0168059,6.91837,0.016831,7.2449,0.0168625,7.57143,0.0169038,7.89796,0.0169489,8.22449,0.0169913,8.55102,0.0170246,8.87755,0.0170425,9.20408,0.0170376,9.53061,0.0170072,9.85714,0.0169586,10.1837,0.0168998,10.5102,0.0168387,10.8367,0.0167833,11.1633,0.0167382,11.4898,0.0166901,11.8163,0.0166409,12.1429,0.0165954,12.4694,0.0165589,12.7959,0.0165362,13.1224,0.0165341,13.449,0.016568,13.7755,0.0166288,14.102,0.0167015,14.4286,0.0167713,14.7551,0.0168232,15.0816,0.0168438,15.4082,0.0168521,15.7347,0.0168592,16.0612,0.0168654,16.3878,0.0168708,16.7143,0.0168755,17.0408,0.01688,17.3673,0.0168845,17.6939,0.0168891,18.0204,0.0168937,18.3469,0.016898,18.6735,0.0169019,19,0.016905)}
.func g3(vgs) {table(vgs,3,0.214304,3.32653,0.216531,3.65306,0.218388,3.97959,0.219765,4.30612,0.22055,4.63265,0.220632,4.95918,0.219901,5.28571,0.218201,5.61224,0.21552,5.93878,0.212033,6.26531,0.207919,6.59184,0.203355,6.91837,0.19852,7.2449,0.193318,7.57143,0.187271,7.89796,0.180545,8.22449,0.173337,8.55102,0.165843,8.87755,0.158261,9.20408,0.150592,9.53061,0.142343,9.85714,0.133731,10.1837,0.125047,10.5102,0.116582,10.8367,0.108626,11.1633,0.101354,11.4898,0.0943034,11.8163,0.0874837,12.1429,0.0810126,12.4694,0.075008,12.7959,0.0695875,13.1224,0.0648215,13.449,0.0603205,13.7755,0.0560365,14.102,0.0520508,14.4286,0.0484449,14.7551,0.0453002,15.0816,0.042682,15.4082,0.0403053,15.7347,0.0380526,16.0612,0.0359443,16.3878,0.034001,16.7143,0.032243,17.0408,0.0306886,17.3673,0.0291994,17.6939,0.0277228,18.0204,0.026315,18.3469,0.0250324,18.6735,0.0239313,19,0.0230681)}
.func n3(vgs) {table(vgs,3,0.318954,3.32653,0.347273,3.65306,0.378895,3.97959,0.413197,4.30612,0.449556,4.63265,0.487349,4.95918,0.525953,5.28571,0.571074,5.61224,0.627914,5.93878,0.688751,6.26531,0.745713,6.59184,0.790929,6.91837,0.816528,7.2449,0.817893,7.57143,0.8026,7.89796,0.777659,8.22449,0.74987,8.55102,0.726034,8.87755,0.712952,9.20408,0.713668,9.53061,0.717872,9.85714,0.724389,10.1837,0.733236,10.5102,0.744431,10.8367,0.75799,11.1633,0.774085,11.4898,0.793352,11.8163,0.815213,12.1429,0.838906,12.4694,0.863667,12.7959,0.888734,13.1224,0.913483,13.449,0.938785,13.7755,0.964809,14.102,0.991373,14.4286,1.0183,14.7551,1.0454,15.0816,1.07251,15.4082,1.09988,15.7347,1.12756,16.0612,1.15545,16.3878,1.18344,16.7143,1.21143,17.0408,1.23933,17.3673,1.26717,17.6939,1.29503,18.0204,1.32291,18.3469,1.35081,18.6735,1.37872,19,1.40666)}
.func l3(vgs) {table(vgs,3,0.014528,3.32653,0.0145795,3.65306,0.0146297,3.97959,0.0146776,4.30612,0.0147217,4.63265,0.0147608,4.95918,0.0147937,5.28571,0.0148213,5.61224,0.0148467,5.93878,0.0148702,6.26531,0.0148921,6.59184,0.0149125,6.91837,0.0149318,7.2449,0.0149507,7.57143,0.0149703,7.89796,0.0149886,8.22449,0.0150036,8.55102,0.0150132,8.87755,0.0150154,9.20408,0.0150043,9.53061,0.014968,9.85714,0.0149148,10.1837,0.0148542,10.5102,0.0147962,10.8367,0.0147504,11.1633,0.0147231,11.4898,0.0147,11.8163,0.0146787,12.1429,0.01466,12.4694,0.0146446,12.7959,0.0146332,13.1224,0.0146261,13.449,0.0146194,13.7755,0.0146125,14.102,0.0146066,14.4286,0.0146023,14.7551,0.0146007,15.0816,0.0146025,15.4082,0.0146063,15.7347,0.0146109,16.0612,0.0146159,16.3878,0.0146209,16.7143,0.0146255,17.0408,0.0146293,17.3673,0.0146328,17.6939,0.0146361,18.0204,0.0146394,18.3469,0.0146423,18.6735,0.014645,19,0.0146472)}


****************************************
G2 d1 s value {
+	if(V(d3,s)<=0,
+		if (V(gk)<=V(NET3),
+		0
+		,
+		-drain_current(V(gk),V(s,d3),V(NET3),gain(V(gk),V(Tjc)),nval(V(gk),V(Tjc)),lam(V(gk),V(Tjc)))
+		)
+		,
+		if (V(gk)<=V(NET3),
+		0
+		,
+		drain_current(V(gk),V(d3,s),V(NET3),gain(V(gk),V(Tjc)),nval(V(gk),V(Tjc)),lam(V(gk),V(Tjc)))
+		)
+			)
+			}
****************************************
.param k1=1785p
.param k2=0.55
.param ka=99
.param kb=0.32
.param kc=4

G11 g1 d11 value {
+		k1*(
+		(1+(rdlim(v(d3,g1),0.1,270,0.01))*(1+ka*(1+TANH(kb*V(d3,g1)-kc))/2))**(-k2)
+		)*ddt(v(g1,d3))
+			} Rpar=1Meg
R_CGD d11 d3 1E-4


.param Cjo = 1222p
.param Vj  = 3.3
.param M   = 0.52

G12 d12 s value {
+		(Cjo/(1+(rdlim(v(d3,s),0.1,270,0.01)/Vj)**M))*ddt(v(d3,s))
+			} Rpar=1Meg
R_CDS d12 d3 1E-4

****************************************


.ends C3M0045065D

****************************************

