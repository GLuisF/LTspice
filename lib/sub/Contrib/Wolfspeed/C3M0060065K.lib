**************************************************************************************************************************************************************************************************
*
*  888888              888888               888888  .o888888888888o.    8888         88888888888  o888888888888888   88888888888888o   88888888888  88888888888  8888888888o
*   88888             88888888             88888   .8888888  8888888.   8888         88888888888  o8888888888888888  888888  8888888o  88888888888  88888888888  88888888888o
*    88888           8888  8888           88888   .8888888.  .8888888.  8888         8888         888888888          888888  88888888  8888         8888         8888   88888
*     88888         8888    8888         88888    88888888    88888888  8888         8888         888888888          888888  88888888  8888         8888         8888   88888
*      88888       8888      8888       88888     88888888    88888888  8888         8888888      o888888888888888o  888888  8888888o  8888888      8888888      8888   88888
*       88888     8888        8888     88888      88888888    88888888  8888         8888888      o888888888888888o  88888888888888o   8888888      8888888      8888   88888
*        88888   8888          8888   88888       88888888    88888888  8888         8888                  88888888  8888              8888         8888         8888   88888
*         88888 8888            8888 88888        .8888888.  .8888888.  8888         8888                  88888888  8888              8888         8888         8888   88888
*          88888888             88888888           .8888888  8888888.   88888888888  8888         8888888888888888o  8888              88888888888  88888888888  88888888888o
*           888888               888888             .o888888888888o.    88888888888  8888         888888888888888o   8888              88888888888  88888888888  8888888888o
*
**************************************************************************************************************************************************************************************************
*******************************************************************************
**	DISCLAIMER
*******************************************************************************
**	This model is provided as is, where is, and with no warranty of any kind
**	either expressed or implied, including but not rdlimed to any implied
**	warranties of merchantability and fitness for a particular purpose.
*******************************************************************************

***********************************************************
****	Wolfspeed SiC MOSFET C3M0060065K Spice Library
****	Revision 1.0 Date: 02-19-2020
****	Revision 2.0 Date: 02-23-2021
****	Revision 3.0 Date: 03-26-2021
****	Revision 4.0 Date: 06-15-2022
****	Revision 5.0 Date: 03-10-2023
***********************************************************
****	Revision record
****	Revision 1	Initial Release, Datasheet Rev B, 02-2020
****	Revision 2	Removed 0pF section at Cds and compatible with Keysight ADS
****	Revision 3	Improved dynamic performance and datasheet Rev3, 07-2020
****	Revision 4	Updated to reflect new datasheet revision
****	Revision 5	Implemented new model philosophy for convergence and accuracy improvement
*********************************************************************************
****Parasitics Included
****Tj = Junction Temperature
****Tc = Case Temperature
****D = Drain
****G = Gate
****S1 = Kelvin Source
****S2 = Power Source
***********************************************************

.subckt C3M0060065K d g s1 s2 Tj Tc

* Put in specified Rgint
.param Rgint = 3

Ci_d d 0 1p Rpar=1G
Ci_g	g 0 1p Rpar=1G
Ci_s1 s1 0 1p Rpar=1G
Ci_s2 s2 0 1p Rpar=1G
Ci_Tj Tj 0 1p Rpar=1G
Ci_Tc Tc 0 1p Rpar=1G

.func rdlim(x,n,p,z) {
+	uplim(dnlim(x,n,z),p,z)
+}

R1022	Tjc	0	1E6
E1022	Tjc	0 	value {rdlim(v(Tj),-40,175,.1)}

R100	gk	0	1E6
E100	gk	0 	value {rdlim(v(g1,s),-4,19,.1)}


e33	NET3	0	Value {rdlim(15.9430u*V(Tj)**2-7.0092m*V(Tj)+2.9816,-3.5,3.5,0.01)}
R_cc	NET3	0 	1E6

Ls1 		s1	sv	6n Rser=10.11m
R_Ls1 		s1	sv  	100

Ls2 		s2	sv	2.3n Rser=3.5636m
R_Ls2 		s2	sv  	100

Rv		sv	s	100
Lv		sv	s	0.65n Rser=0.1m

*R_gg 		g1	s	1E6
R_g 		g1	g2	{Rgint}
Lg 			g	g2	7.7n Rser=13.255m
R_Lg 		g	g2	100

Ld 		d	d3	4.366n Rser=87.416u
R_Ld		d	d3	100


Rdrain_s	d3	d1	10u
Cdrs		d3	d1	1p
Gheat		0	Tj	value = {abs((V(d1,s)*I(Rdrain_s)))+abs((V(g1,g2)**2/Rgint))}
CGS		g1	s	1100p Rpar=100k

*Body Diode Implementation
.func rbody(vgs,t) {table(t,-40,r1(vgs),25,r2(vgs),175,r3(vgs))}
.func r1(vgs) {table(vgs,-4,36.1m,-2,42.1m,0,51.6m,5,65m,10,100m,15,200m)}
.func r2(vgs) {table(vgs,-4,38.6m,-2,43.1m,0,55.9m,5,20m,10,35m,15,65m)}
.func r3(vgs) {table(vgs,-4,40.23m,-2,45.644m,0,58.602m,5,10m,10,30m,15,60m)}

.func nd(vgs,t) {table(t,-40,nd_n40(vgs),25,nd_25(vgs),175,nd_175(vgs))}
.func nd_n40(vgs) {table(vgs,-4,285m,-2,251.8m,0,194.8m,5,40m,10,10m,15,1m)}
.func nd_25(vgs) {table(vgs,-4,240.1m,-2,211.1m,0,162.2m,5,55m,10,35m,15,20m)}
.func nd_175(vgs) {table(vgs,-4,258.546m,-2,234.237m,0,204.66m,5,40m,10,10m,15,1m)}

GRbd d1 dd2 value {V(d1,dd2)/rdlim(rbody(V(gk),V(Tjc)),10m,60m,0.1)}
GITQ s dd2 value {uplim(1u*(-1+exp(V(s,dd2)/(V(ND)))),1e4,1m)}

Ef	ND	0	value {rdlim(nd(V(gk),V(Tjc)),1m,320m,0.01)}
Rf	ND	0	10Meg	

CDS1		dd2	s	1p
CGD1		g1	d3	1p
R_DS1		dd2	s	0.5G


R0 N1 Tj 181.008m
R1 N2 N1 386.142m
R2 N3 N2 251.088m
R3 Tc N3 202.871m

C0 Tj 0 689.555u
C1 N1 0 3.4199m
C2 N2 0 15.973m
C3 N3 0 156.608m

R_tc Tc 0 10k

****************************************
.func gain(vgs,t) {
+	table(t,-40,g1(vgs),25,g2(vgs),175,g3(vgs))
+}

.func nval(vgs,t) {
+	table(t,-40,n1(vgs),25,n2(vgs),175,n3(vgs))
+}

.func lam(vgs,t) {
+	table(t,-40,l1(vgs),25,l2(vgs),175,l3(vgs))
+}

.func drain_current(vgs,vds,vth,g,n,l) {
+	g*(vgs-vth)*(log(1+exp(vgs-vth))**2 - log(1+exp(vgs-vth-n*vds))**2)*(1+l*vds)
+}

.func g1(vgs) {table(vgs,3,0.0402647,3.32653,0.0386355,3.65306,0.037676,3.97959,0.0374581,4.30612,0.0380539,4.63265,0.0395355,4.95918,0.0419748,5.28571,0.0462889,5.61224,0.0531005,5.93878,0.0611461,6.26531,0.0691415,6.59184,0.0758026,6.91837,0.079845,7.2449,0.0807366,7.57143,0.0800322,7.89796,0.0784721,8.22449,0.0767339,8.55102,0.0754948,8.87755,0.0754322,9.20408,0.0769325,9.53061,0.0791584,9.85714,0.0817492,10.1837,0.0844263,10.5102,0.0869113,10.8367,0.0889257,11.1633,0.0902787,11.4898,0.0912953,11.8163,0.0919809,12.1429,0.0922618,12.4694,0.0920643,12.7959,0.0913146,13.1224,0.0899237,13.449,0.0877541,13.7755,0.0849746,14.102,0.0818168,14.4286,0.078512,14.7551,0.0752915,15.0816,0.072369,15.4082,0.06953,15.7347,0.0666709,16.0612,0.063832,16.3878,0.0610536,16.7143,0.0583761,17.0408,0.0558386,17.3673,0.0534016,17.6939,0.0510342,18.0204,0.0487489,18.3469,0.0465582,18.6735,0.0444744,19,0.0425099)}
.func n1(vgs) {table(vgs,3,0.982494,3.32653,0.91059,3.65306,0.840882,3.97959,0.773559,4.30612,0.708813,4.63265,0.646834,4.95918,0.587813,5.28571,0.527828,5.61224,0.463989,5.93878,0.402305,6.26531,0.348886,6.59184,0.309838,6.91837,0.291272,7.2449,0.30483,7.57143,0.358041,7.89796,0.434136,8.22449,0.515487,8.55102,0.584465,8.87755,0.623441,9.20408,0.625414,9.53061,0.621018,9.85714,0.614858,10.1837,0.608157,10.5102,0.602136,10.8367,0.598018,11.1633,0.596453,11.4898,0.594987,11.8163,0.593594,12.1429,0.592793,12.4694,0.593099,12.7959,0.59503,13.1224,0.59942,13.449,0.60943,13.7755,0.624409,14.102,0.642681,14.4286,0.662568,14.7551,0.682393,15.0816,0.700588,15.4082,0.718363,15.7347,0.736546,16.0612,0.755118,16.3878,0.77406,16.7143,0.793353,17.0408,0.81298,17.3673,0.833042,17.6939,0.853581,18.0204,0.874557,18.3469,0.895929,18.6735,0.917658,19,0.939702)}
.func l1(vgs) {table(vgs,3,0.0183575,3.32653,0.0150876,3.65306,0.0117746,3.97959,0.00869,4.30612,0.00610526,4.63265,0.00429181,4.95918,0.00352113,5.28571,0.00352985,5.61224,0.0035715,5.93878,0.00362308,6.26531,0.00367177,6.59184,0.00370474,6.91837,0.00370918,7.2449,0.00368601,7.57143,0.00366217,7.89796,0.00363834,8.22449,0.00361377,8.55102,0.00358771,8.87755,0.00355941,9.20408,0.00352849,9.53061,0.00349573,9.85714,0.00346102,10.1837,0.00342412,10.5102,0.00338478,10.8367,0.00334278,11.1633,0.00329578,11.4898,0.00323411,11.8163,0.0031633,12.1429,0.00309133,12.4694,0.00302618,12.7959,0.00297582,13.1224,0.00294655,13.449,0.00292597,13.7755,0.00290887,14.102,0.00289415,14.4286,0.00288068,14.7551,0.00286735,15.0816,0.00285303,15.4082,0.0028373,15.7347,0.00282094,16.0612,0.00280488,16.3878,0.00279006,16.7143,0.00277739,17.0408,0.00276778,17.3673,0.00276012,17.6939,0.00275348,18.0204,0.00274806,18.3469,0.00274403,18.6735,0.00274159,19,0.0027409)}
.func g2(vgs) {table(vgs,3,0.155802,3.32653,0.160596,3.65306,0.164229,3.97959,0.166393,4.30612,0.166782,4.63265,0.16509,4.95918,0.16101,5.28571,0.152619,5.61224,0.138902,5.93878,0.122701,6.26531,0.106899,6.59184,0.094379,6.91837,0.0880242,7.2449,0.0881787,7.57143,0.0897914,7.89796,0.0921127,8.22449,0.0946394,8.55102,0.0968686,8.87755,0.0982974,9.20408,0.0987573,9.53061,0.0991726,9.85714,0.0995377,10.1837,0.0997354,10.5102,0.0996488,10.8367,0.0991607,11.1633,0.0981188,11.4898,0.0963071,11.8163,0.0938619,12.1429,0.0909673,12.4694,0.0878075,12.7959,0.0845665,13.1224,0.0813712,13.449,0.0778139,13.7755,0.073945,14.102,0.0699761,14.4286,0.0661188,14.7551,0.0625848,15.0816,0.0595704,15.4082,0.0568869,15.7347,0.0543892,16.0612,0.0520481,16.3878,0.0498341,16.7143,0.047718,17.0408,0.04567,17.3673,0.0436511,17.6939,0.0416633,18.0204,0.0397278,18.3469,0.0378656,18.6735,0.0360978,19,0.0344457)}
.func n2(vgs) {table(vgs,3,0.170115,3.32653,0.138132,3.65306,0.116796,3.97959,0.107788,4.30612,0.112787,4.63265,0.133474,4.95918,0.171529,5.28571,0.244185,5.61224,0.362362,5.93878,0.50164,6.26531,0.637211,6.59184,0.74427,6.91837,0.798009,7.2449,0.795949,7.57143,0.782408,7.89796,0.763253,8.22449,0.742172,8.55102,0.722849,8.87755,0.708971,9.20408,0.701793,9.53061,0.694604,9.85714,0.687401,10.1837,0.68099,10.5102,0.676175,10.8367,0.673761,11.1633,0.674591,11.4898,0.679165,11.8163,0.686992,12.1429,0.697486,12.4694,0.710064,12.7959,0.724138,13.1224,0.739569,13.449,0.759939,13.7755,0.78449,14.102,0.811135,14.4286,0.837784,14.7551,0.862347,15.0816,0.882825,15.4082,0.89987,15.7347,0.91498,16.0612,0.929146,16.3878,0.943358,16.7143,0.958606,17.0408,0.975869,17.3673,0.994799,17.6939,1.01474,18.0204,1.0356,18.3469,1.05728,18.6735,1.07969,19,1.10273)}
.func l2(vgs) {table(vgs,3,0.00516973,3.32653,0.0046871,3.65306,0.00420079,3.97959,0.00375217,4.30612,0.00338262,4.63265,0.00313352,4.95918,0.00304625,5.28571,0.00309628,5.61224,0.00318464,5.93878,0.00329109,6.26531,0.00339657,6.59184,0.00348201,6.91837,0.00352834,7.2449,0.00353641,7.57143,0.00354414,7.89796,0.00355082,8.22449,0.00355371,8.55102,0.00355007,8.87755,0.00353716,9.20408,0.00351419,9.53061,0.00348744,9.85714,0.00345846,10.1837,0.0034282,10.5102,0.00339762,10.8367,0.00336766,11.1633,0.00333871,11.4898,0.00330843,11.8163,0.00327754,12.1429,0.00324736,12.4694,0.00321919,12.7959,0.00319436,13.1224,0.00317484,13.449,0.003167,13.7755,0.00316798,14.102,0.00317262,14.4286,0.00317574,14.7551,0.00317217,15.0816,0.00315671,15.4082,0.00312618,15.7347,0.00308484,16.0612,0.00303828,16.3878,0.00299212,16.7143,0.00295196,17.0408,0.00292327,17.3673,0.00290096,17.6939,0.00288034,18.0204,0.00286222,18.3469,0.00284741,18.6735,0.00283671,19,0.00283094)}
.func g3(vgs) {table(vgs,3,0.164465,3.32653,0.193099,3.65306,0.221525,3.97959,0.246883,4.30612,0.266312,4.63265,0.276953,4.95918,0.275945,5.28571,0.262517,5.61224,0.241104,5.93878,0.215642,6.26531,0.190044,6.59184,0.168223,6.91837,0.154091,7.2449,0.148299,7.57143,0.144454,7.89796,0.141583,8.22449,0.139029,8.55102,0.136135,8.87755,0.132242,9.20408,0.127045,9.53061,0.121522,9.85714,0.115856,10.1837,0.110119,10.5102,0.104383,10.8367,0.09872,11.1633,0.0931472,11.4898,0.0874287,11.8163,0.0816593,12.1429,0.0759936,12.4694,0.0705861,12.7959,0.0655914,13.1224,0.0611298,13.449,0.0569613,13.7755,0.0530305,14.102,0.0493691,14.4286,0.0460084,14.7551,0.04298,15.0816,0.0403055,15.4082,0.0377991,15.7347,0.0354013,16.0612,0.0331406,16.3878,0.031046,16.7143,0.0291459,17.0408,0.027467,17.3673,0.0258691,17.6939,0.0242963,18.0204,0.0228069,18.3469,0.0214586,18.6735,0.0203097,19,0.019418)}
.func n3(vgs) {table(vgs,3,1.00859,3.32653,0.816437,3.65306,0.624854,3.97959,0.451402,4.30612,0.313646,4.63265,0.229147,4.95918,0.215468,5.28571,0.277248,5.61224,0.386472,5.93878,0.517871,6.26531,0.646326,6.59184,0.746721,6.91837,0.793939,7.2449,0.784282,7.57143,0.760637,7.89796,0.730608,8.22449,0.699739,8.55102,0.673573,8.87755,0.657654,9.20408,0.653676,9.53061,0.650692,9.85714,0.648388,10.1837,0.647727,10.5102,0.649672,10.8367,0.655187,11.1633,0.665026,11.4898,0.678285,11.8163,0.694169,12.1429,0.712021,12.4694,0.731188,12.7959,0.751014,13.1224,0.770988,13.449,0.792059,13.7755,0.814288,14.102,0.837361,14.4286,0.860965,14.7551,0.884785,15.0816,0.908534,15.4082,0.932541,15.7347,0.956933,16.0612,0.981613,16.3878,1.00649,16.7143,1.03146,17.0408,1.05644,17.3673,1.08148,17.6939,1.10663,18.0204,1.13191,18.3469,1.1573,18.6735,1.1828,19,1.20842)}
.func l3(vgs) {table(vgs,3,0.00382164,3.32653,0.00373452,3.65306,0.00364789,3.97959,0.00356681,4.30612,0.00349634,4.63265,0.00344153,4.95918,0.00340745,5.28571,0.00338889,5.61224,0.00337193,5.93878,0.00335702,6.26531,0.00334475,6.59184,0.00333575,6.91837,0.00333065,7.2449,0.00333058,7.57143,0.00333577,7.89796,0.00334355,8.22449,0.00335117,8.55102,0.00335586,8.87755,0.00335487,9.20408,0.00334371,9.53061,0.00331694,9.85714,0.00327973,10.1837,0.00323808,10.5102,0.00319801,10.8367,0.00316551,11.1633,0.00314437,11.4898,0.00312542,11.8163,0.00310767,12.1429,0.00309209,12.4694,0.00307967,12.7959,0.00307142,13.1224,0.00306787,13.449,0.00306526,13.7755,0.00306273,14.102,0.00306061,14.4286,0.00305921,14.7551,0.00305886,15.0816,0.00305983,15.4082,0.00306133,15.7347,0.00306295,16.0612,0.00306466,16.3878,0.00306643,16.7143,0.00306825,17.0408,0.00307008,17.3673,0.00307194,17.6939,0.00307382,18.0204,0.00307574,18.3469,0.00307768,18.6735,0.00307967,19,0.00308169)}


****************************************
G2 d1 s value {
+	if(V(d3,s)<=0,
+		if (V(gk)<=V(NET3),
+		0
+		,
+		-drain_current(V(gk),V(s,d3),V(NET3),gain(V(gk),V(Tjc)),nval(V(gk),V(Tjc)),lam(V(gk),V(Tjc)))
+		)
+		,
+		if (V(gk)<=V(NET3),
+		0
+		,
+		drain_current(V(gk),V(d3,s),V(NET3),gain(V(gk),V(Tjc)),nval(V(gk),V(Tjc)),lam(V(gk),V(Tjc)))
+		)
+			)
+			}
****************************************
.param k1=699.33p
.param k2=0.359866
.param ka=2397.706
.param kb=0.13563
.param kc=3.164102

G11 g1 d11 value {
+		k1*(
+		(1+(rdlim(v(d3,g1),0.1,270,0.01))*(1+ka*(1+TANH(kb*V(d3,g1)-kc))/2))**(-k2)
+		)*ddt(v(g1,d3))
+			} Rpar=1Meg
R_CGD d11 d3 1E-4


.param Cjo = 957p
.param Vj  = 2.14
.param Ma   = 0.54

G12 d12 s value {
+		(Cjo/(1+(rdlim(v(d3,s),0.1,270,0.01)/Vj)**M))*ddt(v(d3,s))
+			} Rpar=1Meg
R_CDS d12 d3 1E-4

****************************************


.ends C3M0060065K

****************************************

