**************************************************************************************************************************************************************************************************
*
*  888888              888888               888888  .o888888888888o.    8888         88888888888  o888888888888888   88888888888888o   88888888888  88888888888  8888888888o
*   88888             88888888             88888   .8888888  8888888.   8888         88888888888  o8888888888888888  888888  8888888o  88888888888  88888888888  88888888888o
*    88888           8888  8888           88888   .8888888.  .8888888.  8888         8888         888888888          888888  88888888  8888         8888         8888   88888
*     88888         8888    8888         88888    88888888    88888888  8888         8888         888888888          888888  88888888  8888         8888         8888   88888
*      88888       8888      8888       88888     88888888    88888888  8888         8888888      o888888888888888o  888888  8888888o  8888888      8888888      8888   88888
*       88888     8888        8888     88888      88888888    88888888  8888         8888888      o888888888888888o  88888888888888o   8888888      8888888      8888   88888
*        88888   8888          8888   88888       88888888    88888888  8888         8888                  88888888  8888              8888         8888         8888   88888
*         88888 8888            8888 88888        .8888888.  .8888888.  8888         8888                  88888888  8888              8888         8888         8888   88888
*          88888888             88888888           .8888888  8888888.   88888888888  8888         8888888888888888o  8888              88888888888  88888888888  88888888888o
*           888888               888888             .o888888888888o.    88888888888  8888         888888888888888o   8888              88888888888  88888888888  8888888888o
*
**************************************************************************************************************************************************************************************************
*******************************************************************************
**	DISCLAIMER
*******************************************************************************
**	This model is provided as is, where is, and with no warranty of any kind
**	either expressed or implied, including but not rdlimed to any implied
**	warranties of merchantability and fitness for a particular purpose.
*******************************************************************************

***********************************************************
****	Wolfspeed SiC MOSFET E3M0160120D Spice Library
****	Revision 1.0 Date: 10-06-2023
***********************************************************
****	Revision record
****	Revision 1	Initial Release
*********************************************************************************
****Parasitics Included
****Tj = Junction Temperature
****Tc = Case Temperature
****D = Drain
****G = Gate
****S1 = Kelvin Source
****S2 = Power Source
***********************************************************

.subckt E3M0160120D d g s1 Tj Tc

* Put in specified Rgint
.param Rgint = 2.6

Ci_d d 0 1p Rpar=1G
Ci_g	g 0 1p Rpar=1G
Ci_s1 s1 0 1p Rpar=1G
Ci_Tj Tj 0 1p Rpar=1G
Ci_Tc Tc 0 1p Rpar=1G

.func rdlim(x,n,p,z) {
+	uplim(dnlim(x,n,z),p,z)
+}

R1022	Tjc	0	1E6
E1022	Tjc	0 	value {rdlim(v(Tj),-55,260,0.1)}

R100	gk	0	1E6
E100	gk	0 	value {rdlim(v(g1,s),-4,19,0.1)}


e33	NET3	0	Value {rdlim(14.1055u*V(Tjc)**2+-6.7653m*V(Tjc)+3.1415,-3.5,3.5,0.01)}
R_cc	NET3	0 	1E6

Ls1 		s1	s	5.17n Rser=10.11m
R_Ls1 		s1	s  	100


R_gg 		g1	s	1E6
R_g 		g1	g2	{Rgint}
Lg 			g	g2	7.7n Rser=13.255m
R_Lg 		g	g2	100

Ld 		d	d3	4.366n Rser=87.416u
R_Ld		d	d3	100

Ed		Id	0	value {I(Rdrain_s)}
Rdd		Id	0	1E6

Rdrain_s	d3	d1	10u
Cdrs		d3	d1	10p
Gheat		0	Tj	value = {abs((V(d1,s)*v(Id)))+abs((V(g1,g2)**2/Rgint))}
CGS		g1	s	730p Rpar=100k

* Body Diode Implementation
.func rbody(vgs,t) {table(t,-40,r1(vgs),25,r2(vgs),175,r3(vgs))}
.func r1(vgs) {table(vgs,-4,84.5m,-2,87.1m,0,98.2m,5,100m,10,120m,15,160m)}
.func r2(vgs) {table(vgs,-4,85.1m,-2,91.3m,0,104.4m,5,100m,10,135m,15,165m)}
.func r3(vgs) {table(vgs,-4,40.23m,-2,43.644m,0,48.602m,5,110m,10,130m,15,160m)}

.func nd(vgs,t) {table(t,-40,nd_n40(vgs),25,nd_25(vgs),175,nd_175(vgs))}
.func nd_n40(vgs) {table(vgs,-4,354.1m,-2,324.4m,0,273.1m,5,40m,10,10m,15,1m)}
.func nd_25(vgs) {table(vgs,-4,315.1m,-2,285.8m,0,239.5m,5,55m,10,35m,15,20m)}
.func nd_175(vgs) {table(vgs,-4,280.4m,-2,256.8m,0,228.8m,5,40m,10,10m,15,1m)}

Rbd d1 dd2 R = rbody(V(gk),V(Tjc))
GITQ s dd2 value {uplim(1u*(-1+exp(V(s,dd2)/(V(ND)))),1e4,1m)}

Ef	ND	0	value {rdlim(nd(V(gk),V(Tjc)),1m,320m,0.01)}
Rf	ND	0	10Meg	


CDS1		dd2	s	1p
CGD1		g1	d3	1p
R_DS1		dd2	s	0.5G


R0 N1 Tj 265.5m
R1 N2 N1 548.5m
R2 N3 N2 173.4m
R3 Tc N3 18.96m

C0 Tj 0 502.2u
C1 N1 0 3.223m
C2 N2 0 27.53m
C3 N3 0 34.61m

****************************************
.func gain(vgs,t) {
+	table(t,-40,g1(vgs),25,g2(vgs),175,g3(vgs))
+}

.func nval(vgs,t) {
+	table(t,-40,n1(vgs),25,n2(vgs),175,n3(vgs))
+}

.func lam(vgs,t) {
+	table(t,-40,l1(vgs),25,l2(vgs),175,l3(vgs))
+}

.func drain_current(vgs,vds,vth,g,n,l) {
+	g*(vgs-vth)*(log(1+exp(vgs-vth))**2 - log(1+exp(vgs-vth-n*vds))**2)*(1+l*vds)
+}

.func g1(vgs) {table(vgs,3,0.0490106,3.32653,0.0422107,3.65306,0.0353816,3.97959,0.0290445,4.30612,0.0237209,4.63265,0.019932,4.95918,0.0181994,5.28571,0.0180234,5.61224,0.0180053,5.93878,0.0181439,6.26531,0.0184574,6.59184,0.018964,6.91837,0.0196818,7.2449,0.0205875,7.57143,0.0215703,7.89796,0.0225913,8.22449,0.0236156,8.55102,0.0246083,8.87755,0.0255346,9.20408,0.0263892,9.53061,0.0272484,9.85714,0.0280866,10.1837,0.0288673,10.5102,0.0295538,10.8367,0.0301098,11.1633,0.0305042,11.4898,0.03075,11.8163,0.0308574,12.1429,0.0308328,12.4694,0.0306827,12.7959,0.0304135,13.1224,0.0300209,13.449,0.0294125,13.7755,0.0286066,14.102,0.0276542,14.4286,0.0266063,14.7551,0.0255141,15.0816,0.0244198,15.4082,0.0231894,15.7347,0.0218241,16.0612,0.0204072,16.3878,0.0190221,16.7143,0.0177522,17.0408,0.0166788,17.3673,0.0157148,17.6939,0.0147954,18.0204,0.0139482,18.3469,0.0132012,18.6735,0.0125819,19,0.0121182)}
.func n1(vgs) {table(vgs,3,0.827357,3.32653,0.745349,3.65306,0.663671,3.97959,0.590223,4.30612,0.532901,4.63265,0.499605,4.95918,0.498233,5.28571,0.532561,5.61224,0.5916,5.93878,0.662181,6.26531,0.731163,6.59184,0.785406,6.91837,0.81177,7.2449,0.809925,7.57143,0.805005,7.89796,0.798781,8.22449,0.791742,8.55102,0.78438,8.87755,0.777185,9.20408,0.770371,9.53061,0.763286,9.85714,0.756079,10.1837,0.748994,10.5102,0.742274,10.8367,0.736162,11.1633,0.731009,11.4898,0.727572,11.8163,0.725854,12.1429,0.725736,12.4694,0.7271,12.7959,0.729824,13.1224,0.734162,13.449,0.74349,13.7755,0.757617,14.102,0.775245,14.4286,0.795074,14.7551,0.815807,15.0816,0.836269,15.4082,0.858053,15.7347,0.881589,16.0612,0.906257,16.3878,0.931441,16.7143,0.95652,17.0408,0.980886,17.3673,1.00484,17.6939,1.02879,18.0204,1.05274,18.3469,1.07669,18.6735,1.10063,19,1.12458)}
.func l1(vgs) {table(vgs,3,0.0160607,3.32653,0.0147207,3.65306,0.0133628,3.97959,0.0120985,4.30612,0.0110393,4.63265,0.010297,4.95918,0.00998321,5.28571,0.00998799,5.61224,0.0100032,5.93878,0.0100216,6.26531,0.0100399,6.59184,0.010055,6.91837,0.0100639,7.2449,0.0100668,7.57143,0.0100699,7.89796,0.0100731,8.22449,0.0100759,8.55102,0.0100776,8.87755,0.0100777,9.20408,0.0100747,9.53061,0.0100652,9.85714,0.0100497,10.1837,0.0100289,10.5102,0.0100036,10.8367,0.00997473,11.1633,0.0099396,11.4898,0.00988188,11.8163,0.00980732,12.1429,0.00972544,12.4694,0.00964574,12.7959,0.00957774,13.1224,0.0095288,13.449,0.00948403,13.7755,0.00944118,14.102,0.00940354,14.4286,0.00937441,14.7551,0.00935708,15.0816,0.00935434,15.4082,0.00935727,15.7347,0.00936114,16.0612,0.00936547,16.3878,0.00936974,16.7143,0.00937348,17.0408,0.00937621,17.3673,0.00937857,17.6939,0.00938106,18.0204,0.0093835,18.3469,0.00938575,18.6735,0.00938763,19,0.00938899)}
.func g2(vgs) {table(vgs,3,2,3.32653,1.56698,3.65306,1.12798,3.97959,0.719003,4.30612,0.376049,4.63265,0.135125,4.95918,0.0322371,5.28571,0.0310613,5.61224,0.0313611,5.93878,0.0317363,6.26531,0.0321691,6.59184,0.0326415,6.91837,0.0331358,7.2449,0.0336464,7.57143,0.0341842,7.89796,0.0347285,8.22449,0.0352572,8.55102,0.0357482,8.87755,0.0361796,9.20408,0.0365215,9.53061,0.0367357,9.85714,0.0368262,10.1837,0.0368001,10.5102,0.0366647,10.8367,0.0364273,11.1633,0.0360612,11.4898,0.0353967,11.8163,0.0344739,12.1429,0.0333699,12.4694,0.0321617,12.7959,0.0309264,13.1224,0.0297223,13.449,0.0284234,13.7755,0.0270312,14.102,0.0255968,14.4286,0.0241718,14.7551,0.0228075,15.0816,0.0215501,15.4082,0.0203316,15.7347,0.0191328,16.0612,0.0179781,16.3878,0.016892,16.7143,0.0158987,17.0408,0.0150216,17.3673,0.0142008,17.6939,0.0134089,18.0204,0.0126719,18.3469,0.0120155,18.6735,0.0114656,19,0.0110481)}
.func n2(vgs) {table(vgs,3,0.496847,3.32653,0.494782,3.65306,0.499805,3.97959,0.51122,4.30612,0.528335,4.63265,0.550456,4.95918,0.576888,5.28571,0.618381,5.61224,0.68477,5.93878,0.762511,6.26531,0.837797,6.59184,0.896816,6.91837,0.92576,7.2449,0.922424,7.57143,0.909858,7.89796,0.891999,8.22449,0.871671,8.55102,0.851695,8.87755,0.834893,9.20408,0.822313,9.53061,0.809276,9.85714,0.79613,10.1837,0.783817,10.5102,0.773278,10.8367,0.765456,11.1633,0.761434,11.4898,0.762344,11.8163,0.767591,12.1429,0.776365,12.4694,0.78786,12.7959,0.801265,13.1224,0.816126,13.449,0.835185,13.7755,0.858169,14.102,0.883794,14.4286,0.910771,14.7551,0.937816,15.0816,0.963735,15.4082,0.989594,15.7347,1.01596,16.0612,1.04265,16.3878,1.06949,16.7143,1.09631,17.0408,1.12293,17.3673,1.14944,17.6939,1.17595,18.0204,1.20246,18.3469,1.22899,18.6735,1.25551,19,1.28204)}
.func l2(vgs) {table(vgs,3,0.0103056,3.32653,0.0100276,3.65306,0.0097495,3.97959,0.00949155,4.30612,0.00927408,4.63265,0.00911742,4.95918,0.00904187,5.28571,0.00903667,5.61224,0.00905395,5.93878,0.00908162,6.26531,0.00910811,6.59184,0.00912188,6.91837,0.00911137,7.2449,0.00907374,7.57143,0.00902684,7.89796,0.00897582,8.22449,0.00892504,8.55102,0.00887884,8.87755,0.00884156,9.20408,0.00881644,9.53061,0.00880013,9.85714,0.00878893,10.1837,0.00877935,10.5102,0.00876791,10.8367,0.00875112,11.1633,0.00872535,11.4898,0.00868943,11.8163,0.00864794,12.1429,0.00860596,12.4694,0.0085686,12.7959,0.00854094,13.1224,0.00852684,13.449,0.0085169,13.7755,0.00850839,14.102,0.00850172,14.4286,0.0084973,14.7551,0.00849556,15.0816,0.00849681,15.4082,0.00849934,15.7347,0.00850221,16.0612,0.0085052,16.3878,0.00850811,16.7143,0.00851072,17.0408,0.00851284,17.3673,0.00851476,17.6939,0.00851671,18.0204,0.00851859,18.3469,0.00852032,18.6735,0.00852182,19,0.008523)}
.func g3(vgs) {table(vgs,3,0.0886076,3.32653,0.0848031,3.65306,0.0810759,3.97959,0.0775628,4.30612,0.0744004,4.63265,0.0717255,4.95918,0.0696748,5.28571,0.0682123,5.61224,0.0670478,5.93878,0.066057,6.26531,0.0651183,6.59184,0.0641103,6.91837,0.0629113,7.2449,0.0614987,7.57143,0.0600412,7.89796,0.0585218,8.22449,0.0569135,8.55102,0.0551893,8.87755,0.0533222,9.20408,0.051244,9.53061,0.0488363,9.85714,0.0461983,10.1837,0.0434471,10.5102,0.0407002,10.8367,0.0380748,11.1633,0.0356407,11.4898,0.0332086,11.8163,0.0307944,12.1429,0.0284592,12.4694,0.026264,12.7959,0.0242701,13.1224,0.0225208,13.449,0.0208827,13.7755,0.0193357,14.102,0.0179061,14.4286,0.0166205,14.7551,0.0155052,15.0816,0.014581,15.4082,0.0137448,15.7347,0.0129545,16.0612,0.012217,16.3878,0.0115392,16.7143,0.010928,17.0408,0.0103896,17.3673,0.00987357,17.6939,0.00936082,18.0204,0.00887204,18.3469,0.00842785,18.6735,0.00804888,19,0.00775577)}
.func n3(vgs) {table(vgs,3,0.307799,3.32653,0.333551,3.65306,0.362991,3.97959,0.395372,4.30612,0.429951,4.63265,0.465983,4.95918,0.502723,5.28571,0.546058,5.61224,0.601543,5.93878,0.661321,6.26531,0.717378,6.59184,0.761702,6.91837,0.786282,7.2449,0.784371,7.57143,0.759746,7.89796,0.721388,8.22449,0.678316,8.55102,0.639547,8.87755,0.614102,9.20408,0.605769,9.53061,0.600242,9.85714,0.596512,10.1837,0.595257,10.5102,0.597153,10.8367,0.60288,11.1633,0.612836,11.4898,0.625586,11.8163,0.640397,12.1429,0.656765,12.4694,0.674187,12.7959,0.692159,13.1224,0.710283,13.449,0.729236,13.7755,0.749063,14.102,0.769532,14.4286,0.790413,14.7551,0.811477,15.0816,0.832514,15.4082,0.853814,15.7347,0.875448,16.0612,0.897299,16.3878,0.919246,16.7143,0.941172,17.0408,0.962958,17.3673,0.984663,17.6939,1.00637,18.0204,1.02807,18.3469,1.04977,18.6735,1.07146,19,1.09316)}
.func l3(vgs) {table(vgs,3,0.00827514,3.32653,0.00830079,3.65306,0.00832558,3.97959,0.00834915,4.30612,0.00837113,4.63265,0.00839115,4.95918,0.00840884,5.28571,0.00842444,5.61224,0.00843871,5.93878,0.00845155,6.26531,0.00846287,6.59184,0.00847258,6.91837,0.00848056,7.2449,0.00848473,7.57143,0.00848076,7.89796,0.00846959,8.22449,0.00845238,8.55102,0.00843032,8.87755,0.00840456,9.20408,0.00836812,9.53061,0.00829723,9.85714,0.00820299,10.1837,0.00809975,10.5102,0.00800188,10.8367,0.0079237,11.1633,0.00787434,11.4898,0.00783187,11.8163,0.00779309,12.1429,0.00775955,12.4694,0.00773277,12.7959,0.00771427,13.1224,0.00770475,13.449,0.00769685,13.7755,0.00768907,14.102,0.0076822,14.4286,0.00767701,14.7551,0.00767428,15.0816,0.00767467,15.4082,0.00767634,15.7347,0.00767824,16.0612,0.00768021,16.3878,0.0076821,16.7143,0.00768375,17.0408,0.007685,17.3673,0.00768611,17.6939,0.00768725,18.0204,0.00768835,18.3469,0.00768934,18.6735,0.00769016,19,0.00769074)}


****************************************
G2 d1 s value {
+	if(V(d3,s)<=0,
+		if (V(gk)<=V(NET3),
+		0
+		,
+		-drain_current(V(gk),V(s,d3),V(NET3),gain(V(gk),V(Tjc)),nval(V(gk),V(Tjc)),lam(V(gk),V(Tjc)))
+		)
+		,
+		if (V(gk)<=V(NET3),
+		0
+		,
+		drain_current(V(gk),V(d3,s),V(NET3),gain(V(gk),V(Tjc)),nval(V(gk),V(Tjc)),lam(V(gk),V(Tjc)))
+		)
+			)
+			}
****************************************
.param k1=699.33p
.param k2=0.35987
.param ka=2397.706
.param kb=0.13563
.param kc=3.1641

G11 g1 d11 value {
+		k1*(
+		(1+(rdlim(v(d3,g1),0.1,270,0.01))*(1+ka*(1+TANH(kb*V(d3,g1)-kc))/2))**(-k2)
+		)*ddt(v(g1,d3))
+			} Rpar=1Meg
R_CGD d11 d3 1E-4


.param Cjo = 957.6p
.param Vj  = 2.14
.param M   = 0.55

G12 d12 s value {
+		(Cjo/(1+(rdlim(v(d3,s),0.1,270,0.01)/Vj)**M))*ddt(v(d3,s))
+			} Rpar=1Meg
R_CDS d12 d3 1E-4

****************************************


.ends E3M0160120D

****************************************

