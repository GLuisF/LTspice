******************************************************************************************************************************************************************************
*
*  888888              888888               888888  .o888888888888o.    8888         88888888888  o888888888888888   88888888888888o   88888888888  88888888888  8888888888o
*   88888             88888888             88888   .8888888  8888888.   8888         88888888888  o8888888888888888  888888  8888888o  88888888888  88888888888  88888888888o
*    88888           8888  8888           88888   .8888888.  .8888888.  8888         8888         888888888          888888  88888888  8888         8888         8888   88888
*     88888         8888    8888         88888    88888888    88888888  8888         8888         888888888          888888  88888888  8888         8888         8888   88888
*      88888       8888      8888       88888     88888888    88888888  8888         8888888      o888888888888888o  888888  8888888o  8888888      8888888      8888   88888
*       88888     8888        8888     88888      88888888    88888888  8888         8888888      o888888888888888o  88888888888888o   8888888      8888888      8888   88888
*        88888   8888          8888   88888       88888888    88888888  8888         8888                  88888888  8888              8888         8888         8888   88888
*         88888 8888            8888 88888        .8888888.  .8888888.  8888         8888                  88888888  8888              8888         8888         8888   88888
*          88888888             88888888           .8888888  8888888.   88888888888  8888         8888888888888888o  8888              88888888888  88888888888  88888888888o
*           888888               888888             .o888888888888o.    88888888888  8888         888888888888888o   8888              88888888888  88888888888  8888888888o
*
******************************************************************************************************************************************************************************

*******************************************************************************
**	Wolfspeed, Inc
**	DISCLAIMER
*******************************************************************************
**	This model is provided as is, where is, and with no warranty of any kind
**	either expressed or implied, including but not limited to any implied
**	warranties of merchantability and fitness for a particular purpose.
*******************************************************************************
**	To find other WOLFSPEED SiC models, please visit:
**	https://www.wolfspeed.com/power/tools-and-support/all-models
*******************************************************************************
**	This library model file is intended for use in LTspice ONLY
**	Use in any other software will result in syntax or compilation errors!
*******************************************************************************

*********************************************************************
****	
****	Wolfspeed SiC Module Six-Pack SPICE Library
****		Version 1.3	Date: 2023-09-05
****	
****		Models avilable in this library:
****		CCB021M12FM3,CCB032M12FM3,CCB016M12GM3
****	
*********************************************************************
**** Six Pack Module Layout ****
****  DC+1--DC+2--DC+3 ****
****   Q1    Q3    Q5 ****
****   Q2    Q4    Q6 ****
****  DC-1  DC-2   DC-3 ****
****  DC+1 / DC+2 / DC+3 are connected internally
****  DC-1 / DC-2 / DC-3 are disconnected internally
****	
****	Node Definitions:
****		Electrical
****		DC+1  = Q1 Drain (Phase 1)
****		DC+2  = Q3 Drain (Phase 2)
****		DC+3  = Q5 Drain (Phase 3)
****		DC-1  = Q2 source (Phase 1)
****		DC-2  = Q4 source (Phase 2)
****		DC-3  = Q6 source (Phase 3)
****		U     = AC terminal (Phase 1)
****		V     = AC terminal (Phase 2)
****		W     = AC terminal (Phase 3)
****		Gn    = Qn Gate
****		Kn    = Qn Kelvin
****		TjQn  = Qn Junction Temperature
****		TcQn  = Qn Case Thermal Connection [apply coolant temperature as a voltage]
****		Electrical (EMI)
****		Baseplate = Node for studying current induced 
****					through heatsink into grounding system
*********************************************************************
****	Model Complexity Control:
****		BPC      = enable basepalte capacitance
****					0: no BPC (zero current on Baseplate node)
****					1: Include BPC (slower)
****		Thermals = enable closed loop thermals
****					0: Fixed Tj defined by TEMP
****					1: Include BPC (slower)
****		level    = change the complexity / accuracy of the model
****					1: Body diode at -4V only
****					2: Full third quadrant conduction
****					3: Full third quadrant conduction with reverse recovery
****	Parameter Definitions:
****		Vths = Threshold voltage shift (V)
****		Rdss = Drain Resistance shift (Ω)
****		Rp   = Inductor parallel res (Ω)
****				low pass filter on ringing
****				100 (default) good balance of bandwidth and sim-time
****				1m   removes impact of packaging but greatly improves sim time
*********************************************************************



.SUBCKT Module_SixPack DC+1 DC+2 DC+3 DC-1 DC-2 DC-3 U V W G1 G2 G3 G4 G5 G6 K1 K2 K3 K4 K5 K6 TjQ1 TjQ2 TjQ3 TjQ4 TjQ5 TjQ6 TcQ1 TcQ2 TcQ3 TcQ4 TcQ5 TcQ6 Baseplate

*** SiC MOSFETS ***
* High Side *
XDie_Electrical_Q1 DQ1 GQ1 SQ1 TjQ1 IQ1 {die} PARAMS: AF={AFm} Vths={Vths} Rdss={Rdss} Cgd_Module={CgdOffseth} dummy=1m
XDie_Electrical_Q3 DQ3 GQ3 SQ3 TjQ3 IQ3 {die} PARAMS: AF={AFm} Vths={Vths} Rdss={Rdss} Cgd_Module={CgdOffseth} dummy=1m
XDie_Electrical_Q5 DQ5 GQ5 SQ5 TjQ5 IQ5 {die} PARAMS: AF={AFm} Vths={Vths} Rdss={Rdss} Cgd_Module={CgdOffseth} dummy=1m

* Low Side *
XDie_Electrical_Q2 SQ1 GQ2 SQ2 TjQ2 IQ2 {die} PARAMS: AF={AFm} Vths={Vths} Rdss={Rdss} Cgd_Module={CgdOffsetl} dummy=1m
XDie_Electrical_Q4 SQ3 GQ4 SQ4 TjQ4 IQ4 {die} PARAMS: AF={AFm} Vths={Vths} Rdss={Rdss} Cgd_Module={CgdOffsetl} dummy=1m
XDie_Electrical_Q6 SQ5 GQ6 SQ6 TjQ6 IQ6 {die} PARAMS: AF={AFm} Vths={Vths} Rdss={Rdss} Cgd_Module={CgdOffsetl} dummy=1m

*** Thermal Networks ***
* High Side *
XDie_Thermal_Q1 TjQ1 TcQ1 DQ1 SQ1 IQ1 {Thermal} PARAMS: Ct1={Ct1} Ct2={Ct2} Ct3={Ct3} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Tj={Tj}
XDie_Thermal_Q3 TjQ3 TcQ3 DQ3 SQ3 IQ3 {Thermal} PARAMS: Ct1={Ct1} Ct2={Ct2} Ct3={Ct3} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Tj={Tj}
XDie_Thermal_Q5 TjQ5 TcQ5 DQ5 SQ5 IQ5 {Thermal} PARAMS: Ct1={Ct1} Ct2={Ct2} Ct3={Ct3} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Tj={Tj}
* Low Side *
XDie_Thermal_Q2 TjQ2 TcQ2 SQ1 SQ2 IQ2 {Thermal} PARAMS: Ct1={Ct1} Ct2={Ct2} Ct3={Ct3} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Tj={Tj}
XDie_Thermal_Q4 TjQ4 TcQ4 SQ3 SQ4 IQ4 {Thermal} PARAMS: Ct1={Ct1} Ct2={Ct2} Ct3={Ct3} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Tj={Tj}
XDie_Thermal_Q6 TjQ6 TcQ6 SQ5 SQ6 IQ6 {Thermal} PARAMS: Ct1={Ct1} Ct2={Ct2} Ct3={Ct3} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Tj={Tj}

*** Baseplate Capacitance ***
XBPC DQ1 DQ2 DQ3 SQ1 SQ2 SQ3 SQ2 SQ4 SQ6 Baseplate {BPC} PARAMS: Cu1g={Cu1g} Cu2g={Cu2g} CA1G={CA1G} CA2G={CA2G} CA3G={CA3G} CL1G={CL1G} CL2G={CL2G} CL3G={CL3G}

*** Parasitic Parameters ***
LP1D DC+1 DQ1 {LP1D} Rser={Rdesr} Rpar={Rp}
LP2D DC+2 DQ3 {LP2D} Rser={Rdesr} Rpar={Rp}
LP3D DC+3 DQ5 {LP3D} Rser={Rdesr} Rpar={Rp}

LD1D2 DC+1 DC+2 {LD1D2} Rpar={RD1D2p} Rser={RD1D2s}
LD2D3 DC+2 DC+3 {LD2D3} Rpar={RD2D3p} Rser={RD2D3s}
LP1P SQ1 U {LP1P} Rser={Rpesr} Rpar={Rp}
LP2P SQ3 V {LP2P} Rser={Rpesr} Rpar={Rp}
LP3P SQ5 W {LP3P} Rser={Rpesr} Rpar={Rp}

LP1S SQ2 DC-1 {LP1S} Rser={Rsesr} Rpar={Rp}
LP2S SQ4 DC-2 {LP2S} Rser={Rsesr} Rpar={Rp}
LP3S SQ6 DC-3 {LP3S} Rser={Rsesr} Rpar={Rp}

LQ1G G1 GQ1 {LgQ1/2} Rser={Rgi/2}
LQ2G G2 GQ2 {LgQ2/2} Rser={Rgi/2}
LQ3G G3 GQ3 {LgQ3/2} Rser={Rgi/2}
LQ4G G4 GQ4 {LgQ4/2} Rser={Rgi/2}
LQ5G G5 GQ5 {LgQ5/2} Rser={Rgi/2}
LQ6G G6 GQ6 {LgQ6/2} Rser={Rgi/2}

LQ1K K1 SQ1 {LgQ1/2} Rser={Rgi/2}
LQ2K K2 SQ2 {LgQ2/2} Rser={Rgi/2}
LQ3K K3 SQ3 {LgQ3/2} Rser={Rgi/2}
LQ4K K4 SQ4 {LgQ4/2} Rser={Rgi/2}
LQ5K K5 SQ5 {LgQ5/2} Rser={Rgi/2}
LQ6K K6 SQ6 {LgQ6/2} Rser={Rgi/2}

.ENDS Module_SixPack

*** SUBCKT 1/2/3: BPC ***
.SUBCKT 1 DQ1 DQ2 DQ3 SQ1 SQ3 SQ5 SQ2 SQ4 SQ6 Baseplate
R Baseplate 0 1
.ENDS 1

.SUBCKT 2 DQ1 DQ2 DQ3 SQ1 SQ3 SQ5 SQ2 SQ4 SQ6 Baseplate
C1 DQ2 Baseplate {Cu1g}
C3 SQ1 Baseplate {CA1G}
C4 SQ3 Baseplate {CA2G}
C5 SQ5 Baseplate {CA3G}
C6 SQ2 Baseplate {CL1G}
C7 SQ4 Baseplate {CL2G}
C8 SQ6 Baseplate {CL3G}
.ENDS 2
 
.SUBCKT 3 DQ1 DQ2 DQ3 SQ1 SQ3 SQ5 SQ2 SQ4 SQ6 Baseplate
C1 DQ1 Baseplate {Cu1g}
C2 DQ3 Baseplate {Cu2g}
C3 SQ1 Baseplate {CA1G}
C4 SQ3 Baseplate {CA2G}
C5 SQ5 Baseplate {CA3G}
C6 SQ2 Baseplate {CL1G}
C7 SQ4 Baseplate {CL2G}
C8 SQ6 Baseplate {CL3G}
.ENDS 3
 
*** SUBCKT 4/5: THERMALS ***
.SUBCKT 4 Tj Tc Vd Vs Vi PARAMS: Ct1=1 Ct2=1 Ct3=1 Rt1=1 Rt2=1 Rt3=1
Vt Tj1 0 {Tj}
Rt Tj1 Tj 1m
RTground Tc 0 10k
.ENDS 4

.SUBCKT 5 Tj Tc Vd Vs Vi PARAMS: Ct1=1 Ct2=1 Ct3=1 Rt1=1 Rt2=1 Rt3=1
Gpwr 0 Tj Value {abs(V(Vd,Vs)*(V(Vi)))}
Ct1 Tj 0 {Ct1}
Ct2 1 0 {Ct2}
Ct3 2 0 {Ct3}
Rt1 Tj 1 {Rt1}
Rt2 1 2 {Rt2}
Rt3 2 Tc {Rt3}
RTground Tc 0 10k
.ic V(Tj) = {Tj} V(1) = {Tj} V(2) = {Tj}
.ENDS 5
 
.SUBCKT CCB021M12FM3 DC+1 DC+2 DC+3 DC-1 DC-2 DC-3 U V W G1 G2 G3 G4 G5 G6 K1 K2 K3 K4 K5 K6 TjQ1 TjQ2 TjQ3 TjQ4 TjQ5 TjQ6 TcQ1 TcQ2 TcQ3 TcQ4 TcQ5 TcQ6 Baseplate
 
*** Default Parameters *** 
 
.param BPC=0 Thermals=1 level=3 Vths=0 Rdss=0 Rp=100 Tj={TEMP} Afm=1 AFnomM=1 die=10 LP1D=12.71n LP2D=11.12n LP3D=10.53n LP1S=5.74n LP2S=4.76n LP3S=4.62n LP1P=7.31n LP2P=8.30n LP3P=8.32n LD1D2=13.90n LD2D3=13.94n RD1D2p=100.00 RD2D3p=100.00 RD1D2s=100.00u RD2D3s=100.00u Rdesr=1.98m Rpesr=1.85m Rsesr=1.85m PackageRgi=0.00 DieRgi=3.30 CgdOffseth=5.00p CgdOffsetl=5.00p LgQ1=14.85n LgQ2=15.51n LgQ3=14.96n LgQ4=14.84n LgQ5=14.84n LgQ6=15.10n Cu1g=52.70p Cu2g=0.00 Ca1g=30.20p Ca2g=30.30p Ca3g=32.10p Cl1g=17.80p Cl2g=19.30p Cl3g=21.70p Rt1={AFnomM*13.81m/AFm} Rt2={AFnomM*127.56m/AFm} Rt3={AFnomM*886.38m/AFm} Ct1={AFm*322.56u/AFnomM} Ct2={AFm*6.96m/AFnomM} Ct3={AFm*58.29m/AFnomM}
 
*** Behavior Optimization *** 
 
.param RgiPerDie = {PackageRgi+DieRgi}
.param Rgi = {RgiPerDie/Afm}
.param BPCFlag = {if(Cu2g+0.5,2*BPC,BPC}
 
*** Module Subcircuit Call *** 
 
X1 DC+1 DC+2 DC+3 DC-1 DC-2 DC-3 U V W G1 G2 G3 G4 G5 G6 K1 K2 K3 K4 K5 K6 TjQ1 TjQ2 TjQ3 TjQ4 TjQ5 TjQ6 TcQ1 TcQ2 TcQ3 TcQ4 TcQ5 TcQ6 Baseplate Module_SixPack PARAMS: BPC = {BPCFlag+1} Thermal = {Thermals+3} die={die+level} CgdOffseth={CgdOffseth} CgdOffsetl={CgdOffsetl} Rdss={Rdss} Vths={Vths} AFm={AFm} Rp={Rp} Tj={Tj} LP1D={LP1D} LP2D={LP2D} LP3D={LP3D} LP1S={LP1S} LP2S={LP2S} LP3S={LP3S} LP1P={LP1P} LP2P={LP2P} LP3P={LP3P} LgQ1={LgQ1} LgQ2={LgQ2} LgQ3={LgQ3} LgQ4={LgQ4} LgQ5={LgQ5} LgQ6={LgQ6} LD1D2={LD1D2} LD2D3={LD2D3} RD1D2s={RD1D2s} RD2D3s={RD2D3s} RD1D2p={RD1D2p} RD2D3p={RD2D3p} Rdesr={Rdesr} Rpesr={Rpesr} Rsesr={Rsesr} Rgi={Rgi} Cu1g={Cu1g} Cu2g={Cu2g} Ca1g={Ca1g} Ca2g={Ca2g} Ca3g={Ca3g} Cl1g={Cl1g} Cl2g={Cl2g} Cl3g={Cl3g} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Ct1={Ct1} Ct2={Ct2} Ct3={Ct3}

.ENDS CCB021M12FM3

 
.SUBCKT CCB032M12FM3 DC+1 DC+2 DC+3 DC-1 DC-2 DC-3 U V W G1 G2 G3 G4 G5 G6 K1 K2 K3 K4 K5 K6 TjQ1 TjQ2 TjQ3 TjQ4 TjQ5 TjQ6 TcQ1 TcQ2 TcQ3 TcQ4 TcQ5 TcQ6 Baseplate
 
*** Default Parameters *** 
 
.param BPC=0 Thermals=1 level=3 Vths=0 Rdss=0 Rp=100 Tj={TEMP} Afm=1 AFnomM=1 die=20 LP1D=12.71n LP2D=11.12n LP3D=10.53n LP1S=5.74n LP2S=4.76n LP3S=4.62n LP1P=7.31n LP2P=8.30n LP3P=8.32n LD1D2=13.90n LD2D3=13.94n RD1D2p=100.00 RD2D3p=100.00 RD1D2s=100.00u RD2D3s=100.00u Rdesr=1.98m Rpesr=1.85m Rsesr=1.85m PackageRgi=0.00 DieRgi=1.70 CgdOffseth=5.00p CgdOffsetl=5.00p LgQ1=14.85n LgQ2=15.51n LgQ3=14.96n LgQ4=14.84n LgQ5=14.84n LgQ6=15.10n Cu1g=52.70p Cu2g=0.00 Ca1g=30.20p Ca2g=30.30p Ca3g=32.10p Cl1g=17.80p Cl2g=19.30p Cl3g=21.70p Rt1={AFnomM*21.66m/AFm} Rt2={AFnomM*200.07m/AFm} Rt3={AFnomM*977.18m/AFm} Ct1={AFm*272.74u/AFnomM} Ct2={AFm*5.01m/AFnomM} Ct3={AFm*46.64m/AFnomM}
 
*** Behavior Optimization *** 
 
.param RgiPerDie = {PackageRgi+DieRgi}
.param Rgi = {RgiPerDie/Afm}
.param BPCFlag = {if(Cu2g+0.5,2*BPC,BPC}
 
*** Module Subcircuit Call *** 
 
X1 DC+1 DC+2 DC+3 DC-1 DC-2 DC-3 U V W G1 G2 G3 G4 G5 G6 K1 K2 K3 K4 K5 K6 TjQ1 TjQ2 TjQ3 TjQ4 TjQ5 TjQ6 TcQ1 TcQ2 TcQ3 TcQ4 TcQ5 TcQ6 Baseplate Module_SixPack PARAMS: BPC = {BPCFlag+1} Thermal = {Thermals+3} die={die+level} CgdOffseth={CgdOffseth} CgdOffsetl={CgdOffsetl} Rdss={Rdss} Vths={Vths} AFm={AFm} Rp={Rp} Tj={Tj} LP1D={LP1D} LP2D={LP2D} LP3D={LP3D} LP1S={LP1S} LP2S={LP2S} LP3S={LP3S} LP1P={LP1P} LP2P={LP2P} LP3P={LP3P} LgQ1={LgQ1} LgQ2={LgQ2} LgQ3={LgQ3} LgQ4={LgQ4} LgQ5={LgQ5} LgQ6={LgQ6} LD1D2={LD1D2} LD2D3={LD2D3} RD1D2s={RD1D2s} RD2D3s={RD2D3s} RD1D2p={RD1D2p} RD2D3p={RD2D3p} Rdesr={Rdesr} Rpesr={Rpesr} Rsesr={Rsesr} Rgi={Rgi} Cu1g={Cu1g} Cu2g={Cu2g} Ca1g={Ca1g} Ca2g={Ca2g} Ca3g={Ca3g} Cl1g={Cl1g} Cl2g={Cl2g} Cl3g={Cl3g} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Ct1={Ct1} Ct2={Ct2} Ct3={Ct3}

.ENDS CCB032M12FM3

 
.SUBCKT CCB016M12GM3 DC+1 DC+2 DC+3 DC-1 DC-2 DC-3 U V W G1 G2 G3 G4 G5 G6 K1 K2 K3 K4 K5 K6 TjQ1 TjQ2 TjQ3 TjQ4 TjQ5 TjQ6 TcQ1 TcQ2 TcQ3 TcQ4 TcQ5 TcQ6 Baseplate
 
*** Default Parameters *** 
 
.param BPC=0 Thermals=1 level=3 Vths=0 Rdss=0 Rp=100 Tj={TEMP} Afm=2 AFnomM=2 die=20 LP1D=3.75n LP2D=3.90n LP3D=5.84n LP1S=7.47n LP2S=10.20n LP3S=13.98n LP1P=11.07n LP2P=11.54n LP3P=11.72n LD1D2=5.84n LD2D3=1.00n RD1D2p=100.00 RD2D3p=100.00Meg RD1D2s=100.00u RD2D3s=100.00 Rdesr=1.01m Rpesr=1.51m Rsesr=1.51m PackageRgi=3.00 DieRgi=1.70 CgdOffseth=5.00p CgdOffsetl=5.00p LgQ1=15.90n LgQ2=13.60n LgQ3=23.40n LgQ4=14.60n LgQ5=23.50n LgQ6=13.50n Cu1g=50.36p Cu2g=26.10p Ca1g=60.70p Ca2g=58.00p Ca3g=62.00p Cl1g=27.40p Cl2g=26.80p Cl3g=39.20p Rt1={AFnomM*9.52m/AFm} Rt2={AFnomM*90.24m/AFm} Rt3={AFnomM*622.71m/AFm} Ct1={AFm*449.10u/AFnomM} Ct2={AFm*10.50m/AFnomM} Ct3={AFm*84.35m/AFnomM}
 
*** Behavior Optimization *** 
 
.param RgiPerDie = {PackageRgi+DieRgi}
.param Rgi = {RgiPerDie/Afm}
.param BPCFlag = {if(Cu2g+0.5,2*BPC,BPC}
 
*** Module Subcircuit Call *** 
 
X1 DC+1 DC+2 DC+3 DC-1 DC-2 DC-3 U V W G1 G2 G3 G4 G5 G6 K1 K2 K3 K4 K5 K6 TjQ1 TjQ2 TjQ3 TjQ4 TjQ5 TjQ6 TcQ1 TcQ2 TcQ3 TcQ4 TcQ5 TcQ6 Baseplate Module_SixPack PARAMS: BPC = {2*BPCFlag+1} Thermal = {Thermals+3} die={die+level} CgdOffseth={CgdOffseth} CgdOffsetl={CgdOffsetl} Rdss={Rdss} Vths={Vths} AFm={AFm} Rp={Rp} Tj={Tj} LP1D={LP1D} LP2D={LP2D} LP3D={LP3D} LP1S={LP1S} LP2S={LP2S} LP3S={LP3S} LP1P={LP1P} LP2P={LP2P} LP3P={LP3P} LgQ1={LgQ1} LgQ2={LgQ2} LgQ3={LgQ3} LgQ4={LgQ4} LgQ5={LgQ5} LgQ6={LgQ6} LD1D2={LD1D2} LD2D3={LD2D3} RD1D2s={RD1D2s} RD2D3s={RD2D3s} RD1D2p={RD1D2p} RD2D3p={RD2D3p} Rdesr={Rdesr} Rpesr={Rpesr} Rsesr={Rsesr} Rgi={Rgi} Cu1g={Cu1g} Cu2g={Cu2g} Ca1g={Ca1g} Ca2g={Ca2g} Ca3g={Ca3g} Cl1g={Cl1g} Cl2g={Cl2g} Cl3g={Cl3g} Rt1={Rt1} Rt2={Rt2} Rt3={Rt3} Ct1={Ct1} Ct2={Ct2} Ct3={Ct3}

.ENDS CCB016M12GM3



**********************************************************************
********************* SiC MOSFET Models ******************************
**********************************************************************
.SUBCKT 11 D G S Tj Id
*** Forward Conduction Model ***
Gds D s2 Value {V(Fwd)}
Eds Fwd 0 Value {AF*IdFwd(V(D,s2),V(G,S)+Vths+VthFwd(V(Tj)))}
GRds s2 S Value {V(s2,S)/((Rdss + RTJ(V(Tj)))/AF)}
R1 s2 S 1k
Rbypass D S 1G

.func IdFwd(Vds,Vgs) {a(Vgs)*atan(b(Vgs)*max(Vds,0)) + c(Vgs)*Vds + b(Vgs)*a(Vgs)*min(Vds,0)}

ECurr Id 0 Value {abs(I(Rbd)) + abs(V(Fwd))}
DBD S d2 IdealDiode
Rbd d2 D {Rs_ideal/(2*AF)}
.model IdealDiode D(level=1 Is={AF*Is_ideal} N={n_ideal/((TEMP+273.15)*(0.026/(27+273.15)))} Rs={Rs_ideal/(2*AF)} Tnom={TEMP})
*** CV Model ***

G_cdg    D    G    Value {(AF*1e-9*Cdg(V(D,G))+{Cgd_Module})*ddt(V(D,G))}
G_cds    d2   S    Value {AF*1e-9*Cds(V(d2,S))*ddt(V(d2,S))}
G_cgs    G    S    Value {AF*1e-9*Cgs(V(G,S))*ddt(V(G,S))}

**********************************************************************
********************** Models and Parameters ***********************
**********************************************************************



*** Forward Conduction Parameters ***
.func a(Vgs) {table(Vgs,0,8.3333e-10,0.5,1.2982e-08,1,2.0225e-07,1.5,3.1509e-06,2,4.9088e-05,2.5,0.00076474,3,0.011914,3.5,0.18561,4,0.50404,4.5,1.1409,5,2.2481,5.5,4.0563,6,6.8063,6.5,10.7047,7,16.0049,7.5,22.9126,8,31.5494,8.5,42.1912,9,54.5122,9.5,68.3968,10,83.9085,10.5,100.863,11,118.5175,11.5,138.0199,12,156.6829,12.5,174.6557,13,188.7209,13.5,199.0491,14,207.3123,14.5,214.8556,15,221.8959,15.5,231.4017,16,243.1555,16.5,254.6916,17,266.8902,17.5,278.88,18,291.1328)}
.func b(Vgs) {table(Vgs,0,1,0.5,1,1,1,1.5,1,2,1,2.5,1,3,1,3.5,1,4,1,4.5,1,5,0.99444,5.5,0.97144,6,0.92724,6.5,0.87108,7,0.80127,7.5,0.72678,8,0.66109,8.5,0.60486,9,0.55937,9.5,0.52537,10,0.4975,10.5,0.47419,11,0.45986,11.5,0.44017,12,0.42806,12.5,0.42272,13,0.43658,13.5,0.47079,14,0.50976,14.5,0.54333,15,0.57421,15.5,0.58998,16,0.58815,16.5,0.58815,17,0.58815,17.5,0.58815,18,0.58815)}
.func c(Vgs) {table(Vgs,0,0,0.5,0,1,0,1.5,0,2,0,2.5,7.9266e-05,3,0.00015974,3.5,0.00034964,4,0.00074732,4.5,0.001529,5,0.0027841,5.5,0.0047254,6,0.0072501,6.5,0.01119,7,0.017804,7.5,0.026934,8,0.040122,8.5,0.054771,9,0.078503,9.5,0.11588,10,0.16675,10.5,0.24128,11,0.36574,11.5,0.49263,12,0.62081,12.5,0.73562,13,0.82612,13.5,0.8652,14,0.89199,14.5,0.90079,15,0.90638,15.5,0.90789,16,0.90873,16.5,0.90873,17,0.90873,17.5,0.90873,18,0.90873)}
.func RTJ(Tj) {table(Tj,25,0.011914,50,0.013392,75,0.015404,100,0.019593,125,0.021344,150,0.025398,175,0.030352)}
.func VthFwd(Tj) {table(Tj,25,-0.68954,50,-0.53558,75,-0.3551,100,0,125,-0.023907,150,0.14995,175,0.30031)}


*** Reverse Conduction Parameters ***
.func Is(Vgs) {table(Vgs,-5,0.01,-4,0.01,-3,0.01,-2,0.01,-1,0.01,0,0.01,1,0.01,2,0.01,3,0.01,4,0.01,5,0.01,6,0.01,7,0.01,8,0.01,9,0.01,10,0.01,11,0.01,12,0.01,13,0.01,14,0.01,15,0.01,16,0.01,17,0.01,18,0.01)}
.func RdBD(Tj) {table(Tj,25,-0.0012108,50,-0.0014232,75,-0.0012184,100,0,125,-0.00016305,150,0.0013038,175,0.0031927)}
.func VthBD(Tj) {table(Tj,25,-2,50,-2,75,-1.5348,100,0,125,-0.42365,150,0.53273,175,1.3252)}

*** Device Capacitance Values ***
.func Cds(V) {table(V,0.010,3.116,0.015,3.118,0.022,3.119,0.033,3.114,0.050,3.106,0.075,3.092,0.111,3.070,0.167,3.054,0.249,3.015,0.372,2.962,0.556,2.894,0.831,2.805,1.242,2.682,1.856,2.525,2.774,2.338,4.146,2.127,6.196,1.883,9.260,1.588,13.840,1.153,20.684,0.919,30.913,0.714,46.200,0.574,69.048,0.468,103.195,0.382,154.228,0.313,230.500,0.257,344.491,0.212,514.854,0.176,769.469,0.170,1150.000,0.167)}

.func Cdg(V) {table(V,0.010,1.564,0.015,1.564,0.022,1.555,0.033,1.540,0.050,1.526,0.075,1.497,0.111,1.454,0.167,1.394,0.249,1.312,0.372,1.207,0.556,1.094,0.831,0.985,1.242,0.873,1.856,0.748,2.774,0.625,4.146,0.510,6.196,0.399,9.260,0.283,13.840,0.068,20.684,0.051,30.913,0.036,46.200,0.029,69.048,0.024,103.195,0.021,154.228,0.018,230.500,0.015,344.491,0.013,514.854,0.012,769.469,0.012,1150.000,0.012)}

.func Cgs(V) {table(V,-5.000,5.298,-4.750,4.915,-4.500,4.606,-4.250,4.336,-4.000,4.221,-3.750,4.196,-3.500,4.201,-3.250,4.212,-3.000,4.228,-2.750,4.249,-2.500,4.277,-2.250,4.312,-2.000,4.347,-1.750,4.383,-1.500,4.425,-1.250,4.481,-1.000,4.568,-0.750,4.705,-0.500,4.907,-0.250,5.158,0.000,5.411,0.250,5.637,0.500,5.828,0.750,5.979,1.000,6.117,1.250,6.239,1.500,6.355,1.750,6.465,2.000,6.566,2.250,6.642,2.500,6.708,2.750,6.754,3.000,6.793,3.250,6.820,3.500,6.845,3.750,6.864,4.000,6.881,4.250,6.893,4.500,6.905,4.750,6.915,5.000,6.924,6.000,6.954,7.000,6.976,8.000,6.993,9.000,7.008,10.000,7.020,11.000,7.031,12.000,7.042,13.000,7.051,14.000,7.060,15.000,7.068)}


.param Is_ideal=1.000000e-02
.param n_ideal=5.763643e-01
.param Rs_ideal=1.087027e-02
.ENDS 11

.SUBCKT 12 D G S Tj Id
*** Forward Conduction Model ***
Gds D s2 Value {V(Fwd)}
Eds Fwd 0 Value {AF*IdFwd(V(D,s2),V(G,S)+Vths+VthFwd(V(Tj)))}
GRds s2 S Value {V(s2,S)/((Rdss + RTJ(V(Tj)))/AF)}
R1 s2 S 1k
Rbypass D S 1G

.func IdFwd(Vds,Vgs) {a(Vgs)*atan(b(Vgs)*max(Vds,0)) + c(Vgs)*Vds + b(Vgs)*a(Vgs)*min(Vds,0)}

ECurr Id 0 Value {abs(V(Rev)) + abs(V(Fwd))}
*** Third Quadrant [Without RR] ***
GRbd D d2 Value {V(D,d2)/((RdBD(V(Tj))+Rs(V(G,S)+VthBD(V(Tj))))/(AF))}
R2 D d2 1k
GTQ S d2 Value {V(Rev)}
ETQ Rev 0 Value {AF*min(Is(V(G,S)+VthBD(V(Tj)))*(-1+exp(max(V(S,d2),-1n)/(nn(V(G,S)+VthBD(V(Tj)))))),1e4)}

*** CV Model ***

G_cdg    D    G    Value {(AF*1e-9*Cdg(V(D,G))+{Cgd_Module})*ddt(V(D,G))}
G_cds    d2   S    Value {AF*1e-9*Cds(V(d2,S))*ddt(V(d2,S))}
G_cgs    G    S    Value {AF*1e-9*Cgs(V(G,S))*ddt(V(G,S))}

**********************************************************************
********************** Models and Parameters ***********************
**********************************************************************



*** Forward Conduction Parameters ***
.func a(Vgs) {table(Vgs,0,8.3333e-10,0.5,1.2982e-08,1,2.0225e-07,1.5,3.1509e-06,2,4.9088e-05,2.5,0.00076474,3,0.011914,3.5,0.18561,4,0.50404,4.5,1.1409,5,2.2481,5.5,4.0563,6,6.8063,6.5,10.7047,7,16.0049,7.5,22.9126,8,31.5494,8.5,42.1912,9,54.5122,9.5,68.3968,10,83.9085,10.5,100.863,11,118.5175,11.5,138.0199,12,156.6829,12.5,174.6557,13,188.7209,13.5,199.0491,14,207.3123,14.5,214.8556,15,221.8959,15.5,231.4017,16,243.1555,16.5,254.6916,17,266.8902,17.5,278.88,18,291.1328)}
.func b(Vgs) {table(Vgs,0,1,0.5,1,1,1,1.5,1,2,1,2.5,1,3,1,3.5,1,4,1,4.5,1,5,0.99444,5.5,0.97144,6,0.92724,6.5,0.87108,7,0.80127,7.5,0.72678,8,0.66109,8.5,0.60486,9,0.55937,9.5,0.52537,10,0.4975,10.5,0.47419,11,0.45986,11.5,0.44017,12,0.42806,12.5,0.42272,13,0.43658,13.5,0.47079,14,0.50976,14.5,0.54333,15,0.57421,15.5,0.58998,16,0.58815,16.5,0.58815,17,0.58815,17.5,0.58815,18,0.58815)}
.func c(Vgs) {table(Vgs,0,0,0.5,0,1,0,1.5,0,2,0,2.5,7.9266e-05,3,0.00015974,3.5,0.00034964,4,0.00074732,4.5,0.001529,5,0.0027841,5.5,0.0047254,6,0.0072501,6.5,0.01119,7,0.017804,7.5,0.026934,8,0.040122,8.5,0.054771,9,0.078503,9.5,0.11588,10,0.16675,10.5,0.24128,11,0.36574,11.5,0.49263,12,0.62081,12.5,0.73562,13,0.82612,13.5,0.8652,14,0.89199,14.5,0.90079,15,0.90638,15.5,0.90789,16,0.90873,16.5,0.90873,17,0.90873,17.5,0.90873,18,0.90873)}
.func RTJ(Tj) {table(Tj,25,0.011914,50,0.013392,75,0.015404,100,0.019593,125,0.021344,150,0.025398,175,0.030352)}
.func VthFwd(Tj) {table(Tj,25,-0.68954,50,-0.53558,75,-0.3551,100,0,125,-0.023907,150,0.14995,175,0.30031)}


*** Reverse Conduction Parameters ***
.func nn(Vgs) {table(Vgs,-5,0.57636,-4,0.54594,-3,0.50981,-2,0.46658,-1,0.41721,0,0.36171,1,0.30294,2,0.24556,3,0.19427,4,0.15172,5,0.1203,6,0.1,7,0.1,8,0.1,9,0.1,10,0.1,11,0.1,12,0.1,13,0.1,14,0.1,15,0.1,16,0.1,17,0.1,18,0.1)}
.func Rs(Vgs) {table(Vgs,-5,0.01087,-4,0.011694,-3,0.012977,-2,0.014746,-1,0.01691,0,0.019396,1,0.021924,2,0.024179,3,0.025851,4,0.027347,5,0.029295,6,0.032788,7,0.036996,8,0.042552,9,0.049469,10,0.057877,11,0.067578,12,0.07656,13,0.088661,14,0.11329,15,0.13568,16,0.14355,17,0.15067,18,0.15611)}
.func Is(Vgs) {table(Vgs,-5,0.01,-4,0.01,-3,0.01,-2,0.01,-1,0.01,0,0.01,1,0.01,2,0.01,3,0.01,4,0.01,5,0.01,6,0.01,7,0.01,8,0.01,9,0.01,10,0.01,11,0.01,12,0.01,13,0.01,14,0.01,15,0.01,16,0.01,17,0.01,18,0.01)}
.func RdBD(Tj) {table(Tj,25,-0.0012108,50,-0.0014232,75,-0.0012184,100,0,125,-0.00016305,150,0.0013038,175,0.0031927)}
.func VthBD(Tj) {table(Tj,25,-2,50,-2,75,-1.5348,100,0,125,-0.42365,150,0.53273,175,1.3252)}

*** Device Capacitance Values ***
.func Cds(V) {table(V,0.010,3.116,0.015,3.118,0.022,3.119,0.033,3.114,0.050,3.106,0.075,3.092,0.111,3.070,0.167,3.054,0.249,3.015,0.372,2.962,0.556,2.894,0.831,2.805,1.242,2.682,1.856,2.525,2.774,2.338,4.146,2.127,6.196,1.883,9.260,1.588,13.840,1.153,20.684,0.919,30.913,0.714,46.200,0.574,69.048,0.468,103.195,0.382,154.228,0.313,230.500,0.257,344.491,0.212,514.854,0.176,769.469,0.170,1150.000,0.167)}

.func Cdg(V) {table(V,0.010,1.564,0.015,1.564,0.022,1.555,0.033,1.540,0.050,1.526,0.075,1.497,0.111,1.454,0.167,1.394,0.249,1.312,0.372,1.207,0.556,1.094,0.831,0.985,1.242,0.873,1.856,0.748,2.774,0.625,4.146,0.510,6.196,0.399,9.260,0.283,13.840,0.068,20.684,0.051,30.913,0.036,46.200,0.029,69.048,0.024,103.195,0.021,154.228,0.018,230.500,0.015,344.491,0.013,514.854,0.012,769.469,0.012,1150.000,0.012)}

.func Cgs(V) {table(V,-5.000,5.298,-4.750,4.915,-4.500,4.606,-4.250,4.336,-4.000,4.221,-3.750,4.196,-3.500,4.201,-3.250,4.212,-3.000,4.228,-2.750,4.249,-2.500,4.277,-2.250,4.312,-2.000,4.347,-1.750,4.383,-1.500,4.425,-1.250,4.481,-1.000,4.568,-0.750,4.705,-0.500,4.907,-0.250,5.158,0.000,5.411,0.250,5.637,0.500,5.828,0.750,5.979,1.000,6.117,1.250,6.239,1.500,6.355,1.750,6.465,2.000,6.566,2.250,6.642,2.500,6.708,2.750,6.754,3.000,6.793,3.250,6.820,3.500,6.845,3.750,6.864,4.000,6.881,4.250,6.893,4.500,6.905,4.750,6.915,5.000,6.924,6.000,6.954,7.000,6.976,8.000,6.993,9.000,7.008,10.000,7.020,11.000,7.031,12.000,7.042,13.000,7.051,14.000,7.060,15.000,7.068)}


.ENDS 12

.SUBCKT 13 D G S Tj Id
*** Forward Conduction Model ***
Gds D s2 Value {V(Fwd)}
Eds Fwd 0 Value {AF*IdFwd(V(D,s2),V(G,S)+Vths+VthFwd(V(Tj)))}
GRds s2 S Value {V(s2,S)/((Rdss + RTJ(V(Tj)))/AF)}
R1 s2 S 1k
Rbypass D S 1G

.func IdFwd(Vds,Vgs) {a(Vgs)*atan(b(Vgs)*max(Vds,0)) + c(Vgs)*Vds + b(Vgs)*a(Vgs)*min(Vds,0)}

ECurr Id 0 Value {abs(V(Rev)) + abs(V(Fwd))}
*** Third Quadrant [With RR] ***
GRbd D d2 Value {V(D,d2)/((RdBD(V(Tj))+Rs(V(G,S)+VthBD(V(Tj))))/(AF))}
R2 D d2 1k
GI1 0 qm Value {-1/tau(V(Tj))*V(qm)+V(qe,qm)/TM(V(Tj))}
EV1 qe 0 Value {min((1+TM(V(Tj))/tau(V(Tj)))*Is(V(G,S)+VthBD(V(Tj)))*tau(V(Tj))*(-1+exp(max(V(S,d2),-1n)/(nn(V(G,S)+VthBD(V(Tj)))))),1e4)}
GITQ S d2 Value {V(Rev)}
EITQ Rev 0 Value {AF*V(qe,qm)/TM(V(Tj))}
C1 qm 0 1
R3 qm 0 100G
.func tau(Tj) {1e-9*table(Tj,25,10,75,16,125,25,150,28)}
.func TM(Tj) {1e-9*table(Tj,25,10,75,10,125,10,150,10)}

*** CV Model ***

G_cdg    D    G    Value {(AF*1e-9*Cdg(V(D,G))+{Cgd_Module})*ddt(V(D,G))}
G_cds    d2   S    Value {AF*1e-9*Cds(V(d2,S))*ddt(V(d2,S))}
G_cgs    G    S    Value {AF*1e-9*Cgs(V(G,S))*ddt(V(G,S))}

**********************************************************************
********************** Models and Parameters ***********************
**********************************************************************



*** Forward Conduction Parameters ***
.func a(Vgs) {table(Vgs,0,8.3333e-10,0.5,1.2982e-08,1,2.0225e-07,1.5,3.1509e-06,2,4.9088e-05,2.5,0.00076474,3,0.011914,3.5,0.18561,4,0.50404,4.5,1.1409,5,2.2481,5.5,4.0563,6,6.8063,6.5,10.7047,7,16.0049,7.5,22.9126,8,31.5494,8.5,42.1912,9,54.5122,9.5,68.3968,10,83.9085,10.5,100.863,11,118.5175,11.5,138.0199,12,156.6829,12.5,174.6557,13,188.7209,13.5,199.0491,14,207.3123,14.5,214.8556,15,221.8959,15.5,231.4017,16,243.1555,16.5,254.6916,17,266.8902,17.5,278.88,18,291.1328)}
.func b(Vgs) {table(Vgs,0,1,0.5,1,1,1,1.5,1,2,1,2.5,1,3,1,3.5,1,4,1,4.5,1,5,0.99444,5.5,0.97144,6,0.92724,6.5,0.87108,7,0.80127,7.5,0.72678,8,0.66109,8.5,0.60486,9,0.55937,9.5,0.52537,10,0.4975,10.5,0.47419,11,0.45986,11.5,0.44017,12,0.42806,12.5,0.42272,13,0.43658,13.5,0.47079,14,0.50976,14.5,0.54333,15,0.57421,15.5,0.58998,16,0.58815,16.5,0.58815,17,0.58815,17.5,0.58815,18,0.58815)}
.func c(Vgs) {table(Vgs,0,0,0.5,0,1,0,1.5,0,2,0,2.5,7.9266e-05,3,0.00015974,3.5,0.00034964,4,0.00074732,4.5,0.001529,5,0.0027841,5.5,0.0047254,6,0.0072501,6.5,0.01119,7,0.017804,7.5,0.026934,8,0.040122,8.5,0.054771,9,0.078503,9.5,0.11588,10,0.16675,10.5,0.24128,11,0.36574,11.5,0.49263,12,0.62081,12.5,0.73562,13,0.82612,13.5,0.8652,14,0.89199,14.5,0.90079,15,0.90638,15.5,0.90789,16,0.90873,16.5,0.90873,17,0.90873,17.5,0.90873,18,0.90873)}
.func RTJ(Tj) {table(Tj,25,0.011914,50,0.013392,75,0.015404,100,0.019593,125,0.021344,150,0.025398,175,0.030352)}
.func VthFwd(Tj) {table(Tj,25,-0.68954,50,-0.53558,75,-0.3551,100,0,125,-0.023907,150,0.14995,175,0.30031)}


*** Reverse Conduction Parameters ***
.func nn(Vgs) {table(Vgs,-5,0.57636,-4,0.54594,-3,0.50981,-2,0.46658,-1,0.41721,0,0.36171,1,0.30294,2,0.24556,3,0.19427,4,0.15172,5,0.1203,6,0.1,7,0.1,8,0.1,9,0.1,10,0.1,11,0.1,12,0.1,13,0.1,14,0.1,15,0.1,16,0.1,17,0.1,18,0.1)}
.func Rs(Vgs) {table(Vgs,-5,0.01087,-4,0.011694,-3,0.012977,-2,0.014746,-1,0.01691,0,0.019396,1,0.021924,2,0.024179,3,0.025851,4,0.027347,5,0.029295,6,0.032788,7,0.036996,8,0.042552,9,0.049469,10,0.057877,11,0.067578,12,0.07656,13,0.088661,14,0.11329,15,0.13568,16,0.14355,17,0.15067,18,0.15611)}
.func Is(Vgs) {table(Vgs,-5,0.01,-4,0.01,-3,0.01,-2,0.01,-1,0.01,0,0.01,1,0.01,2,0.01,3,0.01,4,0.01,5,0.01,6,0.01,7,0.01,8,0.01,9,0.01,10,0.01,11,0.01,12,0.01,13,0.01,14,0.01,15,0.01,16,0.01,17,0.01,18,0.01)}
.func RdBD(Tj) {table(Tj,25,-0.0012108,50,-0.0014232,75,-0.0012184,100,0,125,-0.00016305,150,0.0013038,175,0.0031927)}
.func VthBD(Tj) {table(Tj,25,-2,50,-2,75,-1.5348,100,0,125,-0.42365,150,0.53273,175,1.3252)}

*** Device Capacitance Values ***
.func Cds(V) {table(V,0.010,3.116,0.015,3.118,0.022,3.119,0.033,3.114,0.050,3.106,0.075,3.092,0.111,3.070,0.167,3.054,0.249,3.015,0.372,2.962,0.556,2.894,0.831,2.805,1.242,2.682,1.856,2.525,2.774,2.338,4.146,2.127,6.196,1.883,9.260,1.588,13.840,1.153,20.684,0.919,30.913,0.714,46.200,0.574,69.048,0.468,103.195,0.382,154.228,0.313,230.500,0.257,344.491,0.212,514.854,0.176,769.469,0.170,1150.000,0.167)}

.func Cdg(V) {table(V,0.010,1.564,0.015,1.564,0.022,1.555,0.033,1.540,0.050,1.526,0.075,1.497,0.111,1.454,0.167,1.394,0.249,1.312,0.372,1.207,0.556,1.094,0.831,0.985,1.242,0.873,1.856,0.748,2.774,0.625,4.146,0.510,6.196,0.399,9.260,0.283,13.840,0.068,20.684,0.051,30.913,0.036,46.200,0.029,69.048,0.024,103.195,0.021,154.228,0.018,230.500,0.015,344.491,0.013,514.854,0.012,769.469,0.012,1150.000,0.012)}

.func Cgs(V) {table(V,-5.000,5.298,-4.750,4.915,-4.500,4.606,-4.250,4.336,-4.000,4.221,-3.750,4.196,-3.500,4.201,-3.250,4.212,-3.000,4.228,-2.750,4.249,-2.500,4.277,-2.250,4.312,-2.000,4.347,-1.750,4.383,-1.500,4.425,-1.250,4.481,-1.000,4.568,-0.750,4.705,-0.500,4.907,-0.250,5.158,0.000,5.411,0.250,5.637,0.500,5.828,0.750,5.979,1.000,6.117,1.250,6.239,1.500,6.355,1.750,6.465,2.000,6.566,2.250,6.642,2.500,6.708,2.750,6.754,3.000,6.793,3.250,6.820,3.500,6.845,3.750,6.864,4.000,6.881,4.250,6.893,4.500,6.905,4.750,6.915,5.000,6.924,6.000,6.954,7.000,6.976,8.000,6.993,9.000,7.008,10.000,7.020,11.000,7.031,12.000,7.042,13.000,7.051,14.000,7.060,15.000,7.068)}


.ENDS 13

.SUBCKT 21 D G S Tj Id
*** Forward Conduction Model ***
Gds D s2 Value {V(Fwd)}
Eds Fwd 0 Value {AF*IdFwd(V(D,s2),V(G,S)+Vths+VthFwd(V(Tj)))}
GRds s2 S Value {V(s2,S)/((Rdss + RTJ(V(Tj)))/AF)}
R1 s2 S 1k
Rbypass D S 1G

.func IdFwd(Vds,Vgs) {a(Vgs)*atan(b(Vgs)*max(Vds,0)) + c(Vgs)*Vds + b(Vgs)*a(Vgs)*min(Vds,0)}

ECurr Id 0 Value {abs(I(Rbd)) + abs(V(Fwd))}
DBD S d2 IdealDiode
Rbd d2 D {Rs_ideal/(2*AF)}
.model IdealDiode D(level=1 Is={AF*Is_ideal} N={n_ideal/((TEMP+273.15)*(0.026/(27+273.15)))} Rs={Rs_ideal/(2*AF)} Tnom={TEMP})
*** CV Model ***

G_cdg    D    G    Value {(AF*1e-9*Cdg(V(D,G))+{Cgd_Module})*ddt(V(D,G))}
G_cds    d2   S    Value {AF*1e-9*Cds(V(d2,S))*ddt(V(d2,S))}
G_cgs    G    S    Value {AF*1e-9*Cgs(V(G,S))*ddt(V(G,S))}

**********************************************************************
********************** Models and Parameters ***********************
**********************************************************************



*** Forward Conduction Parameters ***
.func a(Vgs) {table(Vgs,0,8.3333e-10,0.5,9.97e-09,1,1.1928e-07,1.5,1.4271e-06,2,1.7074e-05,2.5,0.00020427,3,0.0024439,3.5,0.029239,4,0.34981,4.5,0.77628,5,1.5194,5.5,2.6878,6,4.4415,6.5,6.9333,7,10.292,7.5,14.6357,8,20.15,8.5,26.9386,9,35.1106,9.5,44.6845,10,56.003,10.5,67.8842,11,80.8186,11.5,92.7067,12,104.2473,12.5,114.5282,13,124.6607,13.5,133.3149,14,140.8567,14.5,147.7232,15,154.1018,15.5,159.6641,16,164.3289,16.5,170.123,17,175.488,17.5,180.2201,18,185.6562)}
.func b(Vgs) {table(Vgs,0,1,0.5,1,1,1,1.5,1,2,1,2.5,1,3,1,3.5,1,4,1,4.5,1,5,1,5.5,0.99306,6,0.9662,6.5,0.92061,7,0.86095,7.5,0.78999,8,0.71198,8.5,0.64305,9,0.58326,9.5,0.52984,10,0.47657,10.5,0.4404,11,0.41057,11.5,0.39833,12,0.39309,12.5,0.39913,13,0.4017,13.5,0.41133,14,0.42667,14.5,0.44269,15,0.4586,15.5,0.47485,16,0.48855,16.5,0.48855,17,0.48855,17.5,0.48855,18,0.48855)}
.func c(Vgs) {table(Vgs,0,0,0.5,0,1,0,1.5,0,2,0,2.5,0,3,8.7718e-05,3.5,0.0002469,4,0.00046812,4.5,0.0008796,5,0.00162,5.5,0.0027135,6,0.0042045,6.5,0.0062194,7,0.0092754,7.5,0.013708,8,0.019053,8.5,0.024989,9,0.0327,9.5,0.040871,10,0.048897,10.5,0.070468,11,0.094808,11.5,0.20315,12,0.36665,12.5,0.62335,13,0.89109,13.5,1.187,14,1.4029,14.5,1.5619,15,1.6261,15.5,1.6645,16,1.6708,16.5,1.6708,17,1.6708,17.5,1.6708,18,1.6708)}
.func RTJ(Tj) {table(Tj,25,0.015759,50,0.018128,75,0.021312,100,0.029161,125,0.030657,150,0.036784,175,0.044171)}
.func VthFwd(Tj) {table(Tj,25,-0.84491,50,-0.64017,75,-0.41363,100,0,125,0.0071965,150,0.18129,175,0.34813)}


*** Reverse Conduction Parameters ***
.func Is(Vgs) {table(Vgs,-5,0.01,-4,0.01,-3,0.01,-2,0.01,-1,0.01,0,0.01,1,0.01,2,0.01,3,0.01,4,0.01,5,0.01,6,0.01,7,0.01,8,0.01,9,0.01,10,0.01,11,0.01,12,0.01,13,0.01,14,0.01,15,0.01,16,0.01,17,0.01,18,0.01)}
.func RdBD(Tj) {table(Tj,25,-0.0029738,50,-0.0018249,75,-0.0012234,100,0,125,-0.0002992,150,0.0018262,175,0.0045939)}
.func VthBD(Tj) {table(Tj,25,-3.9303,50,-1.193,75,-1.0651,100,0,125,-0.28905,150,0.68221,175,1.5178)}

*** Device Capacitance Values ***
.func Cds(V) {table(V,0.010,2.290,0.015,2.267,0.022,2.266,0.033,2.267,0.050,2.259,0.075,2.247,0.111,2.232,0.167,2.220,0.249,2.180,0.372,2.149,0.556,2.096,0.831,2.025,1.242,1.936,1.856,1.820,2.774,1.685,4.146,1.529,6.196,1.359,9.260,1.137,13.840,0.830,20.684,0.661,30.913,0.514,46.200,0.413,69.048,0.336,103.195,0.274,154.228,0.225,230.500,0.186,344.491,0.154,514.854,0.129,769.469,0.122,1150.000,0.120)}

.func Cdg(V) {table(V,0.010,1.043,0.015,1.043,0.022,1.039,0.033,1.027,0.050,1.016,0.075,0.997,0.111,0.968,0.167,0.926,0.249,0.872,0.372,0.793,0.556,0.711,0.831,0.633,1.242,0.555,1.856,0.473,2.774,0.391,4.146,0.315,6.196,0.242,9.260,0.158,13.840,0.038,20.684,0.029,30.913,0.021,46.200,0.018,69.048,0.015,103.195,0.013,154.228,0.011,230.500,0.010,344.491,0.009,514.854,0.008,769.469,0.008,1150.000,0.008)}

.func Cgs(V) {table(V,-5.000,3.239,-4.750,3.024,-4.500,2.835,-4.250,2.714,-4.000,2.680,-3.750,2.679,-3.500,2.683,-3.250,2.691,-3.000,2.703,-2.750,2.718,-2.500,2.736,-2.250,2.757,-2.000,2.780,-1.750,2.804,-1.500,2.832,-1.250,2.870,-1.000,2.927,-0.750,3.018,-0.500,3.156,-0.250,3.315,0.000,3.468,0.250,3.615,0.500,3.738,0.750,3.846,1.000,3.944,1.250,4.033,1.500,4.125,1.750,4.210,2.000,4.278,2.250,4.333,2.500,4.375,2.750,4.408,3.000,4.435,3.250,4.457,3.500,4.474,3.750,4.488,4.000,4.502,4.250,4.514,4.500,4.524,4.750,4.533,5.000,4.542,6.000,4.571,7.000,4.595,8.000,4.614,9.000,4.630,10.000,4.643,11.000,4.655,12.000,4.664,13.000,4.672,14.000,4.680,15.000,4.686)}


.param Is_ideal=1.000000e-02
.param n_ideal=5.996503e-01
.param Rs_ideal=1.514717e-02
.ENDS 21

.SUBCKT 22 D G S Tj Id
*** Forward Conduction Model ***
Gds D s2 Value {V(Fwd)}
Eds Fwd 0 Value {AF*IdFwd(V(D,s2),V(G,S)+Vths+VthFwd(V(Tj)))}
GRds s2 S Value {V(s2,S)/((Rdss + RTJ(V(Tj)))/AF)}
R1 s2 S 1k
Rbypass D S 1G

.func IdFwd(Vds,Vgs) {a(Vgs)*atan(b(Vgs)*max(Vds,0)) + c(Vgs)*Vds + b(Vgs)*a(Vgs)*min(Vds,0)}

ECurr Id 0 Value {abs(V(Rev)) + abs(V(Fwd))}
*** Third Quadrant [Without RR] ***
GRbd D d2 Value {V(D,d2)/((RdBD(V(Tj))+Rs(V(G,S)+VthBD(V(Tj))))/(AF))}
R2 D d2 1k
GTQ S d2 Value {V(Rev)}
ETQ Rev 0 Value {AF*min(Is(V(G,S)+VthBD(V(Tj)))*(-1+exp(max(V(S,d2),-1n)/(nn(V(G,S)+VthBD(V(Tj)))))),1e4)}

*** CV Model ***

G_cdg    D    G    Value {(AF*1e-9*Cdg(V(D,G))+{Cgd_Module})*ddt(V(D,G))}
G_cds    d2   S    Value {AF*1e-9*Cds(V(d2,S))*ddt(V(d2,S))}
G_cgs    G    S    Value {AF*1e-9*Cgs(V(G,S))*ddt(V(G,S))}

**********************************************************************
********************** Models and Parameters ***********************
**********************************************************************



*** Forward Conduction Parameters ***
.func a(Vgs) {table(Vgs,0,8.3333e-10,0.5,9.97e-09,1,1.1928e-07,1.5,1.4271e-06,2,1.7074e-05,2.5,0.00020427,3,0.0024439,3.5,0.029239,4,0.34981,4.5,0.77628,5,1.5194,5.5,2.6878,6,4.4415,6.5,6.9333,7,10.292,7.5,14.6357,8,20.15,8.5,26.9386,9,35.1106,9.5,44.6845,10,56.003,10.5,67.8842,11,80.8186,11.5,92.7067,12,104.2473,12.5,114.5282,13,124.6607,13.5,133.3149,14,140.8567,14.5,147.7232,15,154.1018,15.5,159.6641,16,164.3289,16.5,170.123,17,175.488,17.5,180.2201,18,185.6562)}
.func b(Vgs) {table(Vgs,0,1,0.5,1,1,1,1.5,1,2,1,2.5,1,3,1,3.5,1,4,1,4.5,1,5,1,5.5,0.99306,6,0.9662,6.5,0.92061,7,0.86095,7.5,0.78999,8,0.71198,8.5,0.64305,9,0.58326,9.5,0.52984,10,0.47657,10.5,0.4404,11,0.41057,11.5,0.39833,12,0.39309,12.5,0.39913,13,0.4017,13.5,0.41133,14,0.42667,14.5,0.44269,15,0.4586,15.5,0.47485,16,0.48855,16.5,0.48855,17,0.48855,17.5,0.48855,18,0.48855)}
.func c(Vgs) {table(Vgs,0,0,0.5,0,1,0,1.5,0,2,0,2.5,0,3,8.7718e-05,3.5,0.0002469,4,0.00046812,4.5,0.0008796,5,0.00162,5.5,0.0027135,6,0.0042045,6.5,0.0062194,7,0.0092754,7.5,0.013708,8,0.019053,8.5,0.024989,9,0.0327,9.5,0.040871,10,0.048897,10.5,0.070468,11,0.094808,11.5,0.20315,12,0.36665,12.5,0.62335,13,0.89109,13.5,1.187,14,1.4029,14.5,1.5619,15,1.6261,15.5,1.6645,16,1.6708,16.5,1.6708,17,1.6708,17.5,1.6708,18,1.6708)}
.func RTJ(Tj) {table(Tj,25,0.015759,50,0.018128,75,0.021312,100,0.029161,125,0.030657,150,0.036784,175,0.044171)}
.func VthFwd(Tj) {table(Tj,25,-0.84491,50,-0.64017,75,-0.41363,100,0,125,0.0071965,150,0.18129,175,0.34813)}


*** Reverse Conduction Parameters ***
.func nn(Vgs) {table(Vgs,-5,0.59965,-4,0.57201,-3,0.53658,-2,0.49301,-1,0.443,0,0.38604,1,0.3245,2,0.26534,3,0.21149,4,0.16799,5,0.13596,6,0.1162,7,0.10448,8,0.1,9,0.1,10,0.1,11,0.1,12,0.1,13,0.1,14,0.1,15,0.1,16,0.1,17,0.1,18,0.1)}
.func Rs(Vgs) {table(Vgs,-5,0.015147,-4,0.016156,-3,0.017911,-2,0.020419,-1,0.023458,0,0.02694,1,0.030657,2,0.033828,3,0.036284,4,0.03835,5,0.040913,6,0.045459,7,0.052676,8,0.059681,9,0.067544,10,0.074206,11,0.080669,12,0.089119,13,0.10013,14,0.1118,15,0.12306,16,0.13093,17,0.13008,18,0.12912)}
.func Is(Vgs) {table(Vgs,-5,0.01,-4,0.01,-3,0.01,-2,0.01,-1,0.01,0,0.01,1,0.01,2,0.01,3,0.01,4,0.01,5,0.01,6,0.01,7,0.01,8,0.01,9,0.01,10,0.01,11,0.01,12,0.01,13,0.01,14,0.01,15,0.01,16,0.01,17,0.01,18,0.01)}
.func RdBD(Tj) {table(Tj,25,-0.0029738,50,-0.0018249,75,-0.0012234,100,0,125,-0.0002992,150,0.0018262,175,0.0045939)}
.func VthBD(Tj) {table(Tj,25,-3.9303,50,-1.193,75,-1.0651,100,0,125,-0.28905,150,0.68221,175,1.5178)}

*** Device Capacitance Values ***
.func Cds(V) {table(V,0.010,2.290,0.015,2.267,0.022,2.266,0.033,2.267,0.050,2.259,0.075,2.247,0.111,2.232,0.167,2.220,0.249,2.180,0.372,2.149,0.556,2.096,0.831,2.025,1.242,1.936,1.856,1.820,2.774,1.685,4.146,1.529,6.196,1.359,9.260,1.137,13.840,0.830,20.684,0.661,30.913,0.514,46.200,0.413,69.048,0.336,103.195,0.274,154.228,0.225,230.500,0.186,344.491,0.154,514.854,0.129,769.469,0.122,1150.000,0.120)}

.func Cdg(V) {table(V,0.010,1.043,0.015,1.043,0.022,1.039,0.033,1.027,0.050,1.016,0.075,0.997,0.111,0.968,0.167,0.926,0.249,0.872,0.372,0.793,0.556,0.711,0.831,0.633,1.242,0.555,1.856,0.473,2.774,0.391,4.146,0.315,6.196,0.242,9.260,0.158,13.840,0.038,20.684,0.029,30.913,0.021,46.200,0.018,69.048,0.015,103.195,0.013,154.228,0.011,230.500,0.010,344.491,0.009,514.854,0.008,769.469,0.008,1150.000,0.008)}

.func Cgs(V) {table(V,-5.000,3.239,-4.750,3.024,-4.500,2.835,-4.250,2.714,-4.000,2.680,-3.750,2.679,-3.500,2.683,-3.250,2.691,-3.000,2.703,-2.750,2.718,-2.500,2.736,-2.250,2.757,-2.000,2.780,-1.750,2.804,-1.500,2.832,-1.250,2.870,-1.000,2.927,-0.750,3.018,-0.500,3.156,-0.250,3.315,0.000,3.468,0.250,3.615,0.500,3.738,0.750,3.846,1.000,3.944,1.250,4.033,1.500,4.125,1.750,4.210,2.000,4.278,2.250,4.333,2.500,4.375,2.750,4.408,3.000,4.435,3.250,4.457,3.500,4.474,3.750,4.488,4.000,4.502,4.250,4.514,4.500,4.524,4.750,4.533,5.000,4.542,6.000,4.571,7.000,4.595,8.000,4.614,9.000,4.630,10.000,4.643,11.000,4.655,12.000,4.664,13.000,4.672,14.000,4.680,15.000,4.686)}


.ENDS 22

.SUBCKT 23 D G S Tj Id
*** Forward Conduction Model ***
Gds D s2 Value {V(Fwd)}
Eds Fwd 0 Value {AF*IdFwd(V(D,s2),V(G,S)+Vths+VthFwd(V(Tj)))}
GRds s2 S Value {V(s2,S)/((Rdss + RTJ(V(Tj)))/AF)}
R1 s2 S 1k
Rbypass D S 1G

.func IdFwd(Vds,Vgs) {a(Vgs)*atan(b(Vgs)*max(Vds,0)) + c(Vgs)*Vds + b(Vgs)*a(Vgs)*min(Vds,0)}

ECurr Id 0 Value {abs(V(Rev)) + abs(V(Fwd))}
*** Third Quadrant [With RR] ***
GRbd D d2 Value {V(D,d2)/((RdBD(V(Tj))+Rs(V(G,S)+VthBD(V(Tj))))/(AF))}
R2 D d2 1k
GI1 0 qm Value {-1/tau(V(Tj))*V(qm)+V(qe,qm)/TM(V(Tj))}
EV1 qe 0 Value {min((1+TM(V(Tj))/tau(V(Tj)))*Is(V(G,S)+VthBD(V(Tj)))*tau(V(Tj))*(-1+exp(max(V(S,d2),-1n)/(nn(V(G,S)+VthBD(V(Tj)))))),1e4)}
GITQ S d2 Value {V(Rev)}
EITQ Rev 0 Value {AF*V(qe,qm)/TM(V(Tj))}
C1 qm 0 1
R3 qm 0 100G
.func tau(Tj) {1e-9*table(Tj,25,18,75,19,125,22,150,24)}
.func TM(Tj) {1e-9*table(Tj,25,6,75,6,125,6,150,6)}

*** CV Model ***

G_cdg    D    G    Value {(AF*1e-9*Cdg(V(D,G))+{Cgd_Module})*ddt(V(D,G))}
G_cds    d2   S    Value {AF*1e-9*Cds(V(d2,S))*ddt(V(d2,S))}
G_cgs    G    S    Value {AF*1e-9*Cgs(V(G,S))*ddt(V(G,S))}

**********************************************************************
********************** Models and Parameters ***********************
**********************************************************************



*** Forward Conduction Parameters ***
.func a(Vgs) {table(Vgs,0,8.3333e-10,0.5,9.97e-09,1,1.1928e-07,1.5,1.4271e-06,2,1.7074e-05,2.5,0.00020427,3,0.0024439,3.5,0.029239,4,0.34981,4.5,0.77628,5,1.5194,5.5,2.6878,6,4.4415,6.5,6.9333,7,10.292,7.5,14.6357,8,20.15,8.5,26.9386,9,35.1106,9.5,44.6845,10,56.003,10.5,67.8842,11,80.8186,11.5,92.7067,12,104.2473,12.5,114.5282,13,124.6607,13.5,133.3149,14,140.8567,14.5,147.7232,15,154.1018,15.5,159.6641,16,164.3289,16.5,170.123,17,175.488,17.5,180.2201,18,185.6562)}
.func b(Vgs) {table(Vgs,0,1,0.5,1,1,1,1.5,1,2,1,2.5,1,3,1,3.5,1,4,1,4.5,1,5,1,5.5,0.99306,6,0.9662,6.5,0.92061,7,0.86095,7.5,0.78999,8,0.71198,8.5,0.64305,9,0.58326,9.5,0.52984,10,0.47657,10.5,0.4404,11,0.41057,11.5,0.39833,12,0.39309,12.5,0.39913,13,0.4017,13.5,0.41133,14,0.42667,14.5,0.44269,15,0.4586,15.5,0.47485,16,0.48855,16.5,0.48855,17,0.48855,17.5,0.48855,18,0.48855)}
.func c(Vgs) {table(Vgs,0,0,0.5,0,1,0,1.5,0,2,0,2.5,0,3,8.7718e-05,3.5,0.0002469,4,0.00046812,4.5,0.0008796,5,0.00162,5.5,0.0027135,6,0.0042045,6.5,0.0062194,7,0.0092754,7.5,0.013708,8,0.019053,8.5,0.024989,9,0.0327,9.5,0.040871,10,0.048897,10.5,0.070468,11,0.094808,11.5,0.20315,12,0.36665,12.5,0.62335,13,0.89109,13.5,1.187,14,1.4029,14.5,1.5619,15,1.6261,15.5,1.6645,16,1.6708,16.5,1.6708,17,1.6708,17.5,1.6708,18,1.6708)}
.func RTJ(Tj) {table(Tj,25,0.015759,50,0.018128,75,0.021312,100,0.029161,125,0.030657,150,0.036784,175,0.044171)}
.func VthFwd(Tj) {table(Tj,25,-0.84491,50,-0.64017,75,-0.41363,100,0,125,0.0071965,150,0.18129,175,0.34813)}


*** Reverse Conduction Parameters ***
.func nn(Vgs) {table(Vgs,-5,0.59965,-4,0.57201,-3,0.53658,-2,0.49301,-1,0.443,0,0.38604,1,0.3245,2,0.26534,3,0.21149,4,0.16799,5,0.13596,6,0.1162,7,0.10448,8,0.1,9,0.1,10,0.1,11,0.1,12,0.1,13,0.1,14,0.1,15,0.1,16,0.1,17,0.1,18,0.1)}
.func Rs(Vgs) {table(Vgs,-5,0.015147,-4,0.016156,-3,0.017911,-2,0.020419,-1,0.023458,0,0.02694,1,0.030657,2,0.033828,3,0.036284,4,0.03835,5,0.040913,6,0.045459,7,0.052676,8,0.059681,9,0.067544,10,0.074206,11,0.080669,12,0.089119,13,0.10013,14,0.1118,15,0.12306,16,0.13093,17,0.13008,18,0.12912)}
.func Is(Vgs) {table(Vgs,-5,0.01,-4,0.01,-3,0.01,-2,0.01,-1,0.01,0,0.01,1,0.01,2,0.01,3,0.01,4,0.01,5,0.01,6,0.01,7,0.01,8,0.01,9,0.01,10,0.01,11,0.01,12,0.01,13,0.01,14,0.01,15,0.01,16,0.01,17,0.01,18,0.01)}
.func RdBD(Tj) {table(Tj,25,-0.0029738,50,-0.0018249,75,-0.0012234,100,0,125,-0.0002992,150,0.0018262,175,0.0045939)}
.func VthBD(Tj) {table(Tj,25,-3.9303,50,-1.193,75,-1.0651,100,0,125,-0.28905,150,0.68221,175,1.5178)}

*** Device Capacitance Values ***
.func Cds(V) {table(V,0.010,2.290,0.015,2.267,0.022,2.266,0.033,2.267,0.050,2.259,0.075,2.247,0.111,2.232,0.167,2.220,0.249,2.180,0.372,2.149,0.556,2.096,0.831,2.025,1.242,1.936,1.856,1.820,2.774,1.685,4.146,1.529,6.196,1.359,9.260,1.137,13.840,0.830,20.684,0.661,30.913,0.514,46.200,0.413,69.048,0.336,103.195,0.274,154.228,0.225,230.500,0.186,344.491,0.154,514.854,0.129,769.469,0.122,1150.000,0.120)}

.func Cdg(V) {table(V,0.010,1.043,0.015,1.043,0.022,1.039,0.033,1.027,0.050,1.016,0.075,0.997,0.111,0.968,0.167,0.926,0.249,0.872,0.372,0.793,0.556,0.711,0.831,0.633,1.242,0.555,1.856,0.473,2.774,0.391,4.146,0.315,6.196,0.242,9.260,0.158,13.840,0.038,20.684,0.029,30.913,0.021,46.200,0.018,69.048,0.015,103.195,0.013,154.228,0.011,230.500,0.010,344.491,0.009,514.854,0.008,769.469,0.008,1150.000,0.008)}

.func Cgs(V) {table(V,-5.000,3.239,-4.750,3.024,-4.500,2.835,-4.250,2.714,-4.000,2.680,-3.750,2.679,-3.500,2.683,-3.250,2.691,-3.000,2.703,-2.750,2.718,-2.500,2.736,-2.250,2.757,-2.000,2.780,-1.750,2.804,-1.500,2.832,-1.250,2.870,-1.000,2.927,-0.750,3.018,-0.500,3.156,-0.250,3.315,0.000,3.468,0.250,3.615,0.500,3.738,0.750,3.846,1.000,3.944,1.250,4.033,1.500,4.125,1.750,4.210,2.000,4.278,2.250,4.333,2.500,4.375,2.750,4.408,3.000,4.435,3.250,4.457,3.500,4.474,3.750,4.488,4.000,4.502,4.250,4.514,4.500,4.524,4.750,4.533,5.000,4.542,6.000,4.571,7.000,4.595,8.000,4.614,9.000,4.630,10.000,4.643,11.000,4.655,12.000,4.664,13.000,4.672,14.000,4.680,15.000,4.686)}


.ENDS 23



**********************************************************************
******************** SiC Schottky Models *****************************
**********************************************************************
