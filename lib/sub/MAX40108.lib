* Copyright (c) 1998-2021 Analog Devices, Inc.  All rights reserved.
*
.subckt MAX40108 1 2 3 4 5 6
* CM / DM Input Parameters 
C2  1 4 500E-15
C3  2 4 500E-15
R19  1 4 200G
R20  2 4 200G
R21  1 2 58.0G
* Differential Stage
GIVR 0 IVR 14 0 1m
RIVR 0 IVR 1k Noiseless
CIVR IVR 0 1.59f
BCMPI 0 CMpi I=1m*(V(3)+{Vcm_max})
RCMPI CMpi 0 1k Noiseless
CCMPI CMpi 0 1n
BCMNI 0 CMni I=1m*(V(4)+{Vcm_min})
RCMNI CMni 0 1k Noiseless
CCMNI CMni 0 1n
GCMP 0 CMp CMpi 0 1k
RCMP 0 CMp 1m Noiseless
GCMN 0 CMn CMni 0 1k
RCMN 0 CMn 1m Noiseless
DIP CMp IVR DI
DIN IVR CMn DI
CIN IVR CMn 1f
CIP IVR CMp 1f 
* Noise Stage 
I2 21 20 1.00
D1 20  0 DN1
D2  0 21 DN1
I3 22 23 1N
R10 22 0  1k
R11  0 23 1k
B_E1 71 14 I=(0.00) + V(20) * 20.0 + V(21) * 20.0 + V(22) * 20.0 + V(23) * 20.0
R_E1 71 14 1 Noiseless
I8 0 70 DC 1
R22 0 70 1 TC=25.0N
B_E5 1 71 I=V(70)-1
R_E5 1 71 1 Noiseless
EG1 VIBIASP 0 62 0 1u
GB1 1 0 VIBIASP 0 1
EG2 VIBIASM 0 622 0 1u
GB2 2 0 VIBIASM 0 1
I6 0 62 DC 1uA
VA200 62A 62 DC 0.00
R17 0 62A REXP  57.22643
I622 0 622 DC -1uA
VA201 622A 622 DC 0.00
R17A 0 622A REXPM  77.55347
R16 0 61 1 TC=547U,346N
G61 3 4 61 0 1
G60 0 61 TABLE { V(3, 4) } ((0, 0)(500M,25.6E-18)(900M,24.9U)(1.5,25.5U)(1.8,25.6U)(2.7,25.6U)(3.6,25.6U))
* PSRR / CMRR 
G30 0 110 3 0 316U
R30 110 0 1G 
GR30 110 0 110 0 1m 
C30 110 0 4.97M
G31 0 111 110 0 1 
L31 111 112 289M
GRL31 111 112 111 112 5.49N
R32 112 0 1G 
GR32 112 0 112 0 1 
G33 0 114 111 0 1 
R34 114 0 1G 
C34 114 0 1.59M
GR34 114 0 114 0 1 
G35 0 115 114 0 1 
L35 115 116 106U
GRL35 115 116 115 116 14.9U
R36 116 0 1G 
GR36 116 0 116 0 1 
G37 0 117 115 0 1 
R37 117 0 1G 
C37 117 0 5.30U
GR37 117 0 117 0 1 
G38 0 118 117 0 1 
L38 118 119 1.98U
GRL38 118 119 118 119 800U
R39 119 0 1G 
GR39 119 0 119 0 1 
G40 0 120 4 0 316U
R40 120 0 1G 
GR40 120 0 120 0 1m 
C40 120 0 4.97M
G41 0 121 120 0 1 
L41 121 122 289M
GRL41 121 122 121 122 5.49N
R42 122 0 1G 
GR42 122 0 122 0 1 
G43 0 124 121 0 1 
R44 124 0 1G 
C44 124 0 1.59M
GR44 124 0 124 0 1 
G45 0 125 124 0 1 
L45 125 126 106U
GRL45 125 126 125 126 14.9U
R46 126 0 1G 
GR46 126 0 126 0 1 
G147 0 127 125 0 1 
R47 127 0 1G 
C47 127 0 5.30U
GR47 127 0 127 0 1 
G48 0 128 127 0 1 
L48 128 129 1.98U
GRL48 128 129 128 129 800U
R49 129 0 1G 
GR49 129 0 129 0 1 
G50 0 130 VALUE { ( V(1)+V(2))/2 * 1.00M}
R50 130 0 1G 
GR50 130 0 130 0 1m 
C50 130 0 4.97M
G51 0 131 130 0 1 
L51 131 132 4.19M
GRL51 131 132 131 132 379N
R51 132 0 1G 
GR51 132 0 132 0 1 
G53 0 133 131 0 1 
R53 133 0 1G 
C53 133 0  3.97U
GR53 133 0 133 0 1 
G55 0 134 133 0 1 
L55 134 135 159P
GRL55 134 135 134 135 9.99
R55 135 0 1G 
GR55 135 0 135 0 1 
G57 0 137 134 0 1 
R57 137 0 1G 
C57 137 0  1.98U
GR57 137 0 137 0 1 
*
* OP Amp Output Gain / Response 
G3A  0 30A IVR 2 1 
RG3A 30A 0 1 
G3  0 30 30A 0 1 
R3 30  0 1.00K
G6  0 33 30 0 1m
R6  33 0 1K
R7  34 0 1K
C7  34 0 {Cfp1}
BSR 0 34 I=Uplim(Dnlim(V(33)*3.16, {Isink},1m),{Isrc},1m)
C_30 30 0 1f
C_33 33 0 1f
G8  0 37 34 0 1m
R8  37 0 1K
C8  37 0 795P
G88A 0 377A 37 0 1m
R88A 377A 0 1G
GR88A 377A 0 377A 0 1m
C88A  377A 0 6.12N
G888A 0 378A 377A 0 1m
R888A 378A 0 1G
GR888A 378A 0 378A 0 1m
C888A  378A 0 1.59U
G9  0 38 378A 0 1m
R9  39 0 1K
L9  38 39 10.6M
GRL9  38 39 38 39 150N
G9A  0 38A 38 0 1m
R9A  39A 0 1K
L9A  38A 39A 1.98M
GRL9A  38A 39A 38A 39A 801N
B_E9 0 35 I=V(38A)+V(118)+V(128)+V(137)
R_E9 0 35 1 Noiseless
* Output Impedance / Saturation / Current Limit 
G23  0 57 VALUE {V(35) * 1.00}
R14 57 57A 800
LR14 57 57A 1.59M
RR14 57A  0 1.00
C_CGD8 55 57 .1P 
C_CGD9 56 57 .1P 
GD24A 98 98A VALUE={( IF( (V(98,98A))>0,V(98,98A)/3E-6,V(98,98A)/1E9 ) ) }
GD24B 98 98B VALUE={( IF( (V(98,98B))>0,V(98,98B)/1E9,V(98,98B)/3E-6 ) ) }
R24A 0 98A 1 TC=0.00,0.00
R24B 0 98B 1 TC=0.00,0.00
G71 96 5X 99 0 1
G70 0 98 TABLE { V(96,5X) } ((-7.2,-25.0M)(-1.00M,-24.7M)(0,0)(1.00M,24.7M)(7.2,25.0M))
C_C96_5 96 5 0.01P IC=0 
R_R98_0 98 0 1G 
E6 99 0 VALUE { V(98) * LIMIT((( V(3) - V(4) ) * 0.00 + 1.00), 0.00, 1E6 ) * LIMIT((( V(3) - V(4) ) * 2.5 + -1.25), 0, 1) }
R23 50 0 100MEG
VR15 57 96 0
R15X 57 96 1G
F1 0 50 VR15 1
E3 55  0 VALUE { -3.13M + V(3) * 1 + V(51) * -46.1M }
E4 56  0 VALUE { 107U + V(4) * 1 + V(52) * -30.7M }
R12 51 0 1k
R13 52 0 1k
GD12 50 51 VALUE={( IF( (V(50,51))>0,V(50,51)/0.002,V(50,51)/1E9 ) ) }
GD13 50 52 VALUE={( IF( (V(50,52))>0,V(50,52)/1E9,V(50,52)/0.002 ) ) }
G21  3  0 VALUE { 0 + V(51) * 1M }
G22  0  4 VALUE { 0 + V(52) * -1M }
S1000 1003 0 1001 1000B SSHUT
E1001 1000B 0 3 4 585M
S1000X 30A 4X 1004 0 SSHUT2
V1000X 0 4X 89.6
V1001 1002 0 1
S1001 5X 5 1004 0 SOUT
C_S1001 5X 5 .1P 
S1002 61 0 1004 0 SCAP
C1000 1004 0 100n IC=0 
R1000A 1004 0 1G 
E1000 1001 0 6 4 1
SD1002 1004 1002 1004 1002 SDIODE
SD1003 0 1004 0 1004 SDIODE
G1000 1004 0 1002 1003 210U
G1001 0 1004 1003 0 50.0M
R1000 6 4 50.0MEG
R1001 1002 1003 1k
S_D4 3 5 5 3 ESDO
S_D3 5 4 4 5 ESDO
DOP Vsatp 57 DO
COP 57 Vsatp 1f
DON 57 Vsatn DO
CON 57 Vsatn 1f
GSATP 0 Vsatp 55 0 1k
RSATP Vsatp 0 1m
GSATN 0 Vsatn 56 0 1k
RSATN Vsatn 0 1m
CSATP Vsatp 0 1n
CSATN Vsatn 0 1n
DGP N007 34 DG
DGN 34 N008 DG
GRP 0 N007 GRpi 0 1k
GRN 0 N008 GRni 0 1k
RRP N007 0 1m Noiseless
RRN N008 0 1m Noiseless
RGRP GRpi 0 1k Noiseless
RGRN GRni 0 1k Noiseless
CGRN GRni 0 10p
CGRP GRpi 0 10p
CGP 34 N007 1f
CGN 34 N008 1f
BGRP 0 GRpi I=1m*({Zo_max}* {Iscp}+V(3))
BGRN 0 GRni I=1m*({Zo_max}* {Iscn}+V(4))
* Models
.MODEL ESDO SW (Ron=50 Roff=1G Vt=0.5 Vh=-0.1 Vser=0.6 Ilimit=4m Lser=1n Noiseless)
.MODEL SSHUT SW RON=1m ROFF=100MEG VT=0 VH=-10m
.MODEL SSHUT2 SW RON=1m ROFF=1G VT=500m VH=-5m
.MODEL SOUT SW RON=1G ROFF=1m VT=500m VH=-5m
.MODEL SCAP SW RON=12.6m ROFF=1G VT=500m VH=-5m
.MODEL SDIODE SW RON=10m ROFF=1G VT=0 VH=-5m
.MODEL DN1 D   IS=1P KF=20.0E-15 AF=1
.MODEL REXP  RES TCE= 1.99404
.MODEL REXPM  RES TCE= 1.68233
.MODEL DIDL2 D()
.MODEL DO D(Vfwd=1k Vrev=0 Revepsilon=0.1 Ron=1m Noiseless)
.MODEL DG D(Vfwd=10k Vrev=0 Revepsilon=0.5 Noiseless Ron=1m)
.MODEL DI D(Vfwd=1k Vrev=0 Revepsilon=0.1 Noiseless)
.param Vcm_min=-0.1 Vcm_max=0.1
.param Cfp1=4.97m
.param SRp=56m SRn=-56m
.param Isrc = {Cfp1 * SRp * 1Meg} Isink = {Cfp1 * SRn * 1Meg}
.param beta_Zo=1.13
.param Rx_Zo = {100 * Zo_max}
.param Rdummy_Zo = {10 * Zo_max}
.param G1_Zo={Rx_Zo/(Zo_dc*beta_Zo)}
.param Zo_dc=.92
.param Zo_max=803.5
.param Iscp=25m Iscn=-25m
.param IZop={Rx_Zo*Iscp} IZon={Rx_Zo*Iscn}
*
.ENDS MAX40108