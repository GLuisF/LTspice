Version 4
SHEET 1 1364 680
WIRE 240 -144 208 -144
WIRE 208 -128 208 -144
WIRE 160 -64 144 -64
WIRE 336 -64 320 -64
WIRE 496 -64 480 -64
WIRE 208 -32 208 -48
WIRE 624 32 608 32
WIRE 720 32 704 32
WIRE 720 64 720 32
WIRE 736 64 720 64
WIRE 752 64 736 64
WIRE 64 112 32 112
WIRE 128 112 64 112
WIRE 960 112 928 112
WIRE 320 128 320 -64
WIRE 336 128 320 128
WIRE 512 128 480 128
WIRE 544 128 512 128
WIRE 640 128 608 128
WIRE 720 128 704 128
WIRE 736 128 720 128
WIRE 752 128 736 128
WIRE 320 160 320 128
WIRE 320 160 304 160
WIRE 128 176 96 176
WIRE 512 192 480 192
WIRE 528 192 512 192
WIRE 32 208 32 112
WIRE 720 224 720 128
WIRE 864 224 720 224
WIRE 960 240 928 240
WIRE 96 272 96 176
WIRE 720 272 720 224
WIRE 720 272 96 272
WIRE 752 272 720 272
WIRE 832 272 816 272
WIRE 864 272 832 272
WIRE 32 304 32 288
FLAG 160 -112 s
IOPIN 160 -112 In
FLAG 64 112 f
FLAG 32 304 0
FLAG 240 -144 o
IOPIN 240 -144 Out
FLAG 512 128 s
FLAG 608 32 0
FLAG 512 192 c
FLAG 736 64 1
FLAG 960 240 r
FLAG 960 112 THD
IOPIN 960 112 Out
FLAG 208 -32 0
FLAG 736 128 clk
FLAG 832 272 4
FLAG 144 -64 0
SYMBOL bv 32 192 R0
WINDOW 3 16 96 Left 0
WINDOW 0 32 32 Left 0
SYMATTR Value V={f2/f1}**((time-To)/Ts-1)
SYMATTR InstName B1
SYMBOL e 208 -144 R0
WINDOW 0 40 47 Left 0
WINDOW 3 37 75 Left 0
SYMATTR InstName E1
SYMATTR Value 1
SYMBOL bv 720 32 R90
WINDOW 3 -72 160 VLeft 0
WINDOW 0 32 56 VTop 0
WINDOW 123 -48 160 VLeft 0
SYMATTR Value V=50*sqrt(sdt(V(o)**2,0,V(r))*sdt(1,0,V(r))/
SYMATTR InstName B2
SYMATTR Value2 ((sdt((V(o)*V(s)),0,V(r))**2+sdt((V(o)*V(c)),0,V(r))**2))-2)
SYMBOL SpecialFunctions\\sample 208 144 R0
WINDOW 3 16 80 Center 0
WINDOW 0 8 -48 Center 0
SYMATTR Value tripdt=1n
SYMATTR InstName A1
SYMBOL SpecialFunctions\\modulate2 336 -64 R0
WINDOW 3 0 112 Left 0
WINDOW 0 0 -46 Left 0
SYMATTR Value space=0 mark={20*f2}
SYMATTR InstName A2
SYMBOL SpecialFunctions\\modulate2 336 128 R0
WINDOW 3 0 112 Left 0
WINDOW 123 0 130 Left 0
WINDOW 0 0 -46 Left 0
SYMATTR Value space=0 mark={f2}
SYMATTR Value2 Vhigh=1 Vlow=-1
SYMATTR InstName A3
SYMBOL Digital\\buf1 544 64 R0
WINDOW 3 0 96 Left 0
WINDOW 123 0 114 Left 0
WINDOW 0 0 34 Left 0
WINDOW 39 -1 133 Left 0
SYMATTR Value tripdt=1n
SYMATTR Value2 ref=0
SYMATTR InstName A4
SYMBOL Digital\\buf1 640 64 R0
WINDOW 3 0 114 Left 0
WINDOW 0 0 34 Left 0
WINDOW 38 0 96 Left 0
SYMATTR Value cycles=8
SYMATTR InstName A5
SYMATTR SpiceModel counter
SYMBOL SpecialFunctions\\sample 832 96 R0
WINDOW 3 16 80 Center 0
WINDOW 0 8 -48 Center 0
SYMATTR Value tripdt=1n
SYMATTR InstName A6
SYMBOL Digital\\inv 752 208 R0
WINDOW 0 0 34 Left 0
WINDOW 3 0 96 Left 0
WINDOW 123 0 114 Left 0
SYMATTR InstName A7
SYMATTR Value tripdt=1n
SYMATTR Value2 Td=4n
SYMBOL Digital\\and 896 192 R0
WINDOW 3 -32 112 Left 0
WINDOW 0 -32 18 Left 0
WINDOW 123 -32 130 Left 0
SYMATTR Value tripdt=0n3
SYMATTR InstName A8
SYMATTR Value2 Td=3n
TEXT 40 368 Left 0 !.tran 0 {Ts+To} {To} uic
TEXT 40 344 Left 0 !.param f1=100 f2=10k Ts=1 To=12/f1
TEXT 432 328 Left 0 ;To plot freq on the horiz axis \nchange the quantity plotted to \n"V(f)*<f2>Hz/1V" (e.g. f2=10k) \nand click "Logarithmic"
TEXT 32 8 Left 0 ;Sweep Parameters:\nf1 = start freq  f2= stop freq\nTs = sweep duration
TEXT 40 392 Left 0 ;.options reltol=1u
TEXT 976 176 Center 0 ;Delayed\nIntegrator\nReset
TEXT 976 48 Center 0 ;THD output\n(in percent)
TEXT 664 -72 Center 0 ;All-in-one THD calculator
TEXT 528 -208 Center 0 ;Swept Sine Audio THD Measurement Generator - Rev 1 - Aug 2006 - analogspiceman@yahoo.com
TEXT 416 -160 Center 0 ;Swept Sine-Cosine Source\nwith 20x sample forcing
TEXT 664 208 Center 0 ;Divide by 8
