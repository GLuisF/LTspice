*OPA1641/OPA1642/OPA1644 Macromodel FEB 12,2010 (PSpice format)

*	*	*	*	*	*
*	This file was created by TINA	*
*	(c) 1996-2006 DesignSoft, Inc.	*
*	*	*	*	*	*
* Rev. A - February 12, 2010, by Marek Lis & Tim Green
*
*
*     This macromodel has been optimized to model the AC, DC, noise, and transient response performance within 
*     the device data sheet specified limits. Correct operation of this macromodel has been verified on
*     DesignSoft TINA Version 7.0.80.224 SF. For help with other analog simulation software, please consult your software supplier. 
*
*  
* Copyright 2010 by Texas Instruments Corporation
*
* BEGIN MODEL OPA1641
*
* MODEL FEATURES INCLUDE OUTPUT SWING, OUTPUT CURRENT
* THROUGH THE SUPPLY RAILS, RAIL-TO-RAIL OUTPUT STAGE,
* OUTPUT CURRENT LIMIT, OPEN LOOP GAIN AND PHASE WITH
* RL AND CL EFFECTS, SETTLING TIME, OVERLOAD RECOVERY
* TIME, COMMON MODE REJECTION WITH FREQUENCY, OUTPUT 
* IMPEDANCE VS FREQUENCY, POWER SUPPLY REJECTION WITH 
* FREQUENCY,INPUT VOLTAGE NOISE WITH 1/F, INPUT CURRENT
* NOISE, INPUT BIAS CURRENT, INPUT IMPEDANCE, 
* INPUT COMMON MODE RANGE, INPUT VOLTAGE OFFSET,AND 
* QUIESCENT CURRENT VS VOLTAGE
.SUBCKT OPA1641 +IN -IN V+ V- Vout
V4          47 18 1
V1          18 48 1
V9          51 21 3.5
V8          67 V- 162.5M
V7          V+ 68 162.5M
IS2         V+ 24 4P
IS1         V+ V- 1.621657M
IS3         57 V- -2P
Vos         54 74 1.006M
V3          69 15 36
V2          15 70 30
R19         25 13 1 
R5          26 14 1 
R3          27 28 5K 
C18         13 15 10P IC=1.0022663618 
C4          14 15 10P IC=1.0022663618 
EVCVS2      27 15 15 29  2MEG
EVCVS1      32 15 30 31  2MEG
R35         30 15 100K 
R34         33 15 100K 
R33         15 34 100K 
R32         35 15 100K 
R31         15 36 100K 
R30         37 15 100K 
R29         15 38 100K 
R25         17 15 100K 
R15         0 15 100MEG 
XR109       39 15 RNOISE_FREE_0
GVCCS3      15 39 16 15  1U
XR109_2     40 15 RNOISE_FREE_0
GVCCS2      15 40 39 15  1U
C13         41 15 1F IC=1.0022663618 
XR109_3     41 15 RNOISE_FREE_0
GVCCS1      15 41 40 15  1U
R28         13 15 100 
R27         14 15 100 
R16         30 18 10K 
C9          15 42 300P IC=0 
R26         42 17 1 
GIsinking   V- 15 43 15  1M
GIsourcing  V+ 15 44 15  1M
R23         43 15 1K 
SW7         42 43 42 15  S_VSWITCH_1
R21         15 44 1K 
SW8         42 44 42 15  S_VSWITCH_2
R6          37 45 1U 
R4          38 46 1U 
SW4         20 45 37 15  S_VSWITCH_3
SW3         46 20 15 38  S_VSWITCH_4
XU3         47 19 38 15 VCVS_LIMIT_0
XU1         48 19 37 15 VCVS_LIMIT_0
SW2         26 49 33 15  S_VSWITCH_5
SW1         50 26 15 34  S_VSWITCH_6
XU8         24 V+ IDEAL_D_0
XU12        V- 24 IDEAL_D_0
EVCVS6      51 15 V+ 15  1
R22         52 53 100 
EVCVS4      52 15 24 15  1
XU2         53 21 IDEAL_D_1
XIn11       54 -IN FEMT_0
XVn11       +IN 54 VNSE_0
R14         33 49 1U 
R13         34 50 1U 
SW6         25 55 35 15  S_VSWITCH_7
R12         35 55 1U 
SW5         56 25 15 36  S_VSWITCH_8
R7          36 56 1U 
R2          22 15 100K 
R1          23 15 100K 
XU26        53 57 15 58 VCCS_LIMIT_0
XU4         58 15 15 20 VCCS_LIMIT_1
L1          59 15 70M IC=0 
EVCVS10     60 15 32 28  -1
R8          60 29 1MEG 
R9          29 27 1MEG 
R10         61 29 370.37 
C1          60 61 114.3N IC=-10.5458647139M 
R11         62 27 45.15K 
C3          29 62 745.29F IC=-10.5458647139M 
C2          60 29 4.7P IC=0 
R17         15 31 10MEG 
R24         31 32 10MEG 
C14         31 32 11.5N IC=-10.6569462209M 
C15         V+ V- 10P IC=0 
LPSR        63 15 100M IC=0 
XU25        64 15 65 66 VCVS_LIMIT_1
XU24        15 17 22 67 VCVS_LIMIT_2
XU23        17 15 68 23 VCVS_LIMIT_2
XU22        69 17 34 15 VCVS_LIMIT_3
XU21        70 17 33 15 VCVS_LIMIT_3
XU20        22 Vout 35 15 VCVS_LIMIT_4
XU19        23 Vout 36 15 VCVS_LIMIT_5
XU11        V- 57 IDEAL_D_0
XU10        57 V+ IDEAL_D_0
C10         71 15 1F IC=1.0022663618 
C5          16 15 1F IC=1.0022663618 
XR109_4     71 15 RNOISE_FREE_0
GVCCS15     15 71 41 15  1U
GVCCS14     15 14 13 15  10M
GVCCS13     15 13 71 15  10M
XR108       16 15 RNOISE_FREE_0
GVCCS12     15 16 72 15  1U
XR107       72 15 RNOISE_FREE_0
C11         72 15 100F IC=1.0022663618 
GVCCS10     15 72 73 15  1U
R20         -IN 66 100 
R18         74 24 100 
XR106       73 59 RNOISE_FREE_0
GVCCS6      15 73 19 15  1U
XR102       75 76 RNOISE_FREE_0
XR101       77 75 RNOISE_FREE_0
C6          75 0 1 IC=0 
XR105       19 15 RNOISE_FREE_0
XR104       20 15 RNOISE_FREE_1
XR103       15 58 RNOISE_FREE_0
EVCVS34     15 0 75 0  1
C8          24 15 6P IC=1.000702095 
RPSR        63 64 1 
GVCCS11     15 64 V+ V-  140N
RCM         78 79 1 
EVCVS29     77 0 V+ 0  1
EVCVS28     76 0 V- 0  1
CinnCM      15 57 6P IC=-1.0001979904 
LCM         78 15 100U IC=-100.0000499747U 
EVCVSCM     65 57 79 15  1
GVCCS7      15 79 24 15  -800N
C7          57 24 8P IC=-504.1045803864U 
VCCVS1_in   28 Vout
HCCVS1      17 15 VCCVS1_in   1K
GVCCS5      15 19 20 15  1U
Ccc         20 15 7U IC=1.0032648632 
EVCVS3      30 15 14 15  1
.MODEL S_VSWITCH_1 VSWITCH (RON=1 ROFF=100MEG VON=-10M VOFF=-10U)
.MODEL S_VSWITCH_2 VSWITCH (RON=1 ROFF=100MEG VON=10M VOFF=10U)
.MODEL S_VSWITCH_3 VSWITCH (RON=1 ROFF=100MEG VON=10 VOFF=-10)
.MODEL S_VSWITCH_4 VSWITCH (RON=1 ROFF=100MEG VON=10 VOFF=-10)
.MODEL S_VSWITCH_5 VSWITCH (RON=1 ROFF=100MEG VON=100 VOFF=-100)
.MODEL S_VSWITCH_6 VSWITCH (RON=1 ROFF=100MEG VON=100 VOFF=-100)
.MODEL S_VSWITCH_7 VSWITCH (RON=1 ROFF=100MEG VON=100 VOFF=-100)
.MODEL S_VSWITCH_8 VSWITCH (RON=1 ROFF=100MEG VON=100 VOFF=-100)
*.ENDS


* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_0  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E6
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS RNOISE_FREE_0 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_0  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 100
.PARAM VPOS = 100E3
.PARAM VNEG = -100E3
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_0 


*TG IDEAL DIODE
.SUBCKT IDEAL_D_0  A C
D1 A C DNOM
.MODEL DNOM D (TT=10P CJO=1E-18 IS=1E-15 RS=1E-3)
.ENDS IDEAL_D_0 


*TG IDEAL DIODE
.SUBCKT IDEAL_D_1  A C
D1 A C DNOM
.MODEL DNOM D (TT=10P CJO=1E-18 IS=1E-15 RS=1E-3)
.ENDS IDEAL_D_1 


* BEGIN PROG NSE FEMTO AMP/RT-HZ 
.SUBCKT FEMT_0  1 2
* BEGIN SETUP OF NOISE GEN - FEMPTOAMPS/RT-HZ
* INPUT THREE VARIABLES
* SET UP INSE 1/F
* FA/RHZ AT 1/F FREQ
.PARAM NLFF=.1
* FREQ FOR 1/F VAL
.PARAM FLWF=0.001
* SET UP INSE FB
* FA/RHZ FLATBAND
.PARAM NVRF=.1
* END USER INPUT
* START CALC VALS
.PARAM GLFF={PWR(FLWF,0.25)*NLFF/1164}
.PARAM RNVF={1.184*PWR(NVRF,2)}
.MODEL DVNF D KF={PWR(FLWF,0.5)/1E11} IS=1.0E-16
* END CALC VALS
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVNF
D2 8 0 DVNF
E1 3 6 7 8 {GLFF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNVF}
R5 5 0 {RNVF}
R6 3 4 1E9
R7 4 0 1E9
G1 1 2 3 4 1E-6
C1 1 0 1E-15
C2 2 0 1E-15
C3 1 2 1E-15
.ENDS
* END PROG NSE FEMTO AMP/RT-HZ


* BEGIN PROG NSE NANO VOLT/RT-HZ
.SUBCKT VNSE_0  1 2
* BEGIN SETUP OF NOISE GEN - NANOVOLT/RT-HZ
* INPUT THREE VARIABLES
* SET UP VNSE 1/F
* NV/RHZ AT 1/F FREQ
.PARAM NLF=10
* FREQ FOR 1/F VAL
.PARAM FLW=4
* SET UP VNSE FB
* NV/RHZ FLATBAND
.PARAM NVR=4.6
* END USER INPUT
* START CALC VALS
.PARAM GLF={PWR(FLW,0.25)*NLF/1164}
.PARAM RNV={1.184*PWR(NVR,2)}
.MODEL DVN D KF={PWR(FLW,0.5)/1E11} IS=1.0E-16
* END CALC VALS
I1 0 7 10E-3
I2 0 8 10E-3
D1 7 0 DVN
D2 8 0 DVN
E1 3 6 7 8 {GLF}
R1 3 0 1E9
R2 3 0 1E9
R3 3 6 1E9
E2 6 4 5 0 10
R4 5 0 {RNV}
R5 5 0 {RNV}
R6 3 4 1E9
R7 4 0 1E9
E3 1 2 3 4 1
C1 1 0 1E-15
C2 2 0 1E-15
C3 1 2 1E-15
.ENDS
* END PROG NSE NANOV/RT-HZ


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_0  VC+ VC- IOUT+ IOUT-
*              
.PARAM GAIN = 100U
.PARAM IPOS = .5
.PARAM INEG = -.5
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),IPOS,INEG)}
.ENDS VCCS_LIMIT_0 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCCS_LIMIT_1  VC+ VC- IOUT+ IOUT-
*              
.PARAM GAIN = 5
.PARAM IPOS = 140
.PARAM INEG = -140
G1 IOUT+ IOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),IPOS,INEG)}
.ENDS VCCS_LIMIT_1 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_1  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = -1
.PARAM VPOS = 20M
.PARAM VNEG = -20M
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_1 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_2  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 20.833M
.PARAM VPOS = 1
.PARAM VNEG = 0
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_2 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_3  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 1E2
.PARAM VPOS = 100E3
.PARAM VNEG = -100E3
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_3 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_4  VC+ VC- VOUT+ VOUT-
*              
.PARAM GAIN = 1E3
.PARAM VPOS = 100E3
.PARAM VNEG = -100E3
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_4 


*VOLTAGE CONTROLLED SOURCE WITH LIMITS
.SUBCKT VCVS_LIMIT_5  VC+ VC- VOUT+ VOUT-
*             
.PARAM GAIN = 1E3
.PARAM VPOS = 100E3
.PARAM VNEG = -100E3
E1 VOUT+ VOUT- VALUE={LIMIT(GAIN*V(VC+,VC-),VPOS,VNEG)}
.ENDS VCVS_LIMIT_5 


* NOISELESS RESISTOR
.SUBCKT RNOISE_FREE_1  1 2
*ROHMS = VALUE IN OHMS OF NOISELESS RESISTOR
.PARAM ROHMS=1E4
ERES 1 3 VALUE = { I(VSENSE) * ROHMS }
RDUMMY 30 3 1
VSENSE 30 2 DC 0V
.ENDS RNOISE_FREE_1 


.ENDS
