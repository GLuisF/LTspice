Version 4
SHEET 1 2212 724
WIRE 1696 -400 1616 -400
WIRE 1760 -400 1696 -400
WIRE 1888 -400 1760 -400
WIRE 1616 -368 1616 -400
WIRE 1760 -368 1760 -400
WIRE 1888 -368 1888 -400
WIRE 1616 -256 1616 -288
WIRE 1760 -256 1760 -288
WIRE 1760 -256 1616 -256
WIRE 1888 -256 1888 -304
WIRE 1888 -256 1760 -256
WIRE 1616 -240 1616 -256
WIRE -160 -80 -160 -112
WIRE 672 -64 384 -64
WIRE 1456 -64 752 -64
WIRE 1488 -64 1456 -64
WIRE 1552 -64 1488 -64
WIRE 1680 -64 1616 -64
WIRE 1888 -64 1680 -64
WIRE -528 16 -736 16
WIRE -464 16 -528 16
WIRE -320 16 -384 16
WIRE -160 16 -160 -16
WIRE -160 16 -240 16
WIRE -32 16 -160 16
WIRE 0 16 -32 16
WIRE 112 16 64 16
WIRE 160 16 112 16
WIRE 208 16 160 16
WIRE 384 16 384 -64
WIRE 384 16 208 16
WIRE 896 16 672 16
WIRE 1008 16 976 16
WIRE 1120 16 1088 16
WIRE 1680 16 1680 -64
WIRE 1680 16 1200 16
WIRE 384 80 384 16
WIRE 1488 96 1488 -64
WIRE -736 112 -736 16
WIRE -528 112 -528 16
WIRE 0 112 -80 112
WIRE 112 112 112 16
WIRE 112 112 64 112
WIRE 672 112 672 16
WIRE 672 112 512 112
WIRE 720 112 672 112
WIRE 752 112 720 112
WIRE 1024 112 976 112
WIRE 1312 112 1024 112
WIRE -160 128 -160 16
WIRE 160 128 160 16
WIRE 720 176 592 176
WIRE 752 176 720 176
WIRE 1024 176 976 176
WIRE 1168 176 1024 176
WIRE 1408 176 1248 176
WIRE 1440 176 1408 176
WIRE 1888 192 1888 -64
WIRE -32 208 -32 16
WIRE 0 208 -32 208
WIRE 112 208 64 208
WIRE 384 208 384 160
WIRE 1680 208 1680 16
WIRE 384 240 384 208
WIRE 416 240 384 240
WIRE 672 240 496 240
WIRE 720 240 672 240
WIRE 752 240 720 240
WIRE 1040 240 976 240
WIRE -736 304 -736 192
WIRE -528 304 -528 176
WIRE -528 304 -736 304
WIRE -336 304 -528 304
WIRE -160 304 -160 192
WIRE -160 304 -256 304
WIRE -80 304 -80 112
WIRE -80 304 -160 304
WIRE 0 304 -80 304
WIRE 112 304 112 208
WIRE 112 304 64 304
WIRE 160 304 160 192
WIRE 160 304 112 304
WIRE 208 304 160 304
WIRE 256 304 208 304
WIRE 720 304 336 304
WIRE 752 304 720 304
WIRE 1008 304 976 304
WIRE 1104 304 1008 304
WIRE 1200 304 1184 304
WIRE 1312 320 1312 112
WIRE 1408 320 1408 176
WIRE -160 336 -160 304
WIRE -736 352 -736 304
WIRE 1200 352 1200 304
WIRE 1200 352 1104 352
WIRE 384 368 384 240
WIRE 512 368 512 112
WIRE 592 368 592 176
WIRE 672 368 672 240
WIRE 1104 384 1104 352
WIRE 1200 384 1200 352
WIRE -160 432 -160 400
WIRE -736 464 -736 432
WIRE 384 480 384 432
WIRE 512 480 512 432
WIRE 512 480 384 480
WIRE 592 480 592 432
WIRE 592 480 512 480
WIRE 672 480 672 432
WIRE 672 480 592 480
WIRE 1040 480 1040 240
WIRE 1040 480 672 480
WIRE 1104 480 1104 464
WIRE 1104 480 1040 480
WIRE 1200 480 1200 448
WIRE 1200 480 1104 480
WIRE 1312 480 1312 400
WIRE 1312 480 1200 480
WIRE 1408 480 1408 400
WIRE 1408 480 1312 480
WIRE 1488 480 1488 192
WIRE 1488 480 1408 480
WIRE 1680 480 1680 272
WIRE 1680 480 1488 480
WIRE 1888 480 1888 272
WIRE 1888 480 1680 480
WIRE 1680 512 1680 480
WIRE 160 528 160 304
WIRE 256 528 160 528
WIRE 1488 528 1488 480
WIRE 1488 528 336 528
FLAG -736 464 0
FLAG 1008 304 VM
FLAG 720 176 CTRL
FLAG 1024 112 VCC
FLAG 720 240 IN
FLAG 720 304 CS
FLAG 1024 176 DRV
FLAG 1456 -64 VDS
FLAG 1680 -64 VOUT
FLAG 1680 512 0
FLAG 208 16 Vrectp
FLAG 208 304 Vrectn
FLAG 720 112 FB
FLAG 1696 -400 cur
FLAG 384 208 VIN30
FLAG -160 -112 0
FLAG -160 432 0
FLAG 1616 -240 0
SYMBOL voltage -736 96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 27 92 Left 0
WINDOW 3 -28 -110 Left 0
SYMATTR SpiceLine Rser=.1
SYMATTR Value SINE(0 155.6 60)
SYMATTR InstName V1
SYMBOL diode 0 32 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D1
SYMATTR Value DD
SYMBOL diode 0 128 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D2
SYMATTR Value DD
SYMBOL diode 64 224 M270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D3
SYMATTR Value DD
SYMBOL diode 64 320 M270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D4
SYMATTR Value DD
SYMBOL cap 144 128 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL res -752 336 R0
SYMATTR InstName R1
SYMATTR Value 1G
SYMBOL res 368 64 R0
SYMATTR InstName R2
SYMATTR Value 4.5e6
SYMBOL cap 368 368 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL res 400 256 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R3
SYMATTR Value 470k
SYMBOL NCP1653 864 208 R0
SYMATTR InstName U1
SYMBOL cap 576 368 R0
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 240 544 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R4
SYMATTR Value 0.1
SYMBOL res 240 320 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R5
SYMATTR Value 2.85k
SYMBOL res 1088 320 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R6
SYMATTR Value 1
SYMBOL res 1088 368 R0
SYMATTR InstName R7
SYMATTR Value 56k
SYMBOL cap 1184 384 R0
SYMATTR InstName C4
SYMATTR Value 1n
SYMBOL ind 656 -48 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
WINDOW 39 -46 60 VTop 0
SYMATTR InstName L1
SYMATTR Value 600µ
SYMATTR SpiceLine Rser=0.1
SYMBOL voltage 1312 304 R0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL nmos 1440 96 R0
SYMATTR InstName M1
SYMATTR Value SPA11N60C3
SYMBOL diode 1552 -48 R270
WINDOW 0 32 32 VTop 0
WINDOW 3 0 32 VBottom 0
SYMATTR InstName D5
SYMATTR Value MUR460
SYMBOL cap 1664 208 R0
WINDOW 39 24 92 Left 0
SYMATTR SpiceLine Rser=100m
SYMATTR InstName C5
SYMATTR Value 100µ
SYMATTR SpiceLine2 ic={Vout/2}
SYMBOL bi 1888 192 R0
SYMATTR InstName B1
SYMATTR Value I={Pout}/(V(VOUT)+1)
SYMBOL bi 1616 -368 R0
SYMATTR InstName B2
SYMATTR Value I=I(R4)
SYMBOL res 1744 -384 R0
SYMATTR InstName Rmeas
SYMATTR Value 1
SYMBOL cap 1872 -368 R0
SYMATTR InstName C6
SYMATTR Value 100µ
SYMBOL res 1152 192 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R10
SYMATTR Value 4.7
SYMBOL cap 656 368 R0
SYMATTR InstName C7
SYMATTR Value 1n
SYMBOL cap 496 368 R0
SYMATTR InstName C8
SYMATTR Value 1n
SYMBOL res 1392 304 R0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 880 32 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R8
SYMATTR Value 680k
SYMBOL res 992 32 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R9
SYMATTR Value 680k
SYMBOL res 1104 32 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName R12
SYMATTR Value 560k
SYMBOL ind2 -336 32 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
SYMATTR InstName L2
SYMATTR Value 3.3m
SYMATTR Type ind
SYMATTR SpiceLine Rser=.1
SYMBOL ind2 -352 320 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
SYMATTR InstName L3
SYMATTR Value 3.3m
SYMATTR Type ind
SYMATTR SpiceLine Rser=.1
SYMBOL ind -480 32 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 5 56 VBottom 0
SYMATTR InstName L4
SYMATTR Value 150µ
SYMATTR SpiceLine Rser=.05
SYMBOL cap -544 112 R0
SYMATTR InstName C9
SYMATTR Value 1µ
SYMATTR SpiceLine Rser=50m
SYMBOL cap -176 128 R0
SYMATTR InstName C10
SYMATTR Value 1µ
SYMATTR SpiceLine Rser=50m
SYMBOL cap -176 -80 R0
SYMATTR InstName C11
SYMATTR Value 4.7n
SYMBOL cap -176 336 R0
SYMATTR InstName C12
SYMATTR Value 4.7n
TEXT -240 -168 Left 0 !.model DD D(Is=1e-15 Rs=0.1 Cjo=50p Tt=1u)
TEXT -240 -448 Left 0 !.param Vout=400
TEXT -240 -384 Left 0 !.tran 0 80m 1u .1u
TEXT -240 -360 Left 0 !.ic V(VOUT)=390
TEXT -240 -256 Left 0 ;.options reltol=0.001 trtol=1
TEXT -240 -232 Left 0 !.options reltol=0.003 trtol=1 ; 20% faster
TEXT 1648 -472 Left 0 ;Current Measurement\nPlot I(Rmeas)
TEXT 1176 280 Left 0 ;9k
TEXT 632 -496 Left 0 ;* This model here is for educational use only. \n* The provided model NCP1653 is a modified version of a model from ONSemi.\n* The translated and the original model are not correct in all features. \n* Original model: \n* http://www.onsemi.com/pub/Collateral/ISPICE%20SWITCHED%20MODEL.DWG\n* http://www.onsemi.com/pub/Collateral/ISPICE%20AVERAGE%20MODEL.DWG\n* Further links: \n* http://www.onsemi.com/PowerSolutions/product.do?id=NCP1653P\n* http://www.onsemi.com/pub/Collateral/AND8184-D.PDF\n* http://www.onsemi.com/pub/Collateral/AND8185-D.PDF\n* http://www.onsemi.com/pub/Collateral/NCP1653-D.PDF\n* http://www.onsemi.com/pub/Collateral/TND321-D.PDF\n* http://www.onsemi.com/pub/Collateral/TND313-D.PDF
TEXT 392 456 Left 0 ;33n
TEXT 1232 424 Left 0 ;330p
TEXT 600 464 Left 0 ;330n
TEXT -240 -336 Left 0 !.ic V(CTRL)=0.5
TEXT -240 -424 Left 0 !.param Pout=200
TEXT -40 -432 Left 0 ;.param Pout=100
TEXT -240 -312 Left 0 !.ic V(VIN30)=8
TEXT 1216 -8 Left 0 ;R=(V(VOUT)-2)/200u
TEXT -448 120 Left 0 !K23 L2 L3 0.99
TEXT 192 -496 Left 0 ;U1-GND has to be connected to GND(0)!
TEXT 776 392 Left 0 ;U1-GND has to be \nconnected to GND(0)!
TEXT 176 -256 Left 0 ;Never use trtol=7 !
LINE Normal -224 64 -336 64
LINE Normal -336 256 -224 64
LINE Normal -224 256 -336 256
