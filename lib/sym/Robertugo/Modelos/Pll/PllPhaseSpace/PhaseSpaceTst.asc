Version 4
SHEET 1 1620 680
WIRE -240 288 -240 256
WIRE -240 336 -240 288
WIRE -240 464 -240 416
WIRE -128 288 -240 288
WIRE -128 288 -128 224
WIRE -128 336 -128 288
WIRE -128 464 -240 464
WIRE -128 464 -128 416
WIRE -64 464 -128 464
WIRE -64 464 -64 272
WIRE -48 224 -128 224
WIRE -48 272 -64 272
WIRE 0 208 0 144
WIRE 0 464 -64 464
WIRE 0 464 0 288
WIRE 96 144 0 144
WIRE 96 272 96 144
WIRE 96 464 0 464
WIRE 96 464 96 336
WIRE 96 496 96 464
WIRE 112 144 96 144
WIRE 192 352 192 304
WIRE 192 464 96 464
WIRE 192 464 192 432
WIRE 464 240 464 144
WIRE 464 464 464 320
WIRE 496 144 464 144
WIRE 608 144 576 144
WIRE 608 240 608 144
WIRE 608 352 608 304
WIRE 608 464 464 464
WIRE 608 464 608 432
WIRE 656 144 608 144
WIRE 704 144 656 144
WIRE 704 272 704 144
WIRE 704 464 608 464
WIRE 704 464 704 320
WIRE 752 272 704 272
WIRE 752 320 704 320
WIRE 800 256 800 224
WIRE 800 464 704 464
WIRE 800 464 800 336
WIRE 800 480 800 464
WIRE 880 224 800 224
WIRE 880 352 880 320
WIRE 880 464 880 432
WIRE 1056 288 1056 256
WIRE 1056 352 1056 288
WIRE 1056 464 880 464
WIRE 1056 464 1056 432
WIRE 1136 288 1056 288
WIRE 1136 288 1136 224
WIRE 1136 352 1136 288
WIRE 1136 464 1056 464
WIRE 1136 464 1136 432
WIRE 1184 224 1136 224
WIRE 1184 464 1136 464
WIRE 1184 464 1184 272
WIRE 1232 208 1232 144
WIRE 1232 464 1184 464
WIRE 1232 464 1232 288
WIRE 1328 144 1232 144
WIRE 1328 272 1328 144
WIRE 1328 464 1232 464
WIRE 1328 464 1328 336
WIRE 1328 480 1328 464
WIRE 1344 144 1328 144
FLAG 96 496 0
FLAG -240 256 In
IOPIN -240 256 In
FLAG 112 144 Ph_In
FLAG 656 144 FiltOut
FLAG 880 224 Filt
FLAG 1344 144 Ph_Out
FLAG 1056 256 Out
IOPIN 1056 256 Out
FLAG 800 480 0
FLAG 1328 480 0
FLAG 880 320 F0
SYMBOL cap 80 272 R0
WINDOW 0 -64 35 Left 0
WINDOW 3 -77 62 Left 0
SYMATTR InstName Cint1
SYMATTR Value {2*PI}
SYMATTR SpiceLine Rpar=1e9
SYMBOL res -144 320 R0
SYMATTR InstName Rin
SYMATTR Value 1G
SYMBOL voltage -240 320 R0
WINDOW 0 -22 56 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 2 160 Left 0
SYMATTR InstName VFin
SYMATTR Value SFFM(0 1 {Fin} 1 {Fin/4})
SYMBOL bv 464 224 R0
WINDOW 3 -27 260 Left 0
WINDOW 0 -17 57 Left 0
SYMATTR Value V=({kd}*sin(v(ph_in)-v(ph_out)))
SYMATTR InstName Bdf
SYMBOL res 592 128 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Rf1
SYMATTR Value 270k
SYMBOL cap 592 240 R0
WINDOW 0 -35 6 Left 0
WINDOW 3 -52 36 Left 0
SYMATTR InstName Cf1
SYMATTR Value 1n
SYMATTR SpiceLine Rpar=1e9
SYMBOL res 592 336 R0
WINDOW 0 -31 26 Left 0
WINDOW 3 -35 63 Left 0
SYMATTR InstName Rf2
SYMATTR Value 27k
SYMBOL e 800 240 R0
WINDOW 3 -35 55 Left 0
SYMATTR Value {kvco}
SYMATTR InstName Ebuf
SYMBOL cap 1312 272 R0
WINDOW 0 -61 34 Left 0
WINDOW 3 -73 63 Left 0
SYMATTR InstName Cint2
SYMATTR Value {2*PI}
SYMATTR SpiceLine Rpar=1e9
SYMBOL g 0 192 R0
WINDOW 3 40 42 Left 0
SYMATTR Value 1k
SYMATTR InstName Gint1
SYMBOL g 1232 192 R0
WINDOW 3 43 44 Left 0
SYMATTR Value 1k
SYMATTR InstName Gint2
SYMBOL res 1120 336 R0
WINDOW 0 -49 4 Left 0
WINDOW 3 -26 33 Left 0
SYMATTR InstName ROut
SYMATTR Value 1G
SYMBOL bv 1056 336 R0
WINDOW 0 -27 57 Left 0
WINDOW 3 -82 149 Left 0
SYMATTR InstName Bvco
SYMATTR Value v=(V(F0)+V(Filt))
SYMBOL voltage 880 336 R0
WINDOW 0 21 14 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -19 55 Left 0
SYMATTR InstName VF0
SYMATTR Value {F0}
SYMBOL voltage 192 336 R0
WINDOW 0 -22 56 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 2 160 Left 0
SYMATTR InstName VFin1
SYMATTR Value SINE(0 1 {Fin/4})
TEXT -242 528 Left 0 !.tran 0 {20*Fin**-1} 0 {(6.28e2*Fin)**-1}
TEXT -240 120 Left 0 !.param Kd=1.27 Kvco=21k Fin=120k F0=0
TEXT 544 432 Left 0 ;27k
